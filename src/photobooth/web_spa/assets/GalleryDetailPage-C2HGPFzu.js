import{Q as Qt}from"./QHeader-BjaWVUW1.js";import{u as xt,a as zt,b as Ot,c as Ht,T as Kt,Q as Jt}from"./use-panel-C73gIhV0.js";import{Q as It}from"./QPageSticky-CWyWD4Na.js";import{f as xe,i as Q,d as j,P as Yt,R as St,c as R,O as fe,w as q,e as k,S as W,q as x,n as oe,t as O,Q as F,p as U,F as ne,x as ge,U as At,y as D,z as M,A as le,D as ue,o as P,V as ce,W as Qe,X as Gt,Y as Tt,C as jt,j as J,s as de,Z as Pt,$ as Wt,l as ze,m as kt,a0 as Xt,a1 as Zt,a2 as ie,a3 as en,a4 as qt,k as $,N as tn,a5 as nn,a6 as rn,a7 as on,M as an,a8 as sn,G as ln,E as un,a as cn,b as dn,I as fn,a9 as gn,aa as hn}from"./index-BhZkHft5.js";import{Q as mn}from"./QPage-Cp1FgTNZ.js";import{Q as pn,a as _n}from"./QLayout-B98lw8g7.js";import{Q as Ye}from"./QInput-C_1UFjLP.js";import{Q as yn}from"./QForm-Dd8K-m90.js";import{Q as Ge}from"./QBadge-Blm8a37x.js";import{Q as Rt}from"./QLinearProgress-wXLikAuz.js";import{_ as Nt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as wn}from"./QImg-dMXMYsh8.js";import{u as vn,a as Cn,b as bn}from"./use-fullscreen-0h-d6iQQ.js";import{_ as En,I as Bn}from"./ItemNotAvailableError-Bj43xzl8.js";import{_ as In}from"./ReturnButton.vue_vue_type_script_setup_true_lang-CgY9iYx3.js";import{_ as Sn}from"./RouteAfterTimeout.vue_vue_type_script_setup_true_lang-7a0imUhN.js";import"./selection-C9Yo5SIL.js";import"./format-CJebrXOQ.js";import"./use-id-iTZhKz_b.js";import"./vue-i18n-Daw7jgvz.js";const An=xe({name:"QSpace",setup(){const n=Q("div",{class:"q-space"});return()=>n}}),Tn={class:"text-h6"},Pn={class:"q-gutter-md"},kn={key:0},qn={key:1},Rn=j({__name:"PageShareParameters",props:{config_index:{},parameters_dialog_caption:{},parameters_dialog_action_icon:{},parameters_dialog_action_label:{},parameters:{}},emits:["triggerShareActionWithParameters"],setup(n,{emit:a}){const i=Yt({}),t=n,e=a;St(()=>{t.parameters.forEach(s=>i[s.key]=s.default)});const r=()=>{e("triggerShareActionWithParameters",t.config_index,i)};return(s,l)=>(P(),R(fe,{style:{width:"400px"},class:""},{default:q(()=>[k(yn,{autofocus:"",onSubmit:r,class:"q-gutter-md",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},{default:q(()=>[k(W,{class:"row items-center q-pb-none"},{default:q(()=>[x("div",Tn,O(s.parameters_dialog_caption),1),k(An),oe(k(F,{icon:"sym_o_close",flat:""},null,512),[[ce]])]),_:1}),k(W,{class:"q-pa-md"},{default:q(()=>[x("div",Pn,[(P(!0),U(ne,null,ge(t.parameters,o=>(P(),U("div",{key:o.key},[o.ui_type=="int"?(P(),U("div",kn,[(P(),R(Ye,{filled:"",modelValue:i[o.key],"onUpdate:modelValue":u=>i[o.key]=u,label:o.label,key:o.key,name:o.key,rules:[u=>u!==null&&u!==""||"Please type a number",u=>o.valid_max&&parseInt(u)<=parseInt(o.valid_max)||`Please type a number lower than ${o.valid_max}`,u=>o.valid_min&&parseInt(u)>=parseInt(o.valid_min)||`Please type a number more than ${o.valid_min}`]},{before:q(()=>[k(F,{icon:"sym_o_remove",color:"primary",flat:"",onClick:u=>i[o.key]=String(parseInt(i[o.key])-1),disable:o.valid_min&&parseInt(i[o.key])<=parseInt(o.valid_min)},null,8,["onClick","disable"])]),after:q(()=>[k(F,{icon:"sym_o_add",color:"primary",flat:"",onClick:u=>i[o.key]=String(parseInt(i[o.key])+1),disable:o.valid_max&&parseInt(i[o.key])>=parseInt(o.valid_max)},null,8,["onClick","disable"])]),_:2},1032,["modelValue","onUpdate:modelValue","label","name","rules"]))])):(P(),U("div",qn,[(P(),R(Ye,{filled:"",modelValue:i[o.key],"onUpdate:modelValue":u=>i[o.key]=u,label:o.label,key:o.key,name:o.key,class:"",rules:[u=>u&&u.length>0||"Please type something",u=>o.valid_max&&u.length<=parseInt(o.valid_max)||`Please type text longest ${o.valid_max} chars.`,u=>o.valid_min&&u.length>=parseInt(o.valid_min)||`Please type text shortest ${o.valid_min} chars.`]},null,8,["modelValue","onUpdate:modelValue","label","name","rules"]))]))]))),128))])]),_:1}),k(At,{align:"center"},{default:q(()=>[oe((P(),R(F,{stack:"","no-caps":"",color:"primary",class:"q-ma-sm",type:"submit",size:"md",padding:"md lg"},{default:q(()=>[M(le.isEmpty)(s.parameters_dialog_action_icon)?D("",!0):(P(),R(ue,{key:0,name:`sym_o_${s.parameters_dialog_action_icon}`},null,8,["name"])),x("div",null,O(s.parameters_dialog_action_label),1)]),_:1})),[[ce]])]),_:1})]),_:1})]),_:1}))}});function Nn(n){const a=Object.assign({noopener:!0},n),i=[];for(const t in a){const e=a[t];e===!0?i.push(t):(Tt(e)||typeof e=="string"&&e!=="")&&i.push(t+"="+e)}return i.join(",")}function je(n,a,i){let t=window.open;if(Qe.is.cordova===!0){if(cordova!==void 0&&cordova.InAppBrowser!==void 0&&cordova.InAppBrowser.open!==void 0)t=cordova.InAppBrowser.open;else if(navigator!==void 0&&navigator.app!==void 0)return navigator.app.loadUrl(n,{openExternal:!0})}const e=t(n,"_blank",Nn(i));if(e)return Qe.is.desktop&&e.focus(),e;a&&a()}const Mn=(n,a,i)=>{if(Qe.is.ios===!0&&window.SafariViewController!==void 0){window.SafariViewController.isAvailable(t=>{t?window.SafariViewController.show({url:n},Gt,a):je(n,a,i)});return}return je(n,a,i)},Ln=j({__name:"ShareTriggerButtons",props:{triggers:{},directAccessNumberOfButtons:{},currentItemIsImage:{type:Boolean}},emits:["triggerAction"],setup(n,{emit:a}){const i=n;function t(s){return console.log(i.currentItemIsImage,s),!i.currentItemIsImage&&s}const e=a;function r(s){console.log(`trigger share config_index ${s}`),e("triggerAction",s)}return(s,l)=>(P(!0),U(ne,null,ge(s.triggers,(o,u)=>(P(),U("div",{key:u},[o.show_button&&!(M(le.isEmpty)(o.title)&&M(le.isEmpty)(o.icon))?(P(),R(F,{key:0,stack:"",rounded:"","no-caps":"",color:"primary",disabled:t(o.handles_images_only),class:jt(["q-mr-sm action-button action-button-share col-auto glass-effect",["share-button-"+u]]),onClick:g=>r(o.config_index)},{default:q(()=>[M(le.isEmpty)(o.icon)?D("",!0):(P(),R(ue,{key:0,name:`sym_o_${o.icon}`},null,8,["name"])),x("div",null,O(o.title),1)]),_:2},1032,["disabled","class","onClick"])):D("",!0)]))),128))}}),Dn={class:"q-mb-lg action-buttons col"},$n={class:"q-pa-md row flex flex-center"},Fn={class:"q-mr-sm row flex flex-center"},Un={class:"q-ml-sm"},Vn=j({__name:"PageToolbar",props:{item:{},image_number:{},images_total:{},showDownload:{type:Boolean},showDelete:{type:Boolean},showFilter:{type:Boolean},showShare:{type:Boolean},shareDirectAccessButtons:{},shareButtons:{},enableFilter:{type:Boolean}},emits:["triggerShareAction","triggerToggleDisplayFilter","triggerDeleteMediaitem","closeEvent"],setup(n,{emit:a}){const i=J(!1),t=n,e=a;function r(o){e("triggerShareAction",o)}function s(){e("triggerToggleDisplayFilter")}function l(o){e("triggerDeleteMediaitem",o)}return(o,u)=>(P(),U(ne,null,[o.item?(P(),R(It,{key:0,position:"bottom",id:"gallery-toolbar",class:"toolbar"},{default:q(()=>[x("div",Dn,[x("div",$n,[o.showDelete?(P(),R(F,{key:0,stack:"",rounded:"",class:"q-mr-sm action-button action-button-delete col-auto glass-effect",color:"primary","no-caps":"",icon:"sym_o_delete",label:o.$t("BTN_LABEL_GALLERY_DELETE"),onClick:u[0]||(u[0]=g=>i.value=!0)},null,8,["label"])):D("",!0),o.showFilter&&o.enableFilter?(P(),R(F,{key:1,stack:"","no-caps":"",rounded:"",color:"primary",class:"q-mr-sm action-button action-button-filter col-auto glass-effect",icon:"sym_o_filter",label:o.$t("BTN_LABEL_GALLERY_FILTER"),onClick:s},null,8,["label"])):D("",!0),o.showDownload?(P(),R(F,{key:2,stack:"","no-caps":"",rounded:"",color:"primary",class:"q-mr-sm action-button action-button-download col-auto glass-effect",icon:"sym_o_download",label:o.$t("BTN_LABEL_GALLERY_DOWNLOAD"),onClick:u[1]||(u[1]=g=>M(Mn)(`/media/full/${o.item.id}`))},null,8,["label"])):D("",!0),o.showShare?(P(),R(Ln,{key:3,triggers:o.shareButtons,"direct-access-number-of-buttons":o.shareDirectAccessButtons,"current-item-is-image":["image","collage","collageimage","animationimage"].includes(o.item.media_type),onTriggerAction:r},null,8,["triggers","direct-access-number-of-buttons","current-item-is-image"])):D("",!0)]),x("div",Fn,[k(Ge,{color:"grey-8",class:"q-mr-xs"},{default:q(()=>[k(ue,{name:"sym_o_image",color:"white",class:"q-mr-xs"}),de(" "+O(o.item.id),1)]),_:1}),t.image_number&&t.images_total?(P(),R(Ge,{key:0,color:"grey-8",class:"q-mr-xs"},{default:q(()=>[k(ue,{name:"sym_o_tag",color:"white",class:"q-mr-xs"}),de(" "+O(o.$t("LABEL_ELEMENT_X_OF_Y",{no:t.image_number,total:t.images_total})),1)]),_:1})):D("",!0)])])]),_:1})):D("",!0),k(Pt,{modelValue:i.value,"onUpdate:modelValue":u[3]||(u[3]=g=>i.value=g)},{default:q(()=>[k(fe,{id:"gallery-confirm-delete-dialog",class:"q-pa-sm",style:{"min-width":"350px"}},{default:q(()=>[k(W,{class:"row items-center",style:{"flex-wrap":"nowrap"}},{default:q(()=>[k(Wt,{icon:"sym_o_delete",color:"primary","text-color":"white"}),x("span",Un,O(o.$t("MSG_CONFIRM_DELETE_IMAGE")),1)]),_:1}),k(At,{align:"right"},{default:q(()=>[oe(k(F,{flat:"",label:o.$t("BTN_LABEL_CANCEL")},null,8,["label"]),[[ce]]),oe(k(F,{label:o.$t("BTN_LABEL_DELETE_IMAGE"),color:"primary",onClick:u[2]||(u[2]=g=>[l(o.item.id),o.$emit("closeEvent")])},null,8,["label"]),[[ce]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Qn=j({__name:"HeaderCountdownTimer",props:{duration:{}},emits:["triggerTimeout"],setup(n,{emit:a}){const i=n,t=J(0);let e;const r=a;function s(){clearInterval(e),t.value=0}function l(){t.value=i.duration,e=window.setInterval(()=>{t.value-=.1,t.value<=0&&(clearInterval(e),r("triggerTimeout"))},100)}return ze(()=>{l()}),kt(()=>{s()}),(o,u)=>t.value>=0?(P(),R(Rt,{key:0,id:"gallery-linear-progress-bar",class:"absolute",value:t.value/i.duration,"animation-speed":"200",color:"grey"},null,8,["value"])):D("",!0)}}),xn={};function zn(n,a){return P(),R(Rt,{class:"absolute",indeterminate:"","animation-speed":"2100",color:"primary"})}const On=Nt(xn,[["render",zn]]),Hn={class:"text-center text-overline"},Kn={class:"absolute-bottom-right text-subtitle1 text-center",style:{padding:"4px","pointer-events":"none"}},Jn=j({__name:"DrawerFilter",props:{id:{},availableFilter:{}},emits:["triggerApplyFilter"],setup(n,{emit:a}){const i=n,t=a;function e(r){t("triggerApplyFilter",i.id,r)}return(r,s)=>(P(),U(ne,null,[x("div",Hn,O(r.$t("Choose your filter")),1),(P(!0),U(ne,null,ge(r.availableFilter,l=>(P(),R(fe,{key:l,bordered:"",class:"q-mb-sm no-shadow"},{default:q(()=>[k(W,{class:"q-pa-none"},{default:q(()=>[k(wn,{class:"rounded-borders",loading:"lazy",src:`/api/mediaprocessing/preview/${r.id}/${l}`,onClick:o=>e(l)},{default:q(()=>[x("div",Kn,O(l),1)]),_:2},1032,["src","onClick"])]),_:2},1024)]),_:2},1024))),128))],64))}});var te={},ye,We;function Yn(){return We||(We=1,ye=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),ye}var we={},G={},Xe;function X(){if(Xe)return G;Xe=1;let n;const a=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return G.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17},G.getSymbolTotalCodewords=function(t){return a[t]},G.getBCHDigit=function(i){let t=0;for(;i!==0;)t++,i>>>=1;return t},G.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');n=t},G.isKanjiModeEnabled=function(){return typeof n<"u"},G.toSJIS=function(t){return n(t)},G}var ve={},Ze;function Oe(){return Ze||(Ze=1,function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function a(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+i)}}n.isValid=function(t){return t&&typeof t.bit<"u"&&t.bit>=0&&t.bit<4},n.from=function(t,e){if(n.isValid(t))return t;try{return a(t)}catch{return e}}}(ve)),ve}var Ce,et;function Gn(){if(et)return Ce;et=1;function n(){this.buffer=[],this.length=0}return n.prototype={get:function(a){const i=Math.floor(a/8);return(this.buffer[i]>>>7-a%8&1)===1},put:function(a,i){for(let t=0;t<i;t++)this.putBit((a>>>i-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(a){const i=Math.floor(this.length/8);this.buffer.length<=i&&this.buffer.push(0),a&&(this.buffer[i]|=128>>>this.length%8),this.length++}},Ce=n,Ce}var be,tt;function jn(){if(tt)return be;tt=1;function n(a){if(!a||a<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=a,this.data=new Uint8Array(a*a),this.reservedBit=new Uint8Array(a*a)}return n.prototype.set=function(a,i,t,e){const r=a*this.size+i;this.data[r]=t,e&&(this.reservedBit[r]=!0)},n.prototype.get=function(a,i){return this.data[a*this.size+i]},n.prototype.xor=function(a,i,t){this.data[a*this.size+i]^=t},n.prototype.isReserved=function(a,i){return this.reservedBit[a*this.size+i]},be=n,be}var Ee={},nt;function Wn(){return nt||(nt=1,function(n){const a=X().getSymbolSize;n.getRowColCoords=function(t){if(t===1)return[];const e=Math.floor(t/7)+2,r=a(t),s=r===145?26:Math.ceil((r-13)/(2*e-2))*2,l=[r-7];for(let o=1;o<e-1;o++)l[o]=l[o-1]-s;return l.push(6),l.reverse()},n.getPositions=function(t){const e=[],r=n.getRowColCoords(t),s=r.length;for(let l=0;l<s;l++)for(let o=0;o<s;o++)l===0&&o===0||l===0&&o===s-1||l===s-1&&o===0||e.push([r[l],r[o]]);return e}}(Ee)),Ee}var Be={},rt;function Xn(){if(rt)return Be;rt=1;const n=X().getSymbolSize,a=7;return Be.getPositions=function(t){const e=n(t);return[[0,0],[e-a,0],[0,e-a]]},Be}var Ie={},ot;function Zn(){return ot||(ot=1,function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const a={N1:3,N2:3,N3:40,N4:10};n.isValid=function(e){return e!=null&&e!==""&&!isNaN(e)&&e>=0&&e<=7},n.from=function(e){return n.isValid(e)?parseInt(e,10):void 0},n.getPenaltyN1=function(e){const r=e.size;let s=0,l=0,o=0,u=null,g=null;for(let _=0;_<r;_++){l=o=0,u=g=null;for(let y=0;y<r;y++){let h=e.get(_,y);h===u?l++:(l>=5&&(s+=a.N1+(l-5)),u=h,l=1),h=e.get(y,_),h===g?o++:(o>=5&&(s+=a.N1+(o-5)),g=h,o=1)}l>=5&&(s+=a.N1+(l-5)),o>=5&&(s+=a.N1+(o-5))}return s},n.getPenaltyN2=function(e){const r=e.size;let s=0;for(let l=0;l<r-1;l++)for(let o=0;o<r-1;o++){const u=e.get(l,o)+e.get(l,o+1)+e.get(l+1,o)+e.get(l+1,o+1);(u===4||u===0)&&s++}return s*a.N2},n.getPenaltyN3=function(e){const r=e.size;let s=0,l=0,o=0;for(let u=0;u<r;u++){l=o=0;for(let g=0;g<r;g++)l=l<<1&2047|e.get(u,g),g>=10&&(l===1488||l===93)&&s++,o=o<<1&2047|e.get(g,u),g>=10&&(o===1488||o===93)&&s++}return s*a.N3},n.getPenaltyN4=function(e){let r=0;const s=e.data.length;for(let o=0;o<s;o++)r+=e.data[o];return Math.abs(Math.ceil(r*100/s/5)-10)*a.N4};function i(t,e,r){switch(t){case n.Patterns.PATTERN000:return(e+r)%2===0;case n.Patterns.PATTERN001:return e%2===0;case n.Patterns.PATTERN010:return r%3===0;case n.Patterns.PATTERN011:return(e+r)%3===0;case n.Patterns.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2===0;case n.Patterns.PATTERN101:return e*r%2+e*r%3===0;case n.Patterns.PATTERN110:return(e*r%2+e*r%3)%2===0;case n.Patterns.PATTERN111:return(e*r%3+(e+r)%2)%2===0;default:throw new Error("bad maskPattern:"+t)}}n.applyMask=function(e,r){const s=r.size;for(let l=0;l<s;l++)for(let o=0;o<s;o++)r.isReserved(o,l)||r.xor(o,l,i(e,o,l))},n.getBestMask=function(e,r){const s=Object.keys(n.Patterns).length;let l=0,o=1/0;for(let u=0;u<s;u++){r(u),n.applyMask(u,e);const g=n.getPenaltyN1(e)+n.getPenaltyN2(e)+n.getPenaltyN3(e)+n.getPenaltyN4(e);n.applyMask(u,e),g<o&&(o=g,l=u)}return l}}(Ie)),Ie}var se={},it;function Mt(){if(it)return se;it=1;const n=Oe(),a=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],i=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return se.getBlocksCount=function(e,r){switch(r){case n.L:return a[(e-1)*4+0];case n.M:return a[(e-1)*4+1];case n.Q:return a[(e-1)*4+2];case n.H:return a[(e-1)*4+3];default:return}},se.getTotalCodewordsCount=function(e,r){switch(r){case n.L:return i[(e-1)*4+0];case n.M:return i[(e-1)*4+1];case n.Q:return i[(e-1)*4+2];case n.H:return i[(e-1)*4+3];default:return}},se}var Se={},re={},at;function er(){if(at)return re;at=1;const n=new Uint8Array(512),a=new Uint8Array(256);return function(){let t=1;for(let e=0;e<255;e++)n[e]=t,a[t]=e,t<<=1,t&256&&(t^=285);for(let e=255;e<512;e++)n[e]=n[e-255]}(),re.log=function(t){if(t<1)throw new Error("log("+t+")");return a[t]},re.exp=function(t){return n[t]},re.mul=function(t,e){return t===0||e===0?0:n[a[t]+a[e]]},re}var st;function tr(){return st||(st=1,function(n){const a=er();n.mul=function(t,e){const r=new Uint8Array(t.length+e.length-1);for(let s=0;s<t.length;s++)for(let l=0;l<e.length;l++)r[s+l]^=a.mul(t[s],e[l]);return r},n.mod=function(t,e){let r=new Uint8Array(t);for(;r.length-e.length>=0;){const s=r[0];for(let o=0;o<e.length;o++)r[o]^=a.mul(e[o],s);let l=0;for(;l<r.length&&r[l]===0;)l++;r=r.slice(l)}return r},n.generateECPolynomial=function(t){let e=new Uint8Array([1]);for(let r=0;r<t;r++)e=n.mul(e,new Uint8Array([1,a.exp(r)]));return e}}(Se)),Se}var Ae,lt;function nr(){if(lt)return Ae;lt=1;const n=tr();function a(i){this.genPoly=void 0,this.degree=i,this.degree&&this.initialize(this.degree)}return a.prototype.initialize=function(t){this.degree=t,this.genPoly=n.generateECPolynomial(this.degree)},a.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(t.length+this.degree);e.set(t);const r=n.mod(e,this.genPoly),s=this.degree-r.length;if(s>0){const l=new Uint8Array(this.degree);return l.set(r,s),l}return r},Ae=a,Ae}var Te={},Pe={},ke={},ut;function Lt(){return ut||(ut=1,ke.isValid=function(a){return!isNaN(a)&&a>=1&&a<=40}),ke}var z={},ct;function Dt(){if(ct)return z;ct=1;const n="[0-9]+",a="[A-Z $%*+\\-./:]+";let i="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";i=i.replace(/u/g,"\\u");const t="(?:(?![A-Z0-9 $%*+\\-./:]|"+i+`)(?:.|[\r
]))+`;z.KANJI=new RegExp(i,"g"),z.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),z.BYTE=new RegExp(t,"g"),z.NUMERIC=new RegExp(n,"g"),z.ALPHANUMERIC=new RegExp(a,"g");const e=new RegExp("^"+i+"$"),r=new RegExp("^"+n+"$"),s=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return z.testKanji=function(o){return e.test(o)},z.testNumeric=function(o){return r.test(o)},z.testAlphanumeric=function(o){return s.test(o)},z}var dt;function Z(){return dt||(dt=1,function(n){const a=Lt(),i=Dt();n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(r,s){if(!r.ccBits)throw new Error("Invalid mode: "+r);if(!a.isValid(s))throw new Error("Invalid version: "+s);return s>=1&&s<10?r.ccBits[0]:s<27?r.ccBits[1]:r.ccBits[2]},n.getBestModeForData=function(r){return i.testNumeric(r)?n.NUMERIC:i.testAlphanumeric(r)?n.ALPHANUMERIC:i.testKanji(r)?n.KANJI:n.BYTE},n.toString=function(r){if(r&&r.id)return r.id;throw new Error("Invalid mode")},n.isValid=function(r){return r&&r.bit&&r.ccBits};function t(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+e)}}n.from=function(r,s){if(n.isValid(r))return r;try{return t(r)}catch{return s}}}(Pe)),Pe}var ft;function rr(){return ft||(ft=1,function(n){const a=X(),i=Mt(),t=Oe(),e=Z(),r=Lt(),s=7973,l=a.getBCHDigit(s);function o(y,h,b){for(let A=1;A<=40;A++)if(h<=n.getCapacity(A,b,y))return A}function u(y,h){return e.getCharCountIndicator(y,h)+4}function g(y,h){let b=0;return y.forEach(function(A){const N=u(A.mode,h);b+=N+A.getBitsLength()}),b}function _(y,h){for(let b=1;b<=40;b++)if(g(y,b)<=n.getCapacity(b,h,e.MIXED))return b}n.from=function(h,b){return r.isValid(h)?parseInt(h,10):b},n.getCapacity=function(h,b,A){if(!r.isValid(h))throw new Error("Invalid QR Code version");typeof A>"u"&&(A=e.BYTE);const N=a.getSymbolTotalCodewords(h),B=i.getTotalCodewordsCount(h,b),T=(N-B)*8;if(A===e.MIXED)return T;const I=T-u(A,h);switch(A){case e.NUMERIC:return Math.floor(I/10*3);case e.ALPHANUMERIC:return Math.floor(I/11*2);case e.KANJI:return Math.floor(I/13);case e.BYTE:default:return Math.floor(I/8)}},n.getBestVersionForData=function(h,b){let A;const N=t.from(b,t.M);if(Array.isArray(h)){if(h.length>1)return _(h,N);if(h.length===0)return 1;A=h[0]}else A=h;return o(A.mode,A.getLength(),N)},n.getEncodedBits=function(h){if(!r.isValid(h)||h<7)throw new Error("Invalid QR Code version");let b=h<<12;for(;a.getBCHDigit(b)-l>=0;)b^=s<<a.getBCHDigit(b)-l;return h<<12|b}}(Te)),Te}var qe={},gt;function or(){if(gt)return qe;gt=1;const n=X(),a=1335,i=21522,t=n.getBCHDigit(a);return qe.getEncodedBits=function(r,s){const l=r.bit<<3|s;let o=l<<10;for(;n.getBCHDigit(o)-t>=0;)o^=a<<n.getBCHDigit(o)-t;return(l<<10|o)^i},qe}var Re={},Ne,ht;function ir(){if(ht)return Ne;ht=1;const n=Z();function a(i){this.mode=n.NUMERIC,this.data=i.toString()}return a.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(t){let e,r,s;for(e=0;e+3<=this.data.length;e+=3)r=this.data.substr(e,3),s=parseInt(r,10),t.put(s,10);const l=this.data.length-e;l>0&&(r=this.data.substr(e),s=parseInt(r,10),t.put(s,l*3+1))},Ne=a,Ne}var Me,mt;function ar(){if(mt)return Me;mt=1;const n=Z(),a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function i(t){this.mode=n.ALPHANUMERIC,this.data=t}return i.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(e){let r;for(r=0;r+2<=this.data.length;r+=2){let s=a.indexOf(this.data[r])*45;s+=a.indexOf(this.data[r+1]),e.put(s,11)}this.data.length%2&&e.put(a.indexOf(this.data[r]),6)},Me=i,Me}var Le,pt;function sr(){if(pt)return Le;pt=1;const n=Z();function a(i){this.mode=n.BYTE,typeof i=="string"?this.data=new TextEncoder().encode(i):this.data=new Uint8Array(i)}return a.getBitsLength=function(t){return t*8},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(i){for(let t=0,e=this.data.length;t<e;t++)i.put(this.data[t],8)},Le=a,Le}var De,_t;function lr(){if(_t)return De;_t=1;const n=Z(),a=X();function i(t){this.mode=n.KANJI,this.data=t}return i.getBitsLength=function(e){return e*13},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let r=a.toSJIS(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),t.put(r,13)}},De=i,De}var $e={exports:{}},yt;function ur(){return yt||(yt=1,function(n){var a={single_source_shortest_paths:function(i,t,e){var r={},s={};s[t]=0;var l=a.PriorityQueue.make();l.push(t,0);for(var o,u,g,_,y,h,b,A,N;!l.empty();){o=l.pop(),u=o.value,_=o.cost,y=i[u]||{};for(g in y)y.hasOwnProperty(g)&&(h=y[g],b=_+h,A=s[g],N=typeof s[g]>"u",(N||A>b)&&(s[g]=b,l.push(g,b),r[g]=u))}if(typeof e<"u"&&typeof s[e]>"u"){var B=["Could not find a path from ",t," to ",e,"."].join("");throw new Error(B)}return r},extract_shortest_path_from_predecessor_list:function(i,t){for(var e=[],r=t;r;)e.push(r),i[r],r=i[r];return e.reverse(),e},find_path:function(i,t,e){var r=a.single_source_shortest_paths(i,t,e);return a.extract_shortest_path_from_predecessor_list(r,e)},PriorityQueue:{make:function(i){var t=a.PriorityQueue,e={},r;i=i||{};for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e.queue=[],e.sorter=i.sorter||t.default_sorter,e},default_sorter:function(i,t){return i.cost-t.cost},push:function(i,t){var e={value:i,cost:t};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=a}($e)),$e.exports}var wt;function cr(){return wt||(wt=1,function(n){const a=Z(),i=ir(),t=ar(),e=sr(),r=lr(),s=Dt(),l=X(),o=ur();function u(B){return unescape(encodeURIComponent(B)).length}function g(B,T,I){const E=[];let L;for(;(L=B.exec(I))!==null;)E.push({data:L[0],index:L.index,mode:T,length:L[0].length});return E}function _(B){const T=g(s.NUMERIC,a.NUMERIC,B),I=g(s.ALPHANUMERIC,a.ALPHANUMERIC,B);let E,L;return l.isKanjiModeEnabled()?(E=g(s.BYTE,a.BYTE,B),L=g(s.KANJI,a.KANJI,B)):(E=g(s.BYTE_KANJI,a.BYTE,B),L=[]),T.concat(I,E,L).sort(function(w,v){return w.index-v.index}).map(function(w){return{data:w.data,mode:w.mode,length:w.length}})}function y(B,T){switch(T){case a.NUMERIC:return i.getBitsLength(B);case a.ALPHANUMERIC:return t.getBitsLength(B);case a.KANJI:return r.getBitsLength(B);case a.BYTE:return e.getBitsLength(B)}}function h(B){return B.reduce(function(T,I){const E=T.length-1>=0?T[T.length-1]:null;return E&&E.mode===I.mode?(T[T.length-1].data+=I.data,T):(T.push(I),T)},[])}function b(B){const T=[];for(let I=0;I<B.length;I++){const E=B[I];switch(E.mode){case a.NUMERIC:T.push([E,{data:E.data,mode:a.ALPHANUMERIC,length:E.length},{data:E.data,mode:a.BYTE,length:E.length}]);break;case a.ALPHANUMERIC:T.push([E,{data:E.data,mode:a.BYTE,length:E.length}]);break;case a.KANJI:T.push([E,{data:E.data,mode:a.BYTE,length:u(E.data)}]);break;case a.BYTE:T.push([{data:E.data,mode:a.BYTE,length:u(E.data)}])}}return T}function A(B,T){const I={},E={start:{}};let L=["start"];for(let p=0;p<B.length;p++){const w=B[p],v=[];for(let c=0;c<w.length;c++){const d=w[c],f=""+p+c;v.push(f),I[f]={node:d,lastCount:0},E[f]={};for(let C=0;C<L.length;C++){const m=L[C];I[m]&&I[m].node.mode===d.mode?(E[m][f]=y(I[m].lastCount+d.length,d.mode)-y(I[m].lastCount,d.mode),I[m].lastCount+=d.length):(I[m]&&(I[m].lastCount=d.length),E[m][f]=y(d.length,d.mode)+4+a.getCharCountIndicator(d.mode,T))}}L=v}for(let p=0;p<L.length;p++)E[L[p]].end=0;return{map:E,table:I}}function N(B,T){let I;const E=a.getBestModeForData(B);if(I=a.from(T,E),I!==a.BYTE&&I.bit<E.bit)throw new Error('"'+B+'" cannot be encoded with mode '+a.toString(I)+`.
 Suggested mode is: `+a.toString(E));switch(I===a.KANJI&&!l.isKanjiModeEnabled()&&(I=a.BYTE),I){case a.NUMERIC:return new i(B);case a.ALPHANUMERIC:return new t(B);case a.KANJI:return new r(B);case a.BYTE:return new e(B)}}n.fromArray=function(T){return T.reduce(function(I,E){return typeof E=="string"?I.push(N(E,null)):E.data&&I.push(N(E.data,E.mode)),I},[])},n.fromString=function(T,I){const E=_(T,l.isKanjiModeEnabled()),L=b(E),p=A(L,I),w=o.find_path(p.map,"start","end"),v=[];for(let c=1;c<w.length-1;c++)v.push(p.table[w[c]].node);return n.fromArray(h(v))},n.rawSplit=function(T){return n.fromArray(_(T,l.isKanjiModeEnabled()))}}(Re)),Re}var vt;function dr(){if(vt)return we;vt=1;const n=X(),a=Oe(),i=Gn(),t=jn(),e=Wn(),r=Xn(),s=Zn(),l=Mt(),o=nr(),u=rr(),g=or(),_=Z(),y=cr();function h(p,w){const v=p.size,c=r.getPositions(w);for(let d=0;d<c.length;d++){const f=c[d][0],C=c[d][1];for(let m=-1;m<=7;m++)if(!(f+m<=-1||v<=f+m))for(let S=-1;S<=7;S++)C+S<=-1||v<=C+S||(m>=0&&m<=6&&(S===0||S===6)||S>=0&&S<=6&&(m===0||m===6)||m>=2&&m<=4&&S>=2&&S<=4?p.set(f+m,C+S,!0,!0):p.set(f+m,C+S,!1,!0))}}function b(p){const w=p.size;for(let v=8;v<w-8;v++){const c=v%2===0;p.set(v,6,c,!0),p.set(6,v,c,!0)}}function A(p,w){const v=e.getPositions(w);for(let c=0;c<v.length;c++){const d=v[c][0],f=v[c][1];for(let C=-2;C<=2;C++)for(let m=-2;m<=2;m++)C===-2||C===2||m===-2||m===2||C===0&&m===0?p.set(d+C,f+m,!0,!0):p.set(d+C,f+m,!1,!0)}}function N(p,w){const v=p.size,c=u.getEncodedBits(w);let d,f,C;for(let m=0;m<18;m++)d=Math.floor(m/3),f=m%3+v-8-3,C=(c>>m&1)===1,p.set(d,f,C,!0),p.set(f,d,C,!0)}function B(p,w,v){const c=p.size,d=g.getEncodedBits(w,v);let f,C;for(f=0;f<15;f++)C=(d>>f&1)===1,f<6?p.set(f,8,C,!0):f<8?p.set(f+1,8,C,!0):p.set(c-15+f,8,C,!0),f<8?p.set(8,c-f-1,C,!0):f<9?p.set(8,15-f-1+1,C,!0):p.set(8,15-f-1,C,!0);p.set(c-8,8,1,!0)}function T(p,w){const v=p.size;let c=-1,d=v-1,f=7,C=0;for(let m=v-1;m>0;m-=2)for(m===6&&m--;;){for(let S=0;S<2;S++)if(!p.isReserved(d,m-S)){let V=!1;C<w.length&&(V=(w[C]>>>f&1)===1),p.set(d,m-S,V),f--,f===-1&&(C++,f=7)}if(d+=c,d<0||v<=d){d-=c,c=-c;break}}}function I(p,w,v){const c=new i;v.forEach(function(S){c.put(S.mode.bit,4),c.put(S.getLength(),_.getCharCountIndicator(S.mode,p)),S.write(c)});const d=n.getSymbolTotalCodewords(p),f=l.getTotalCodewordsCount(p,w),C=(d-f)*8;for(c.getLengthInBits()+4<=C&&c.put(0,4);c.getLengthInBits()%8!==0;)c.putBit(0);const m=(C-c.getLengthInBits())/8;for(let S=0;S<m;S++)c.put(S%2?17:236,8);return E(c,p,w)}function E(p,w,v){const c=n.getSymbolTotalCodewords(w),d=l.getTotalCodewordsCount(w,v),f=c-d,C=l.getBlocksCount(w,v),m=c%C,S=C-m,V=Math.floor(c/C),Y=Math.floor(f/C),Ft=Y+1,He=V-Y,Ut=new o(He);let he=0;const ae=new Array(C),Ke=new Array(C);let me=0;const Vt=new Uint8Array(p.buffer);for(let ee=0;ee<C;ee++){const _e=ee<S?Y:Ft;ae[ee]=Vt.slice(he,he+_e),Ke[ee]=Ut.encode(ae[ee]),he+=_e,me=Math.max(me,_e)}const pe=new Uint8Array(c);let Je=0,H,K;for(H=0;H<me;H++)for(K=0;K<C;K++)H<ae[K].length&&(pe[Je++]=ae[K][H]);for(H=0;H<He;H++)for(K=0;K<C;K++)pe[Je++]=Ke[K][H];return pe}function L(p,w,v,c){let d;if(Array.isArray(p))d=y.fromArray(p);else if(typeof p=="string"){let V=w;if(!V){const Y=y.rawSplit(p);V=u.getBestVersionForData(Y,v)}d=y.fromString(p,V||40)}else throw new Error("Invalid data");const f=u.getBestVersionForData(d,v);if(!f)throw new Error("The amount of data is too big to be stored in a QR Code");if(!w)w=f;else if(w<f)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+f+`.
`);const C=I(w,v,d),m=n.getSymbolSize(w),S=new t(m);return h(S,w),b(S),A(S,w),B(S,v,0),w>=7&&N(S,w),T(S,C),isNaN(c)&&(c=s.getBestMask(S,B.bind(null,S,v))),s.applyMask(c,S),B(S,v,c),{modules:S,version:w,errorCorrectionLevel:v,maskPattern:c,segments:d}}return we.create=function(w,v){if(typeof w>"u"||w==="")throw new Error("No input text");let c=a.M,d,f;return typeof v<"u"&&(c=a.from(v.errorCorrectionLevel,a.M),d=u.from(v.version),f=s.from(v.maskPattern),v.toSJISFunc&&n.setToSJISFunction(v.toSJISFunc)),L(w,d,c,f)},we}var Fe={},Ue={},Ct;function $t(){return Ct||(Ct=1,function(n){function a(i){if(typeof i=="number"&&(i=i.toString()),typeof i!="string")throw new Error("Color should be defined as hex string");let t=i.slice().replace("#","").split("");if(t.length<3||t.length===5||t.length>8)throw new Error("Invalid hex color: "+i);(t.length===3||t.length===4)&&(t=Array.prototype.concat.apply([],t.map(function(r){return[r,r]}))),t.length===6&&t.push("F","F");const e=parseInt(t.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:e&255,hex:"#"+t.slice(0,6).join("")}}n.getOptions=function(t){t||(t={}),t.color||(t.color={});const e=typeof t.margin>"u"||t.margin===null||t.margin<0?4:t.margin,r=t.width&&t.width>=21?t.width:void 0,s=t.scale||4;return{width:r,scale:r?4:s,margin:e,color:{dark:a(t.color.dark||"#000000ff"),light:a(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},n.getScale=function(t,e){return e.width&&e.width>=t+e.margin*2?e.width/(t+e.margin*2):e.scale},n.getImageWidth=function(t,e){const r=n.getScale(t,e);return Math.floor((t+e.margin*2)*r)},n.qrToImageData=function(t,e,r){const s=e.modules.size,l=e.modules.data,o=n.getScale(s,r),u=Math.floor((s+r.margin*2)*o),g=r.margin*o,_=[r.color.light,r.color.dark];for(let y=0;y<u;y++)for(let h=0;h<u;h++){let b=(y*u+h)*4,A=r.color.light;if(y>=g&&h>=g&&y<u-g&&h<u-g){const N=Math.floor((y-g)/o),B=Math.floor((h-g)/o);A=_[l[N*s+B]?1:0]}t[b++]=A.r,t[b++]=A.g,t[b++]=A.b,t[b]=A.a}}}(Ue)),Ue}var bt;function fr(){return bt||(bt=1,function(n){const a=$t();function i(e,r,s){e.clearRect(0,0,r.width,r.height),r.style||(r.style={}),r.height=s,r.width=s,r.style.height=s+"px",r.style.width=s+"px"}function t(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(r,s,l){let o=l,u=s;typeof o>"u"&&(!s||!s.getContext)&&(o=s,s=void 0),s||(u=t()),o=a.getOptions(o);const g=a.getImageWidth(r.modules.size,o),_=u.getContext("2d"),y=_.createImageData(g,g);return a.qrToImageData(y.data,r,o),i(_,u,g),_.putImageData(y,0,0),u},n.renderToDataURL=function(r,s,l){let o=l;typeof o>"u"&&(!s||!s.getContext)&&(o=s,s=void 0),o||(o={});const u=n.render(r,s,o),g=o.type||"image/png",_=o.rendererOpts||{};return u.toDataURL(g,_.quality)}}(Fe)),Fe}var Ve={},Et;function gr(){if(Et)return Ve;Et=1;const n=$t();function a(e,r){const s=e.a/255,l=r+'="'+e.hex+'"';return s<1?l+" "+r+'-opacity="'+s.toFixed(2).slice(1)+'"':l}function i(e,r,s){let l=e+r;return typeof s<"u"&&(l+=" "+s),l}function t(e,r,s){let l="",o=0,u=!1,g=0;for(let _=0;_<e.length;_++){const y=Math.floor(_%r),h=Math.floor(_/r);!y&&!u&&(u=!0),e[_]?(g++,_>0&&y>0&&e[_-1]||(l+=u?i("M",y+s,.5+h+s):i("m",o,0),o=0,u=!1),y+1<r&&e[_+1]||(l+=i("h",g),g=0)):o++}return l}return Ve.render=function(r,s,l){const o=n.getOptions(s),u=r.modules.size,g=r.modules.data,_=u+o.margin*2,y=o.color.light.a?"<path "+a(o.color.light,"fill")+' d="M0 0h'+_+"v"+_+'H0z"/>':"",h="<path "+a(o.color.dark,"stroke")+' d="'+t(g,u,o.margin)+'"/>',b='viewBox="0 0 '+_+" "+_+'"',N='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+b+' shape-rendering="crispEdges">'+y+h+`</svg>
`;return typeof l=="function"&&l(null,N),N},Ve}var Bt;function hr(){if(Bt)return te;Bt=1;const n=Yn(),a=dr(),i=fr(),t=gr();function e(r,s,l,o,u){const g=[].slice.call(arguments,1),_=g.length,y=typeof g[_-1]=="function";if(!y&&!n())throw new Error("Callback required as last argument");if(y){if(_<2)throw new Error("Too few arguments provided");_===2?(u=l,l=s,s=o=void 0):_===3&&(s.getContext&&typeof u>"u"?(u=o,o=void 0):(u=o,o=l,l=s,s=void 0))}else{if(_<1)throw new Error("Too few arguments provided");return _===1?(l=s,s=o=void 0):_===2&&!s.getContext&&(o=l,l=s,s=void 0),new Promise(function(h,b){try{const A=a.create(l,o);h(r(A,s,o))}catch(A){b(A)}})}try{const h=a.create(l,o);u(null,r(h,s,o))}catch(h){u(h)}}return te.create=a.create,te.toCanvas=e.bind(null,i.render),te.toDataURL=e.bind(null,i.renderToDataURL),te.toString=e.bind(null,function(r,s,l){return t.render(r,l)}),te}var mr=hr();const pr=Xt(mr);function _r(n,a){const i=Zt(n),t=J("");return ie(i,async e=>{i.value&&en&&(t.value=await pr.toDataURL(e,a))},{immediate:!0}),t}const yr=["src"],wr=j({__name:"PageQrCode",props:{url:{},textAbove:{},textBelow:{}},setup(n){const i=qt(n,"url"),t=_r(i,{errorCorrectionLevel:"L",margin:1,width:200});return(e,r)=>(P(),R(fe,{class:"pb-card-qrcode no-shadow",style:{width:"200px"}},{default:q(()=>[e.textAbove?(P(),R(W,{key:0,class:"pb-qrcode-text-above q-pa-sm"},{default:q(()=>[de(O(e.textAbove),1)]),_:1})):D("",!0),k(W,{class:"pb-qrcode-code q-pa-none q-px-sm"},{default:q(()=>[x("img",{src:M(t),style:{width:"100%"}},null,8,yr)]),_:1}),e.textBelow?(P(),R(W,{key:1,class:"pb-qrcode-text-below q-pa-sm"},{default:q(()=>[de(O(e.textBelow),1)]),_:1})):D("",!0)]),_:1}))}}),vr=Nt(wr,[["__scopeId","data-v-202295d8"]]),Cr=xe({name:"QCarouselSlide",props:{...xt,imgSrc:String},setup(n,{slots:a}){const i=$(()=>n.imgSrc?{backgroundImage:`url("${n.imgSrc}")`}:{});return()=>Q("div",{class:"q-carousel__slide",style:i.value},tn(a.default))}}),br=["top","right","bottom","left"],Er=["regular","flat","outline","push","unelevated"],Br=xe({name:"QCarousel",props:{...nn,...Ot,...Cn,transitionPrev:{type:String,default:"fade"},transitionNext:{type:String,default:"fade"},height:String,padding:Boolean,controlColor:String,controlTextColor:String,controlType:{type:String,validator:n=>Er.includes(n),default:"flat"},autoplay:[Number,Boolean],arrows:Boolean,prevIcon:String,nextIcon:String,navigation:Boolean,navigationPosition:{type:String,validator:n=>br.includes(n)},navigationIcon:String,navigationActiveIcon:String,thumbnails:Boolean},emits:[...vn,...zt],setup(n,{slots:a}){const{proxy:{$q:i}}=rn(),t=on(n,i);let e=null,r;const{updatePanelsList:s,getPanelContent:l,panelDirectives:o,goToPanel:u,previousPanel:g,nextPanel:_,getEnabledPanels:y,panelIndex:h}=Ht(),{inFullscreen:b}=bn(),A=$(()=>b.value!==!0&&n.height!==void 0?{height:n.height}:{}),N=$(()=>n.vertical===!0?"vertical":"horizontal"),B=$(()=>n.navigationPosition||(n.vertical===!0?"right":"bottom")),T=$(()=>`q-carousel q-panel-parent q-carousel--with${n.padding===!0?"":"out"}-padding`+(b.value===!0?" fullscreen":"")+(t.value===!0?" q-carousel--dark q-dark":"")+(n.arrows===!0?` q-carousel--arrows-${N.value}`:"")+(n.navigation===!0?` q-carousel--navigation-${B.value}`:"")),I=$(()=>{const d=[n.prevIcon||i.iconSet.carousel[n.vertical===!0?"up":"left"],n.nextIcon||i.iconSet.carousel[n.vertical===!0?"down":"right"]];return n.vertical===!1&&i.lang.rtl===!0?d.reverse():d}),E=$(()=>n.navigationIcon||i.iconSet.carousel.navigationIcon),L=$(()=>n.navigationActiveIcon||E.value),p=$(()=>({color:n.controlColor,textColor:n.controlTextColor,round:!0,[n.controlType]:!0,dense:!0}));ie(()=>n.modelValue,()=>{n.autoplay&&w()}),ie(()=>n.autoplay,d=>{d?w():e!==null&&(clearTimeout(e),e=null)});function w(){const d=Tt(n.autoplay)===!0?Math.abs(n.autoplay):5e3;e!==null&&clearTimeout(e),e=setTimeout(()=>{e=null,d>=0?_():g()},d)}ze(()=>{n.autoplay&&w()}),kt(()=>{e!==null&&clearTimeout(e)});function v(d,f){return Q("div",{class:`q-carousel__control q-carousel__navigation no-wrap absolute flex q-carousel__navigation--${d} q-carousel__navigation--${B.value}`+(n.controlColor!==void 0?` text-${n.controlColor}`:"")},[Q("div",{class:"q-carousel__navigation-inner flex flex-center no-wrap"},y().map(f))])}function c(){const d=[];if(n.navigation===!0){const f=a["navigation-icon"]!==void 0?a["navigation-icon"]:m=>Q(F,{key:"nav"+m.name,class:`q-carousel__navigation-icon q-carousel__navigation-icon--${m.active===!0?"":"in"}active`,...m.btnProps,onClick:m.onClick}),C=r-1;d.push(v("buttons",(m,S)=>{const V=m.props.name,Y=h.value===S;return f({index:S,maxIndex:C,name:V,active:Y,btnProps:{icon:Y===!0?L.value:E.value,size:"sm",...p.value},onClick:()=>{u(V)}})}))}else if(n.thumbnails===!0){const f=n.controlColor!==void 0?` text-${n.controlColor}`:"";d.push(v("thumbnails",C=>{const m=C.props;return Q("img",{key:"tmb#"+m.name,class:`q-carousel__thumbnail q-carousel__thumbnail--${m.name===n.modelValue?"":"in"}active`+f,src:m.imgSrc||m["img-src"],onClick:()=>{u(m.name)}})}))}return n.arrows===!0&&h.value>=0&&((n.infinite===!0||h.value>0)&&d.push(Q("div",{key:"prev",class:`q-carousel__control q-carousel__arrow q-carousel__prev-arrow q-carousel__prev-arrow--${N.value} absolute flex flex-center`},[Q(F,{icon:I.value[0],...p.value,onClick:g})])),(n.infinite===!0||h.value<r-1)&&d.push(Q("div",{key:"next",class:`q-carousel__control q-carousel__arrow q-carousel__next-arrow q-carousel__next-arrow--${N.value} absolute flex flex-center`},[Q(F,{icon:I.value[1],...p.value,onClick:_})]))),sn(a.control,d)}return()=>(r=s(a),Q("div",{class:T.value,style:A.value},[an("div",{class:"q-carousel__slides-container"},l(),"sl-cont",n.swipeable,()=>o.value)].concat(c())))}}),Ir=j({__name:"PageCarouselView",props:{slicedImages:{},mediaitemId:{}},emits:["triggerChangedItem"],setup(n,{emit:a}){const i=n,t=qt(i.mediaitemId);ie(()=>i.mediaitemId,l=>{t.value=l});const e=a;function r(){console.log("TODO: add method to close dialog programmatically")}function s(l){e("triggerChangedItem",l)}return(l,o)=>oe((P(),R(Br,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=u=>t.value=u),class:"",style:{width:"100%",height:"100%"},"control-type":"flat","control-color":"primary",swipeable:"",animated:"",draggable:"false",arrows:!0,infinite:!0,"transition-prev":"slide-right","transition-next":"slide-left",onTransition:s},{default:q(()=>[(P(!0),U(ne,null,ge(i.slicedImages,u=>(P(),R(Cr,{key:u.id,name:u.id,class:"column no-wrap flex-center full-height q-pa-sm"},{default:q(()=>[k(En,{item:u},null,8,["item"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])),[[Kt,r,void 0,{mouse:!0,down:!0}]])}}),Sr={key:0,class:"fixed-full"},Ar={key:1},Yr=j({__name:"GalleryDetailPage",props:{startTimer:{type:Boolean},forceShowDeleteButton:{type:Boolean}},setup(n){const a=hn(),i=cn(),t=dn(),e=ln(),r=un(),s=J(""),l=J(!1),o=J(!1),u=J(!1),g=J(!1),_=J(0),y=n;St(()=>{s.value=i.params.id}),ie(i,c=>{s.value=c.params.id}),ze(()=>{o.value=y.startTimer});const h=c=>{s.value=c},b=$(()=>I(s.value)),A=$(()=>{if(e.configuration.qrshare.enabled)return`${e.configuration.qrshare.shareservice_url}?action=download&id=${s.value}`;{const c=e.configuration.qrshare.share_custom_qr_url,d=f=>f.split(/[\\/]/).pop();return c.replace("{filename}",d(b.value.processed)).replace("{identifier}",s.value)}}),N=$(()=>r.collection.findIndex(c=>c.id==s.value)+1),B=$(()=>e.configuration.uisettings.gallery_show_filter&&E(b.value.media_type)),T=$(()=>{const c=[];return e.configuration.share.actions.forEach((f,C)=>{const m={config_index:C,handles_images_only:f.handles_images_only,show_button:f.trigger.ui_trigger.show_button,title:f.trigger.ui_trigger.title,icon:f.trigger.ui_trigger.icon};c.push(m)}),c}),I=c=>r.collection.find(d=>d.id==c),E=c=>["image","collageimage","animationimage"].includes(c),L=(c,d)=>{u.value=!0,fetch(`/api/mediaprocessing/applyfilter/${c}/${d}`).then(f=>{if(!f.ok)throw new Error("Server returned "+f.status);u.value=!1}).catch(f=>{console.error(f),u.value=!1})},p=c=>{s.value=void 0,r.deleteItem(c),t.back()},w=c=>{console.log("doShareAction",s.value,c),e.configuration.share.actions[c].processing.ask_user_for_parameter_input?(_.value=c,g.value=!0):fn(`/api/share/actions/${s.value}/${c}`,"POST")},v=async(c,d)=>{console.warn(s.value,c,d),console.log(JSON.stringify(d));try{const f=await gn(`/api/share/actions/${s.value}/${c}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(console.log(f),!f.ok)throw`Error: ${f.status} ${f.statusText}`}catch(f){console.error(f),a.notify({message:f,caption:"Request Error!",color:"negative"})}};return(c,d)=>(P(),R(pn,{view:"hhh Lpr ffr",onClick:d[6]||(d[6]=f=>o.value=!1)},{default:q(()=>[b.value?(P(),U("div",Sr,[k(Qt,{class:"bg-primary text-white"},{default:q(()=>[o.value?(P(),R(Qn,{key:0,duration:M(e).configuration.uisettings.AUTOCLOSE_NEW_ITEM_ARRIVED,onTriggerTimeout:d[0]||(d[0]=f=>c.$router.push({path:"/"}))},null,8,["duration"])):D("",!0),u.value?(P(),R(On,{key:1})):D("",!0)]),_:1}),B.value?(P(),R(Jt,{key:0,id:"gallery-drawer-filters",modelValue:l.value,"onUpdate:modelValue":d[1]||(d[1]=f=>l.value=f),class:"q-pa-sm",side:"right",overlay:"",elevated:""},{default:q(()=>[l.value?(P(),R(Jn,{key:0,id:b.value.id,"available-filter":M(e).configuration.uisettings.gallery_filter_userselectable,onTriggerApplyFilter:L},null,8,["id","available-filter"])):D("",!0)]),_:1},8,["modelValue"])):D("",!0),k(_n,{class:"q-pa-none galleryimagedetail full-height"},{default:q(()=>[k(mn,{class:"full-height"},{default:q(()=>[k(Ir,{"mediaitem-id":b.value.id,"sliced-images":M(r).collection,onTriggerChangedItem:h,onClick:d[2]||(d[2]=f=>l.value=!1)},null,8,["mediaitem-id","sliced-images"]),M(e).configuration.uisettings.gallery_show_qrcode?(P(),R(It,{key:0,position:"top-right",class:"q-ma-lg"},{default:q(()=>[k(vr,{url:A.value,"text-above":M(e).configuration.uisettings.qrcode_text_above,"text-below":M(e).configuration.uisettings.qrcode_text_below},null,8,["url","text-above","text-below"])]),_:1})):D("",!0),k(Vn,{item:b.value,"show-filter":M(e).configuration.uisettings.gallery_show_filter,"enable-filter":E(b.value.media_type),"show-share":M(e).configuration.uisettings.gallery_show_shareprint&&M(e).configuration.share.sharing_enabled,"share-direct-access-buttons":M(e).configuration.share.number_direct_access_buttons,"share-buttons":T.value,"show-delete":y.forceShowDeleteButton||M(e).configuration.uisettings.gallery_show_delete,"show-download":M(e).configuration.uisettings.gallery_show_download,image_number:N.value,images_total:M(r).collection_number_of_items,onTriggerToggleDisplayFilter:d[3]||(d[3]=f=>l.value=!l.value),onTriggerDeleteMediaitem:p,onTriggerShareAction:w},null,8,["item","show-filter","enable-filter","show-share","share-direct-access-buttons","share-buttons","show-delete","show-download","image_number","images_total"]),k(Pt,{modelValue:g.value,"onUpdate:modelValue":d[4]||(d[4]=f=>g.value=f)},{default:q(()=>[k(Rn,{parameters:M(e).configuration.share.actions[_.value].processing.parameters,parameters_dialog_caption:M(e).configuration.share.actions[_.value].processing.parameters_dialog_caption,parameters_dialog_action_icon:M(e).configuration.share.actions[_.value].processing.parameters_dialog_action_icon,parameters_dialog_action_label:M(e).configuration.share.actions[_.value].processing.parameters_dialog_action_label,config_index:_.value,onTriggerShareActionWithParameters:v},null,8,["parameters","parameters_dialog_caption","parameters_dialog_action_icon","parameters_dialog_action_label","config_index"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):(P(),U("div",Ar,[k(Bn)])),k(In,{onTriggerReturn:d[5]||(d[5]=f=>c.$router.back())}),k(Sn,{route:"/","timeout-ms":M(e).configuration.uisettings.show_frontpage_timeout*60*1e3},null,8,["timeout-ms"])]),_:1}))}});export{Yr as default};
