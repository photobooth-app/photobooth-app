import{x as ae,b8 as ne,aN as se,ap as le,a9 as ue,b9 as ie,aa as re,B as D,c as l,ab as ce,bt as de,a$ as fe,by as ve,ba as ge,bz as he,w as A,bC as me,bD as M,bE as be,bc as ye,bF as xe,aO as Pe,bG as Ce,bH as Te,A as H,Y as ke,W as Se,o as Oe,am as Ee,ak as Be}from"./index-xNQqj33s.js";import{v as qe,a as R,e as we,b as Fe,c as De,p as K,d as Ae,r as W,s as Me}from"./position-engine-CK4Pvj9M.js";const We=ae({name:"QMenu",inheritAttrs:!1,props:{...we,...ie,...ue,...le,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:R},self:{type:String,validator:R},offset:{type:Array,validator:qe},scrollTarget:se,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...ne,"click","escapeKey"],setup(e,{slots:c,emit:d,attrs:v}){let n=null,f,u,g;const P=re(),{proxy:h}=P,{$q:o}=h,a=D(null),s=D(!1),j=l(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),L=ce(e,o),{registerTick:Q,removeTick:_}=de(),{registerTimeout:C}=fe(),{transitionProps:$,transitionStyle:z}=ve(e),{localScrollTarget:T,changeScrollEvent:G,unconfigureScrollTarget:I}=Fe(e,w),{anchorEl:i,canShow:N}=De({showing:s}),{hide:k}=ge({showing:s,canShow:N,handleShow:X,handleHide:Z,hideOnRouteChange:j,processOnMount:!0}),{showPortal:S,hidePortal:O,renderPortal:U}=he(P,a,ee,"menu"),m={anchorEl:i,innerRef:a,onClickOutside(t){if(e.persistent!==!0&&s.value===!0)return k(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&Be(t),!0}},E=l(()=>K(e.anchor||(e.cover===!0?"center middle":"bottom start"),o.lang.rtl)),Y=l(()=>e.cover===!0?E.value:K(e.self||"top start",o.lang.rtl)),J=l(()=>(e.square===!0?" q-menu--square":"")+(L.value===!0?" q-menu--dark q-dark":"")),V=l(()=>e.autoClose===!0?{onClick:p}:{}),B=l(()=>s.value===!0&&e.persistent!==!0);A(B,t=>{t===!0?(me(y),Ae(m)):(M(y),W(m))});function b(){Ee(()=>{let t=a.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function X(t){if(n=e.noRefocus===!1?document.activeElement:null,be(F),S(),w(),f=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const x=ye(t);if(x.left!==void 0){const{top:te,left:oe}=i.value.getBoundingClientRect();f={left:x.left-oe,top:x.top-te}}}u===void 0&&(u=A(()=>o.screen.width+"|"+o.screen.height+"|"+e.self+"|"+e.anchor+"|"+o.lang.rtl,r)),e.noFocus!==!0&&document.activeElement.blur(),Q(()=>{r(),e.noFocus!==!0&&b()}),C(()=>{o.platform.is.ios===!0&&(g=e.autoClose,a.value.click()),r(),S(!0),d("show",t)},e.transitionDuration)}function Z(t){_(),O(),q(!0),n!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t?.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),C(()=>{O(!0),d("hide",t)},e.transitionDuration)}function q(t){f=void 0,u!==void 0&&(u(),u=void 0),(t===!0||s.value===!0)&&(xe(F),I(),W(m),M(y)),t!==!0&&(n=null)}function w(){(i.value!==null||e.scrollTarget!==void 0)&&(T.value=Pe(i.value,e.scrollTarget),G(T.value,r))}function p(t){g!==!0?(Ce(h,t),d("click",t)):g=!1}function F(t){B.value===!0&&e.noFocus!==!0&&Te(a.value,t.target)!==!0&&b()}function y(t){e.noEscDismiss!==!0&&(d("escapeKey"),k(t))}function r(){Me({targetEl:a.value,offset:e.offset,anchorEl:i.value,anchorOrigin:E.value,selfOrigin:Y.value,absoluteOffset:f,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ee(){return H(Se,$.value,()=>s.value===!0?H("div",{role:"menu",...v,ref:a,tabindex:-1,class:["q-menu q-position-engine scroll"+J.value,v.class],style:[v.style,z.value],...V.value},ke(c.default)):null)}return Oe(q),Object.assign(h,{focus:b,updatePosition:r}),U}});let He=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const c=document.createElement("div");Object.assign(c.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(c),e.scrollLeft=-1e3,He=e.scrollLeft>=0,e.remove()}export{We as Q,He as r};
