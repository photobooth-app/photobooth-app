import{Q as xe}from"./QHeader-BGRwqOIm.js";import{Q as Be}from"./QDrawer-CqZBXtFZ.js";import{Q as _e}from"./QPageSticky-azuHt250.js";import{x as ce,z as P,d as G,P as pe,c as _,n as b,Z as ie,p as w,q as y,$ as Y,D as U,F as H,B as Z,a0 as re,M as F,e as L,I as ee,H as X,a1 as ye,t as A,J as ae,Q as j,s as N,a2 as $e,a3 as ue,a4 as Le,a5 as we,L as qe,E as ne,a6 as De,a7 as Ce,G as z,l as le,o as be,N as Qe,f as R,W as Fe,Y as Oe,a8 as ze,a9 as Ue,w as oe,X as Ve,aa as Ge,ab as He,ac as We,u as Ye,i as Ke,h as Xe,j as Je,k as Ze,R as je,ad as se,v as et}from"./index-D599IcTa.js";import{Q as tt}from"./QPage-D_dUzHN4.js";import{Q as at,a as rt}from"./QLayout-DIRw287j.js";import{Q as ve}from"./QInput-LIxdUW5J.js";import{Q as nt}from"./QForm-KW5lqjyz.js";import{Q as ge}from"./QBadge-DoaxZ9Kv.js";import{b as ot}from"./media_is_type-DZvwXqkq.js";import{Q as Ee}from"./QLinearProgress-KRCgXISQ.js";import{_ as Se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as it}from"./QImg-CJyksKps.js";import{u as lt,a as st,b as ut,c as ct,T as dt}from"./use-panel-CyO03dSC.js";import{u as ft,a as vt,b as gt}from"./use-fullscreen-CvKPggrs.js";import{_ as Pe}from"./MediaItemPreviewViewer.vue_vue_type_script_setup_true_lang-CgF-XO5q.js";import{I as ht}from"./ItemNotAvailableError-uG2wDJ9P.js";import"./QResizeObserver-DYygKtsm.js";import"./format-CJebrXOQ.js";import"./use-id-C2xc-0Fa.js";import"./private.use-form-Ch4ljBnF.js";import"./selection-B3wgdKzO.js";const mt=ce({name:"QSpace",setup(){const r=P("div",{class:"q-space"});return()=>r}}),_t={class:"text-h6"},pt={class:"q-gutter-md"},yt={key:0},wt={key:1},Ct=G({__name:"PageShareParameters",props:{config_index:{},parameters_dialog_caption:{},parameters_dialog_action_icon:{},parameters_dialog_action_label:{},parameters:{}},emits:["triggerShareActionWithParameters"],setup(r,{emit:d}){const l=$e({}),s=r,i=d;pe(()=>{s.parameters.forEach(n=>l[n.key]=n.default)});const u=()=>{i("triggerShareActionWithParameters",s.config_index,l)};return(n,t)=>(_(),b(ie,{style:{width:"400px"},class:""},{default:w(()=>[y(nt,{autofocus:"",onSubmit:u,class:"q-gutter-md",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},{default:w(()=>[y(Y,{class:"row items-center q-pb-none"},{default:w(()=>[U("div",_t,H(r.parameters_dialog_caption),1),y(mt),Z(y(F,{icon:"sym_o_close",flat:""},null,512),[[re]])]),_:1}),y(Y,{class:"q-pa-md"},{default:w(()=>[U("div",pt,[(_(!0),L(X,null,ee(s.parameters,e=>(_(),L("div",{key:e.key},[e.ui_type=="int"?(_(),L("div",yt,[(_(),b(ve,{filled:"",modelValue:l[e.key],"onUpdate:modelValue":a=>l[e.key]=a,label:e.label,key:e.key,name:e.key,rules:[a=>a!==null&&a!==""||"Please type a number",a=>e.valid_max&&parseInt(a)<=parseInt(e.valid_max)||`Please type a number lower than ${e.valid_max}`,a=>e.valid_min&&parseInt(a)>=parseInt(e.valid_min)||`Please type a number more than ${e.valid_min}`]},{before:w(()=>[y(F,{icon:"sym_o_remove",color:"primary",flat:"",onClick:a=>l[e.key]=String(parseInt(l[e.key])-1),disable:e.valid_min&&parseInt(l[e.key])<=parseInt(e.valid_min)},null,8,["onClick","disable"])]),after:w(()=>[y(F,{icon:"sym_o_add",color:"primary",flat:"",onClick:a=>l[e.key]=String(parseInt(l[e.key])+1),disable:e.valid_max&&parseInt(l[e.key])>=parseInt(e.valid_max)},null,8,["onClick","disable"])]),_:2},1032,["modelValue","onUpdate:modelValue","label","name","rules"]))])):(_(),L("div",wt,[(_(),b(ve,{filled:"",modelValue:l[e.key],"onUpdate:modelValue":a=>l[e.key]=a,label:e.label,key:e.key,name:e.key,class:"",rules:[a=>a&&a.length>0||"Please type something",a=>e.valid_max&&a.length<=parseInt(e.valid_max)||`Please type text longest ${e.valid_max} chars.`,a=>e.valid_min&&a.length>=parseInt(e.valid_min)||`Please type text shortest ${e.valid_min} chars.`]},null,8,["modelValue","onUpdate:modelValue","label","name","rules"]))]))]))),128))])]),_:1}),y(ye,{align:"center"},{default:w(()=>[Z((_(),b(F,{stack:"","no-caps":"",color:"primary",class:"q-ma-sm",type:"submit",size:"md",padding:"md lg"},{default:w(()=>[A(ae.isEmpty)(r.parameters_dialog_action_icon)?N("",!0):(_(),b(j,{key:0,name:`sym_o_${r.parameters_dialog_action_icon}`},null,8,["name"])),U("div",null,H(r.parameters_dialog_action_label),1)]),_:1})),[[re]])]),_:1})]),_:1})]),_:1}))}});function bt(r){const d=Object.assign({noopener:!0},r),l=[];for(const s in d){const i=d[s];i===!0?l.push(s):(we(i)||typeof i=="string"&&i!=="")&&l.push(s+"="+i)}return l.join(",")}function he(r,d,l){let s=window.open;if(ue.is.cordova===!0){if(cordova?.InAppBrowser?.open!==void 0)s=cordova.InAppBrowser.open;else if(navigator?.app!==void 0)return navigator.app.loadUrl(r,{openExternal:!0})}const i=s(r,"_blank",bt(l));if(i)return ue.is.desktop&&i.focus(),i;d?.()}const Et=(r,d,l)=>{if(ue.is.ios===!0&&window.SafariViewController!==void 0){window.SafariViewController.isAvailable(s=>{s?window.SafariViewController.show({url:r},Le,d):he(r,d,l)});return}return he(r,d,l)},St=G({__name:"ShareTriggerButtons",props:{triggers:{},currentItemIsImage:{type:Boolean}},emits:["triggerAction"],setup(r,{emit:d}){const l=r;function s(n){return!l.currentItemIsImage&&n}const i=d;function u(n){console.log(`trigger share config_index ${n}`),i("triggerAction",n)}return(n,t)=>(_(!0),L(X,null,ee(r.triggers,(e,a)=>(_(),L("div",{key:a},[e.show_button&&!(A(ae.isEmpty)(e.title)&&A(ae.isEmpty)(e.icon))?(_(),b(F,{key:0,stack:"",rounded:"","no-caps":"",color:"primary",disabled:s(e.handles_images_only),class:qe(["q-mr-sm action-button action-button-share col-auto glass-effect",["share-button-"+a]]),onClick:o=>u(e.config_index)},{default:w(()=>[A(ae.isEmpty)(e.icon)?N("",!0):(_(),b(j,{key:0,name:`sym_o_${e.icon}`},null,8,["name"])),U("div",null,H(e.title),1)]),_:2},1032,["disabled","class","onClick"])):N("",!0)]))),128))}}),Pt={class:"q-mb-lg action-buttons col"},kt={class:"q-pa-md row flex flex-center"},It={class:"q-mr-sm row flex flex-center"},At={class:"q-ml-sm"},Mt=G({__name:"PageToolbar",props:{item:{},image_number:{},images_total:{},showDownload:{type:Boolean},showDelete:{type:Boolean},showFilter:{type:Boolean},showShare:{type:Boolean},shareButtons:{},enableFilter:{type:Boolean}},emits:["triggerShareAction","triggerToggleDisplayFilter","triggerDeleteMediaitem","closeEvent"],setup(r,{emit:d}){const l=z(!1),s=r,i=d;function u(e){i("triggerShareAction",e)}function n(){i("triggerToggleDisplayFilter")}function t(e){i("triggerDeleteMediaitem",e)}return(e,a)=>(_(),L(X,null,[r.item?(_(),b(_e,{key:0,position:"bottom",id:"gallery-toolbar",class:"toolbar"},{default:w(()=>[U("div",Pt,[U("div",kt,[r.showDelete?(_(),b(F,{key:0,stack:"",rounded:"",class:"q-mr-sm action-button action-button-delete col-auto glass-effect",color:"primary","no-caps":"",icon:"sym_o_delete",label:e.$t("BTN_LABEL_GALLERY_DELETE"),onClick:a[0]||(a[0]=o=>l.value=!0)},null,8,["label"])):N("",!0),r.showFilter&&r.enableFilter?(_(),b(F,{key:1,stack:"","no-caps":"",rounded:"",color:"primary",class:"q-mr-sm action-button action-button-filter col-auto glass-effect",icon:"sym_o_filter",label:e.$t("BTN_LABEL_GALLERY_FILTER"),onClick:n},null,8,["label"])):N("",!0),r.showDownload?(_(),b(F,{key:2,stack:"","no-caps":"",rounded:"",color:"primary",class:"q-mr-sm action-button action-button-download col-auto glass-effect",icon:"sym_o_download",label:e.$t("BTN_LABEL_GALLERY_DOWNLOAD"),onClick:a[1]||(a[1]=o=>A(Et)(`/sharepage/#?url=/media/full/${r.item.id}`))},null,8,["label"])):N("",!0),r.showShare?(_(),b(St,{key:3,triggers:r.shareButtons,"current-item-is-image":A(ot)(r.item.unprocessed),onTriggerAction:u},null,8,["triggers","current-item-is-image"])):N("",!0)]),U("div",It,[y(ge,{color:"grey-8",class:"q-mr-xs"},{default:w(()=>[y(j,{name:"sym_o_image",color:"white",class:"q-mr-xs"}),ne(" "+H(r.item.id),1)]),_:1}),s.image_number&&s.images_total?(_(),b(ge,{key:0,color:"grey-8",class:"q-mr-xs"},{default:w(()=>[y(j,{name:"sym_o_tag",color:"white",class:"q-mr-xs"}),ne(" "+H(e.$t("LABEL_ELEMENT_X_OF_Y",{no:s.image_number,total:s.images_total})),1)]),_:1})):N("",!0)])])]),_:1})):N("",!0),y(Ce,{modelValue:l.value,"onUpdate:modelValue":a[3]||(a[3]=o=>l.value=o)},{default:w(()=>[y(ie,{id:"gallery-confirm-delete-dialog",class:"q-pa-sm",style:{"min-width":"350px"}},{default:w(()=>[y(Y,{class:"row items-center",style:{"flex-wrap":"nowrap"}},{default:w(()=>[y(De,{icon:"sym_o_delete",color:"primary","text-color":"white"}),U("span",At,H(e.$t("MSG_CONFIRM_DELETE_IMAGE")),1)]),_:1}),y(ye,{align:"right"},{default:w(()=>[Z(y(F,{flat:"",label:e.$t("BTN_LABEL_CANCEL")},null,8,["label"]),[[re]]),Z(y(F,{label:e.$t("BTN_LABEL_DELETE_IMAGE"),color:"primary",onClick:a[2]||(a[2]=o=>[t(r.item.id),e.$emit("closeEvent")])},null,8,["label"]),[[re]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Rt=G({__name:"HeaderCountdownTimer",props:{duration:{}},emits:["triggerTimeout"],setup(r,{emit:d}){const l=r,s=z(0);let i;const u=d;function n(){clearInterval(i),s.value=0}function t(){s.value=l.duration,i=window.setInterval(()=>{s.value-=.1,s.value<=0&&(clearInterval(i),u("triggerTimeout"))},100)}return le(()=>{t()}),be(()=>{n()}),(e,a)=>s.value>=0?(_(),b(Ee,{key:0,id:"gallery-linear-progress-bar",class:"absolute",value:s.value/l.duration,"animation-speed":"200",color:"grey"},null,8,["value"])):N("",!0)}}),Tt={};function Nt(r,d){return _(),b(Ee,{class:"absolute",indeterminate:"","animation-speed":"2100",color:"primary"})}const xt=Se(Tt,[["render",Nt]]),Bt={key:0},$t={class:"text-center text-overline"},Lt={class:"absolute-bottom-right text-subtitle1 text-center",style:{padding:"4px","pointer-events":"none"}},qt={key:1,class:"text-center"},Dt=G({__name:"DrawerFilter",props:{id:{},availableFilter:{}},emits:["triggerApplyFilter"],setup(r,{emit:d}){const l=r,s=d;function i(u){s("triggerApplyFilter",l.id,u)}return(u,n)=>r.availableFilter.length>0?(_(),L("div",Bt,[U("div",$t,H(u.$t("Choose your filter")),1),(_(!0),L(X,null,ee(r.availableFilter,t=>(_(),b(ie,{key:t,bordered:"",class:"q-mb-sm no-shadow"},{default:w(()=>[y(Y,{class:"q-pa-none"},{default:w(()=>[y(it,{class:"rounded-borders",loading:"lazy",src:`/api/filter/${r.id}?filter=${t}`,onClick:e=>i(t)},{default:w(()=>[U("div",Lt,H(t),1)]),_:2},1032,["src","onClick"])]),_:2},1024)]),_:2},1024))),128))])):(_(),L("div",qt,[y(j,{name:"sym_o_mood_bad",size:"xl"}),n[0]||(n[0]=U("p",null,"No filter available.",-1))]))}});var V=function(){return V=Object.assign||function(d){for(var l,s=1,i=arguments.length;s<i;s++){l=arguments[s];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(d[u]=l[u])}return d},V.apply(this,arguments)};var K;(function(r){var d=(function(){function n(t,e,a,o){if(this.version=t,this.errorCorrectionLevel=e,this.modules=[],this.isFunction=[],t<n.MIN_VERSION||t>n.MAX_VERSION)throw new RangeError("Version value out of range");if(o<-1||o>7)throw new RangeError("Mask value out of range");this.size=t*4+17;for(var c=[],f=0;f<this.size;f++)c.push(!1);for(var f=0;f<this.size;f++)this.modules.push(c.slice()),this.isFunction.push(c.slice());this.drawFunctionPatterns();var g=this.addEccAndInterleave(a);if(this.drawCodewords(g),o==-1)for(var C=1e9,f=0;f<8;f++){this.applyMask(f),this.drawFormatBits(f);var k=this.getPenaltyScore();k<C&&(o=f,C=k),this.applyMask(f)}i(0<=o&&o<=7),this.mask=o,this.applyMask(o),this.drawFormatBits(o),this.isFunction=[]}return n.encodeText=function(t,e){var a=r.QrSegment.makeSegments(t);return n.encodeSegments(a,e)},n.encodeBinary=function(t,e){var a=r.QrSegment.makeBytes(t);return n.encodeSegments([a],e)},n.encodeSegments=function(t,e,a,o,c,f){if(a===void 0&&(a=1),o===void 0&&(o=40),c===void 0&&(c=-1),f===void 0&&(f=!0),!(n.MIN_VERSION<=a&&a<=o&&o<=n.MAX_VERSION)||c<-1||c>7)throw new RangeError("Invalid value");var g,C;for(g=a;;g++){var k=n.getNumDataCodewords(g,e)*8,E=u.getTotalBits(t,g);if(E<=k){C=E;break}if(g>=o)throw new RangeError("Data too long")}for(var S=0,x=[n.Ecc.MEDIUM,n.Ecc.QUARTILE,n.Ecc.HIGH];S<x.length;S++){var I=x[S];f&&C<=n.getNumDataCodewords(g,I)*8&&(e=I)}for(var h=[],B=0,T=t;B<T.length;B++){var $=T[B];l($.mode.modeBits,4,h),l($.numChars,$.mode.numCharCountBits(g),h);for(var D=0,q=$.getData();D<q.length;D++){var M=q[D];h.push(M)}}i(h.length==C);var v=n.getNumDataCodewords(g,e)*8;i(h.length<=v),l(0,Math.min(4,v-h.length),h),l(0,(8-h.length%8)%8,h),i(h.length%8==0);for(var p=236;h.length<v;p^=253)l(p,8,h);for(var m=[];m.length*8<h.length;)m.push(0);return h.forEach(function(Q,O){return m[O>>>3]|=Q<<7-(O&7)}),new n(g,e,m,c)},n.prototype.getModule=function(t,e){return 0<=t&&t<this.size&&0<=e&&e<this.size&&this.modules[e][t]},n.prototype.getModules=function(){return this.modules},n.prototype.drawFunctionPatterns=function(){for(var t=0;t<this.size;t++)this.setFunctionModule(6,t,t%2==0),this.setFunctionModule(t,6,t%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);for(var e=this.getAlignmentPatternPositions(),a=e.length,t=0;t<a;t++)for(var o=0;o<a;o++)t==0&&o==0||t==0&&o==a-1||t==a-1&&o==0||this.drawAlignmentPattern(e[t],e[o]);this.drawFormatBits(0),this.drawVersion()},n.prototype.drawFormatBits=function(t){for(var e=this.errorCorrectionLevel.formatBits<<3|t,a=e,o=0;o<10;o++)a=a<<1^(a>>>9)*1335;var c=(e<<10|a)^21522;i(c>>>15==0);for(var o=0;o<=5;o++)this.setFunctionModule(8,o,s(c,o));this.setFunctionModule(8,7,s(c,6)),this.setFunctionModule(8,8,s(c,7)),this.setFunctionModule(7,8,s(c,8));for(var o=9;o<15;o++)this.setFunctionModule(14-o,8,s(c,o));for(var o=0;o<8;o++)this.setFunctionModule(this.size-1-o,8,s(c,o));for(var o=8;o<15;o++)this.setFunctionModule(8,this.size-15+o,s(c,o));this.setFunctionModule(8,this.size-8,!0)},n.prototype.drawVersion=function(){if(!(this.version<7)){for(var t=this.version,e=0;e<12;e++)t=t<<1^(t>>>11)*7973;var a=this.version<<12|t;i(a>>>18==0);for(var e=0;e<18;e++){var o=s(a,e),c=this.size-11+e%3,f=Math.floor(e/3);this.setFunctionModule(c,f,o),this.setFunctionModule(f,c,o)}}},n.prototype.drawFinderPattern=function(t,e){for(var a=-4;a<=4;a++)for(var o=-4;o<=4;o++){var c=Math.max(Math.abs(o),Math.abs(a)),f=t+o,g=e+a;0<=f&&f<this.size&&0<=g&&g<this.size&&this.setFunctionModule(f,g,c!=2&&c!=4)}},n.prototype.drawAlignmentPattern=function(t,e){for(var a=-2;a<=2;a++)for(var o=-2;o<=2;o++)this.setFunctionModule(t+o,e+a,Math.max(Math.abs(o),Math.abs(a))!=1)},n.prototype.setFunctionModule=function(t,e,a){this.modules[e][t]=a,this.isFunction[e][t]=!0},n.prototype.addEccAndInterleave=function(t){var e=this.version,a=this.errorCorrectionLevel;if(t.length!=n.getNumDataCodewords(e,a))throw new RangeError("Invalid argument");for(var o=n.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][e],c=n.ECC_CODEWORDS_PER_BLOCK[a.ordinal][e],f=Math.floor(n.getNumRawDataModules(e)/8),g=o-f%o,C=Math.floor(f/o),k=[],E=n.reedSolomonComputeDivisor(c),S=0,x=0;S<o;S++){var I=t.slice(x,x+C-c+(S<g?0:1));x+=I.length;var h=n.reedSolomonComputeRemainder(I,E);S<g&&I.push(0),k.push(I.concat(h))}for(var B=[],T=function($){k.forEach(function(D,q){($!=C-c||q>=g)&&B.push(D[$])})},S=0;S<k[0].length;S++)T(S);return i(B.length==f),B},n.prototype.drawCodewords=function(t){if(t.length!=Math.floor(n.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");for(var e=0,a=this.size-1;a>=1;a-=2){a==6&&(a=5);for(var o=0;o<this.size;o++)for(var c=0;c<2;c++){var f=a-c,g=(a+1&2)==0,C=g?this.size-1-o:o;!this.isFunction[C][f]&&e<t.length*8&&(this.modules[C][f]=s(t[e>>>3],7-(e&7)),e++)}}i(e==t.length*8)},n.prototype.applyMask=function(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(var e=0;e<this.size;e++)for(var a=0;a<this.size;a++){var o=void 0;switch(t){case 0:o=(a+e)%2==0;break;case 1:o=e%2==0;break;case 2:o=a%3==0;break;case 3:o=(a+e)%3==0;break;case 4:o=(Math.floor(a/3)+Math.floor(e/2))%2==0;break;case 5:o=a*e%2+a*e%3==0;break;case 6:o=(a*e%2+a*e%3)%2==0;break;case 7:o=((a+e)%2+a*e%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[e][a]&&o&&(this.modules[e][a]=!this.modules[e][a])}},n.prototype.getPenaltyScore=function(){for(var t=0,e=0;e<this.size;e++){for(var a=!1,o=0,c=[0,0,0,0,0,0,0],f=0;f<this.size;f++)this.modules[e][f]==a?(o++,o==5?t+=n.PENALTY_N1:o>5&&t++):(this.finderPenaltyAddHistory(o,c),a||(t+=this.finderPenaltyCountPatterns(c)*n.PENALTY_N3),a=this.modules[e][f],o=1);t+=this.finderPenaltyTerminateAndCount(a,o,c)*n.PENALTY_N3}for(var f=0;f<this.size;f++){for(var a=!1,g=0,c=[0,0,0,0,0,0,0],e=0;e<this.size;e++)this.modules[e][f]==a?(g++,g==5?t+=n.PENALTY_N1:g>5&&t++):(this.finderPenaltyAddHistory(g,c),a||(t+=this.finderPenaltyCountPatterns(c)*n.PENALTY_N3),a=this.modules[e][f],g=1);t+=this.finderPenaltyTerminateAndCount(a,g,c)*n.PENALTY_N3}for(var e=0;e<this.size-1;e++)for(var f=0;f<this.size-1;f++){var C=this.modules[e][f];C==this.modules[e][f+1]&&C==this.modules[e+1][f]&&C==this.modules[e+1][f+1]&&(t+=n.PENALTY_N2)}for(var k=0,E=0,S=this.modules;E<S.length;E++){var x=S[E];k=x.reduce(function(B,T){return B+(T?1:0)},k)}var I=this.size*this.size,h=Math.ceil(Math.abs(k*20-I*10)/I)-1;return i(0<=h&&h<=9),t+=h*n.PENALTY_N4,i(0<=t&&t<=2568888),t},n.prototype.getAlignmentPatternPositions=function(){if(this.version==1)return[];for(var t=Math.floor(this.version/7)+2,e=Math.floor((this.version*8+t*3+5)/(t*4-4))*2,a=[6],o=this.size-7;a.length<t;o-=e)a.splice(1,0,o);return a},n.getNumRawDataModules=function(t){if(t<n.MIN_VERSION||t>n.MAX_VERSION)throw new RangeError("Version number out of range");var e=(16*t+128)*t+64;if(t>=2){var a=Math.floor(t/7)+2;e-=(25*a-10)*a-55,t>=7&&(e-=36)}return i(208<=e&&e<=29648),e},n.getNumDataCodewords=function(t,e){return Math.floor(n.getNumRawDataModules(t)/8)-n.ECC_CODEWORDS_PER_BLOCK[e.ordinal][t]*n.NUM_ERROR_CORRECTION_BLOCKS[e.ordinal][t]},n.reedSolomonComputeDivisor=function(t){if(t<1||t>255)throw new RangeError("Degree out of range");for(var e=[],a=0;a<t-1;a++)e.push(0);e.push(1);for(var o=1,a=0;a<t;a++){for(var c=0;c<e.length;c++)e[c]=n.reedSolomonMultiply(e[c],o),c+1<e.length&&(e[c]^=e[c+1]);o=n.reedSolomonMultiply(o,2)}return e},n.reedSolomonComputeRemainder=function(t,e){for(var a=e.map(function(C){return 0}),o=function(C){var k=C^a.shift();a.push(0),e.forEach(function(E,S){return a[S]^=n.reedSolomonMultiply(E,k)})},c=0,f=t;c<f.length;c++){var g=f[c];o(g)}return a},n.reedSolomonMultiply=function(t,e){if(t>>>8||e>>>8)throw new RangeError("Byte out of range");for(var a=0,o=7;o>=0;o--)a=a<<1^(a>>>7)*285,a^=(e>>>o&1)*t;return i(a>>>8==0),a},n.prototype.finderPenaltyCountPatterns=function(t){var e=t[1];i(e<=this.size*3);var a=e>0&&t[2]==e&&t[3]==e*3&&t[4]==e&&t[5]==e;return(a&&t[0]>=e*4&&t[6]>=e?1:0)+(a&&t[6]>=e*4&&t[0]>=e?1:0)},n.prototype.finderPenaltyTerminateAndCount=function(t,e,a){return t&&(this.finderPenaltyAddHistory(e,a),e=0),e+=this.size,this.finderPenaltyAddHistory(e,a),this.finderPenaltyCountPatterns(a)},n.prototype.finderPenaltyAddHistory=function(t,e){e[0]==0&&(t+=this.size),e.pop(),e.unshift(t)},n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],n})();r.QrCode=d;function l(n,t,e){if(t<0||t>31||n>>>t)throw new RangeError("Value out of range");for(var a=t-1;a>=0;a--)e.push(n>>>a&1)}function s(n,t){return(n>>>t&1)!=0}function i(n){if(!n)throw new Error("Assertion error")}var u=(function(){function n(t,e,a){if(this.mode=t,this.numChars=e,this.bitData=a,e<0)throw new RangeError("Invalid argument");this.bitData=a.slice()}return n.makeBytes=function(t){for(var e=[],a=0,o=t;a<o.length;a++){var c=o[a];l(c,8,e)}return new n(n.Mode.BYTE,t.length,e)},n.makeNumeric=function(t){if(!n.isNumeric(t))throw new RangeError("String contains non-numeric characters");for(var e=[],a=0;a<t.length;){var o=Math.min(t.length-a,3);l(parseInt(t.substring(a,a+o),10),o*3+1,e),a+=o}return new n(n.Mode.NUMERIC,t.length,e)},n.makeAlphanumeric=function(t){if(!n.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");var e=[],a;for(a=0;a+2<=t.length;a+=2){var o=n.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a))*45;o+=n.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a+1)),l(o,11,e)}return a<t.length&&l(n.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a)),6,e),new n(n.Mode.ALPHANUMERIC,t.length,e)},n.makeSegments=function(t){return t==""?[]:n.isNumeric(t)?[n.makeNumeric(t)]:n.isAlphanumeric(t)?[n.makeAlphanumeric(t)]:[n.makeBytes(n.toUtf8ByteArray(t))]},n.makeEci=function(t){var e=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)l(t,8,e);else if(t<16384)l(2,2,e),l(t,14,e);else if(t<1e6)l(6,3,e),l(t,21,e);else throw new RangeError("ECI assignment value out of range");return new n(n.Mode.ECI,0,e)},n.isNumeric=function(t){return n.NUMERIC_REGEX.test(t)},n.isAlphanumeric=function(t){return n.ALPHANUMERIC_REGEX.test(t)},n.prototype.getData=function(){return this.bitData.slice()},n.getTotalBits=function(t,e){for(var a=0,o=0,c=t;o<c.length;o++){var f=c[o],g=f.mode.numCharCountBits(e);if(f.numChars>=1<<g)return 1/0;a+=4+g+f.bitData.length}return a},n.toUtf8ByteArray=function(t){t=encodeURI(t);for(var e=[],a=0;a<t.length;a++)t.charAt(a)!="%"?e.push(t.charCodeAt(a)):(e.push(parseInt(t.substring(a+1,a+3),16)),a+=2);return e},n.NUMERIC_REGEX=/^[0-9]*$/,n.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,n.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",n})();r.QrSegment=u})(K||(K={}));(function(r){(function(d){var l=(function(){function s(i,u){this.ordinal=i,this.formatBits=u}return s.LOW=new s(0,1),s.MEDIUM=new s(1,0),s.QUARTILE=new s(2,3),s.HIGH=new s(3,2),s})();d.Ecc=l})(r.QrCode||(r.QrCode={}))})(K||(K={}));(function(r){(function(d){var l=(function(){function s(i,u){this.modeBits=i,this.numBitsCharCount=u}return s.prototype.numCharCountBits=function(i){return this.numBitsCharCount[Math.floor((i+7)/17)]},s.NUMERIC=new s(1,[10,12,14]),s.ALPHANUMERIC=new s(2,[9,11,13]),s.BYTE=new s(4,[8,16,16]),s.KANJI=new s(8,[8,10,12]),s.ECI=new s(7,[0,0,0]),s})();d.Mode=l})(r.QrSegment||(r.QrSegment={}))})(K||(K={}));var J=K,ke="L",Qt=100,Ie=0,Ft=.1,Ot=2,Ae={L:J.QrCode.Ecc.LOW,M:J.QrCode.Ecc.MEDIUM,Q:J.QrCode.Ecc.QUARTILE,H:J.QrCode.Ecc.HIGH},zt=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})();function Me(r){return r in Ae}function Re(r,d){d===void 0&&(d=0);var l="";return r.forEach(function(s,i){var u=null;s.forEach(function(n,t){if(!n&&u!==null){l+="M".concat(u+d," ").concat(i+d,"h").concat(t-u,"v1H").concat(u+d,"z"),u=null;return}if(t===s.length-1){if(!n)return;u===null?l+="M".concat(t+d,",").concat(i+d," h1v1H").concat(t+d,"z"):l+="M".concat(u+d,",").concat(i+d," h").concat(t+1-u,"v1H").concat(u+d,"z");return}n&&u===null&&(u=t)})}),l}function Ut(r,d,l,s){var i=s.width,u=s.height,n=s.x,t=s.y,e=r.length+l*2,a=Math.floor(d*Ft),o=e/d,c=(i||a)*o,f=(u||a)*o,g=n==null?r.length/2-c/2:n*o,C=t==null?r.length/2-f/2:t*o,k=(s.borderRadius||0)*o,E=null;if(s.excavate){var S=Math.floor(g),x=Math.floor(C),I=Math.ceil(c+g-S),h=Math.ceil(f+C-x);E={x:S,y:x,w:I,h}}return{x:g,y:C,h:f,w:c,borderRadius:k,excavation:E}}function Te(r){var d=R(function(){var t;return((t=r.margin)!==null&&t!==void 0?t:Ie)>>>0}),l=R(function(){var t=Me(r.level)?r.level:ke;return J.QrCode.encodeText(r.value,Ae[t]).getModules()}),s=R(function(){return l.value.length+d.value*2}),i=R(function(){return Re(l.value,d.value)}),u=R(function(){if(!r.imageSettings.src)return{x:0,y:0,width:0,height:0,borderRadius:0};var t=Ut(l.value,r.size,d.value,r.imageSettings);return{x:t.x+d.value,y:t.y+d.value,width:t.w,height:t.h,borderRadius:t.borderRadius}}),n=R(function(){if(!r.imageSettings.excavate||!r.imageSettings.src)return null;var t=Ot/(r.size/s.value);return{x:u.value.x-t,y:u.value.y-t,width:u.value.width+t*2,height:u.value.height+t*2,borderRadius:u.value.borderRadius}});return{margin:d,numCells:s,cells:l,fgPath:i,imageProps:u,imageBorderProps:n}}var de={value:{type:String,required:!0,default:""},size:{type:Number,default:Qt},level:{type:String,default:ke,validator:function(r){return Me(r)}},background:{type:String,default:"#fff"},foreground:{type:String,default:"#000"},margin:{type:Number,required:!1,default:Ie},imageSettings:{type:Object,required:!1,default:function(){return{}}},gradient:{type:Boolean,required:!1,default:!1},gradientType:{type:String,required:!1,default:"linear",validator:function(r){return["linear","radial"].indexOf(r)>-1}},gradientStartColor:{type:String,required:!1,default:"#000"},gradientEndColor:{type:String,required:!1,default:"#fff"}},Vt=V(V({},de),{renderAs:{type:String,required:!1,default:"canvas",validator:function(r){return["canvas","svg"].indexOf(r)>-1}}}),Gt=G({name:"QRCodeSvg",props:de,setup:function(r){var d=Te(r),l=d.numCells,s=d.fgPath,i=d.imageProps,u=d.imageBorderProps,n="qrcode.vue-gradient",t=function(){if(!r.gradient)return null;var o=r.gradientType==="linear"?{x1:"0%",y1:"0%",x2:"100%",y2:"100%"}:{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"};return P(r.gradientType==="linear"?"linearGradient":"radialGradient",V({id:n},o),[P("stop",{offset:"0%",style:{stopColor:r.gradientStartColor}}),P("stop",{offset:"100%",style:{stopColor:r.gradientEndColor}})])},e="qrcode.vue-logo-clip-path",a=function(){var o=i.value.borderRadius;return!r.imageSettings.src||o<=0?null:P("clipPath",{id:e},[P("rect",{x:i.value.x,y:i.value.y,width:i.value.width,height:i.value.height,rx:o,ry:o})])};return function(){return P("svg",{width:r.size,height:r.size,"shape-rendering":"crispEdges",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(l.value," ").concat(l.value)},[P("defs",{},[t(),a()]),P("rect",{width:"100%",height:"100%",fill:r.background}),P("path",{fill:r.gradient?"url(#".concat(n,")"):r.foreground,d:s.value}),u.value&&P("rect",{x:u.value.x,y:u.value.y,width:u.value.width,height:u.value.height,fill:r.background,rx:u.value.borderRadius,ry:u.value.borderRadius}),r.imageSettings.src&&P("image",V(V({href:r.imageSettings.src},i.value),i.value.borderRadius>0?{"clip-path":"url(#".concat(e,")")}:{}))])}}}),Ht=G({name:"QRCodeCanvas",props:de,setup:function(r,d){var l=Te(r),s=l.margin,i=l.cells,u=l.numCells,n=l.imageProps,t=l.imageBorderProps,e=z(null),a=z(null),o=function(){var f=r.size,g=r.background,C=r.foreground,k=r.gradient,E=r.gradientType,S=r.gradientStartColor,x=r.gradientEndColor,I=e.value;if(I){var h=I.getContext("2d");if(h){var B=i.value,T=a.value,$=typeof window<"u"&&window.devicePixelRatio||1,D=f/u.value*$;if(I.height=I.width=f*$,h.scale(D,D),h.fillStyle=g,h.fillRect(0,0,u.value,u.value),k){var q=void 0;E==="linear"?q=h.createLinearGradient(0,0,u.value,u.value):q=h.createRadialGradient(u.value/2,u.value/2,0,u.value/2,u.value/2,u.value/2),q.addColorStop(0,S),q.addColorStop(1,x),h.fillStyle=q}else h.fillStyle=C;zt?h.fill(new Path2D(Re(B,s.value))):B.forEach(function(Q,O){Q.forEach(function(W,te){W&&h.fillRect(te+s.value,O+s.value,1,1)})});var M=r.imageSettings.src&&T&&T.naturalWidth!==0&&T.naturalHeight!==0;if(M){var v=function(Q,O,W,te,fe,Ne){Q.beginPath(),Q.roundRect?Q.roundRect(O,W,te,fe,Ne):Q.rect(O,W,te,fe)};if(t.value){var p=t.value;h.fillStyle=r.background,v(h,p.x,p.y,p.width,p.height,p.borderRadius),h.fill()}var m=n.value.borderRadius;m>0?(h.save(),v(h,n.value.x,n.value.y,n.value.width,n.value.height,m),h.clip(),h.drawImage(T,n.value.x,n.value.y,n.value.width,n.value.height),h.restore()):h.drawImage(T,n.value.x,n.value.y,n.value.width,n.value.height)}}}};le(o),Qe(o);var c=d.attrs.style;return function(){return P(X,[P("canvas",V(V({},d.attrs),{ref:e,style:V(V({},c),{width:"".concat(r.size,"px"),height:"".concat(r.size,"px")})})),r.imageSettings.src&&P("img",{ref:a,src:r.imageSettings.src,style:{display:"none"},onLoad:o})])}}}),me=G({name:"Qrcode",render:function(){var r=this.$props,d=r.renderAs,l=r.value,s=r.size,i=r.margin,u=r.level,n=r.background,t=r.foreground,e=r.imageSettings,a=r.gradient,o=r.gradientType,c=r.gradientStartColor,f=r.gradientEndColor;return P(d==="svg"?Gt:Ht,{value:l,size:s,margin:i,level:u,background:n,foreground:t,imageSettings:e,gradient:a,gradientType:o,gradientStartColor:c,gradientEndColor:f})},props:Vt});const Wt={key:0},Yt=["href"],Kt={key:1},Xt=G({__name:"PageQrCode",props:{urls:{},textAbove:{},textBelow:{},linkQrCodes:{type:Boolean,default:()=>!1}},setup(r){const d=r;return(l,s)=>r.urls?.length>0?(_(),b(Fe,{key:0,appear:"","enter-active-class":"animated fadeIn"},{default:w(()=>[y(ie,{class:"pb-card-qrcode no-shadow",style:{width:"200px"}},{default:w(()=>[r.textAbove?(_(),b(Y,{key:0,class:"pb-qrcode-text-above q-pa-sm"},{default:w(()=>[ne(H(r.textAbove),1)]),_:1})):N("",!0),(_(!0),L(X,null,ee(d.urls,(i,u)=>(_(),b(Y,{class:"pb-qrcode-code q-pa-none q-px-sm",key:u},{default:w(()=>[r.linkQrCodes?(_(),L("div",Wt,[U("a",{href:i,target:"_blank"},[y(me,{value:i,margin:2,size:200,level:"L","render-as":"svg",style:{width:"100%"}},null,8,["value"])],8,Yt)])):(_(),L("div",Kt,[y(me,{value:i,margin:2,size:200,level:"L","render-as":"svg",style:{width:"100%"}},null,8,["value"])]))]),_:2},1024))),128)),r.textBelow?(_(),b(Y,{key:1,class:"pb-qrcode-text-below q-pa-sm"},{default:w(()=>[ne(H(r.textBelow),1)]),_:1})):N("",!0)]),_:1})]),_:1})):N("",!0)}}),Jt=Se(Xt,[["__scopeId","data-v-5f62a764"]]),Zt=ce({name:"QCarouselSlide",props:{...lt,imgSrc:String},setup(r,{slots:d}){const l=R(()=>r.imgSrc?{backgroundImage:`url("${r.imgSrc}")`}:{});return()=>P("div",{class:"q-carousel__slide",style:l.value},Oe(d.default))}}),jt=["top","right","bottom","left"],ea=["regular","flat","outline","push","unelevated"],ta=ce({name:"QCarousel",props:{...ze,...ut,...vt,transitionPrev:{type:String,default:"fade"},transitionNext:{type:String,default:"fade"},height:String,padding:Boolean,controlColor:String,controlTextColor:String,controlType:{type:String,validator:r=>ea.includes(r),default:"flat"},autoplay:[Number,Boolean],arrows:Boolean,prevIcon:String,nextIcon:String,navigation:Boolean,navigationPosition:{type:String,validator:r=>jt.includes(r)},navigationIcon:String,navigationActiveIcon:String,thumbnails:Boolean},emits:[...ft,...st],setup(r,{slots:d}){const{proxy:{$q:l}}=Ue(),s=He(r,l);let i=null,u;const{updatePanelsList:n,getPanelContent:t,panelDirectives:e,goToPanel:a,previousPanel:o,nextPanel:c,getEnabledPanels:f,panelIndex:g}=ct(),{inFullscreen:C}=gt(),k=R(()=>C.value!==!0&&r.height!==void 0?{height:r.height}:{}),E=R(()=>r.vertical===!0?"vertical":"horizontal"),S=R(()=>r.navigationPosition||(r.vertical===!0?"right":"bottom")),x=R(()=>`q-carousel q-panel-parent q-carousel--with${r.padding===!0?"":"out"}-padding`+(C.value===!0?" fullscreen":"")+(s.value===!0?" q-carousel--dark q-dark":"")+(r.arrows===!0?` q-carousel--arrows-${E.value}`:"")+(r.navigation===!0?` q-carousel--navigation-${S.value}`:"")),I=R(()=>{const M=[r.prevIcon||l.iconSet.carousel[r.vertical===!0?"up":"left"],r.nextIcon||l.iconSet.carousel[r.vertical===!0?"down":"right"]];return r.vertical===!1&&l.lang.rtl===!0?M.reverse():M}),h=R(()=>r.navigationIcon||l.iconSet.carousel.navigationIcon),B=R(()=>r.navigationActiveIcon||h.value),T=R(()=>({color:r.controlColor,textColor:r.controlTextColor,round:!0,[r.controlType]:!0,dense:!0}));oe(()=>r.modelValue,()=>{r.autoplay&&$()}),oe(()=>r.autoplay,M=>{M?$():i!==null&&(clearTimeout(i),i=null)});function $(){const M=we(r.autoplay)===!0?Math.abs(r.autoplay):5e3;i!==null&&clearTimeout(i),i=setTimeout(()=>{i=null,M>=0?c():o()},M)}le(()=>{r.autoplay&&$()}),be(()=>{i!==null&&clearTimeout(i)});function D(M,v){return P("div",{class:`q-carousel__control q-carousel__navigation no-wrap absolute flex q-carousel__navigation--${M} q-carousel__navigation--${S.value}`+(r.controlColor!==void 0?` text-${r.controlColor}`:"")},[P("div",{class:"q-carousel__navigation-inner flex flex-center no-wrap"},f().map(v))])}function q(){const M=[];if(r.navigation===!0){const v=d["navigation-icon"]!==void 0?d["navigation-icon"]:m=>P(F,{key:"nav"+m.name,class:`q-carousel__navigation-icon q-carousel__navigation-icon--${m.active===!0?"":"in"}active`,...m.btnProps,onClick:m.onClick}),p=u-1;M.push(D("buttons",(m,Q)=>{const O=m.props.name,W=g.value===Q;return v({index:Q,maxIndex:p,name:O,active:W,btnProps:{icon:W===!0?B.value:h.value,size:"sm",...T.value},onClick:()=>{a(O)}})}))}else if(r.thumbnails===!0){const v=r.controlColor!==void 0?` text-${r.controlColor}`:"";M.push(D("thumbnails",p=>{const m=p.props;return P("img",{key:"tmb#"+m.name,class:`q-carousel__thumbnail q-carousel__thumbnail--${m.name===r.modelValue?"":"in"}active`+v,src:m.imgSrc||m["img-src"],onClick:()=>{a(m.name)}})}))}return r.arrows===!0&&g.value>=0&&((r.infinite===!0||g.value>0)&&M.push(P("div",{key:"prev",class:`q-carousel__control q-carousel__arrow q-carousel__prev-arrow q-carousel__prev-arrow--${E.value} absolute flex flex-center`},[P(F,{icon:I.value[0],...T.value,onClick:o})])),(r.infinite===!0||g.value<u-1)&&M.push(P("div",{key:"next",class:`q-carousel__control q-carousel__arrow q-carousel__next-arrow q-carousel__next-arrow--${E.value} absolute flex flex-center`},[P(F,{icon:I.value[1],...T.value,onClick:c})]))),Ge(d.control,M)}return()=>(u=n(d),P("div",{class:x.value,style:k.value},[Ve("div",{class:"q-carousel__slides-container"},t(),"sl-cont",r.swipeable,()=>e.value)].concat(q())))}}),aa=G({__name:"PageCarouselView",props:{slicedImages:{},mediaitemId:{}},emits:["triggerChangedItem"],setup(r,{emit:d}){const l=r,s=We(l.mediaitemId);oe(()=>l.mediaitemId,t=>{s.value=t});const i=d;function u(){console.log("TODO: add method to close dialog programmatically")}function n(t){i("triggerChangedItem",t)}return(t,e)=>Z((_(),b(ta,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value=a),class:"",style:{width:"100%",height:"100%"},"control-type":"flat","control-color":"primary",swipeable:"",animated:"",draggable:"false",arrows:!0,infinite:!0,"transition-prev":"slide-right","transition-next":"slide-left",onTransition:n},{default:w(()=>[(_(!0),L(X,null,ee(l.slicedImages,a=>(_(),b(Zt,{key:a.id,name:a.id,class:"column no-wrap flex-center full-height q-pa-sm"},{default:w(()=>[y(Pe,{item:a},null,8,["item"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])),[[dt,u,void 0,{mouse:!0,down:!0}]])}}),ra={key:0,class:"fixed-full"},na={key:1},Ia=G({__name:"GalleryDetailPage",props:{startTimer:{type:Boolean},itemPresenterMode:{type:Boolean}},setup(r){const d=Ye(),l=Ke(),s=Xe(),i=Je(),u=Ze(),n=z(""),t=z(!1),e=z(!1),a=z(!1),o=z(!1),c=z(0),f=z([]),g=z([]),C=r;pe(()=>{n.value=l.params.id,T()}),oe(l,v=>{n.value=v.params.id}),le(()=>{e.value=C.startTimer});const k=v=>{n.value=v},E=R(()=>h(n.value));je(n,async()=>{try{const v=await se(`/api/share/download/${n.value}`);if(!v.ok)throw`Error: ${v.status} ${v.statusText}`;g.value=await v.json(),console.log(g.value)}catch(v){console.warn(v)}},{debounce:600});const S=R(()=>u.collection.findIndex(v=>v.id==n.value)+1),x=R(()=>i.configuration.uisettings.gallery_show_filter&&B(E.value.media_type)),I=R(()=>{const v=[];return i.configuration.share.actions.forEach((m,Q)=>{const O={config_index:Q,handles_images_only:m.handles_images_only,show_button:m.trigger.ui_trigger.show_button,title:m.trigger.ui_trigger.title,icon:m.trigger.ui_trigger.icon};v.push(O)}),v}),h=v=>u.collection.find(p=>p.id==v),B=v=>["image"].includes(v),T=async()=>{try{const v=await se("/api/filter/");f.value=await v.json(),console.log(f.value)}catch(v){console.warn(v)}},$=(v,p)=>{a.value=!0,fetch(`/api/filter/${v}?filter=${p}`,{method:"PATCH"}).then(m=>{if(!m.ok)throw new Error("Server returned "+m.status);a.value=!1}).catch(m=>{console.error(m),a.value=!1})},D=v=>{n.value=void 0,u.deleteItem(v),s.back()},q=v=>{console.log("doShareAction",n.value,v),i.configuration.share.actions[v].processing.ask_user_for_parameter_input?(c.value=v,o.value=!0):et(`/api/share/actions/${n.value}/${v}`,"POST")},M=async(v,p)=>{console.warn(n.value,v,p),console.log(JSON.stringify(p));try{const m=await se(`/api/share/actions/${n.value}/${v}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(console.log(m),!m.ok)throw`Error: ${m.status} ${m.statusText}`}catch(m){console.error(m),d.notify({message:m,caption:"Request Error!",color:"negative"})}};return(v,p)=>(_(),b(rt,{view:"hhh Lpr ffr",onClick:p[5]||(p[5]=m=>e.value=!1)},{default:w(()=>[E.value?(_(),L("div",ra,[y(xe,{class:"bg-primary text-white"},{default:w(()=>[e.value?(_(),b(Rt,{key:0,duration:A(i).configuration.uisettings.AUTOCLOSE_NEW_ITEM_ARRIVED,onTriggerTimeout:p[0]||(p[0]=m=>v.$router.push({path:"/"}))},null,8,["duration"])):N("",!0),a.value?(_(),b(xt,{key:1})):N("",!0)]),_:1}),x.value?(_(),b(Be,{key:0,id:"gallery-drawer-filters",modelValue:t.value,"onUpdate:modelValue":p[1]||(p[1]=m=>t.value=m),class:"q-pa-sm",side:"right",overlay:"",elevated:""},{default:w(()=>[t.value?(_(),b(Dt,{key:0,id:E.value.id,"available-filter":f.value,onTriggerApplyFilter:$},null,8,["id","available-filter"])):N("",!0)]),_:1},8,["modelValue"])):N("",!0),y(at,{class:"q-pa-none galleryimagedetail full-height"},{default:w(()=>[y(tt,{class:"full-height"},{default:w(()=>[r.itemPresenterMode?(_(),b(Pe,{key:0,item:E.value,style:{"user-select":"none"}},null,8,["item"])):(_(),b(aa,{key:1,"mediaitem-id":E.value.id,"sliced-images":A(u).collection,onTriggerChangedItem:k,onClick:p[2]||(p[2]=m=>t.value=!1)},null,8,["mediaitem-id","sliced-images"])),A(i).configuration.uisettings.gallery_show_qrcode?(_(),b(_e,{key:2,position:"top-right",class:"q-ma-lg"},{default:w(()=>[y(Jt,{urls:g.value,"text-above":A(i).configuration.uisettings.qrcode_text_above,"text-below":A(i).configuration.uisettings.qrcode_text_below,linkQrCodes:A(i).configuration.uisettings.qrcode_link_codes},null,8,["urls","text-above","text-below","linkQrCodes"])]),_:1})):N("",!0),y(Mt,{item:E.value,"show-filter":A(i).configuration.uisettings.gallery_show_filter,"enable-filter":B(E.value.media_type),"show-share":A(i).configuration.uisettings.gallery_show_shareprint&&A(i).configuration.share.sharing_enabled,"share-buttons":I.value,"show-delete":C.itemPresenterMode||A(i).configuration.uisettings.gallery_show_delete,"show-download":A(i).configuration.uisettings.gallery_show_download,image_number:S.value,images_total:A(u).collection_number_of_items,onTriggerToggleDisplayFilter:p[3]||(p[3]=m=>t.value=!t.value),onTriggerDeleteMediaitem:D,onTriggerShareAction:q},null,8,["item","show-filter","enable-filter","show-share","share-buttons","show-delete","show-download","image_number","images_total"]),y(Ce,{modelValue:o.value,"onUpdate:modelValue":p[4]||(p[4]=m=>o.value=m)},{default:w(()=>[y(Ct,{parameters:A(i).configuration.share.actions[c.value].processing.parameters,parameters_dialog_caption:A(i).configuration.share.actions[c.value].processing.parameters_dialog_caption,parameters_dialog_action_icon:A(i).configuration.share.actions[c.value].processing.parameters_dialog_action_icon,parameters_dialog_action_label:A(i).configuration.share.actions[c.value].processing.parameters_dialog_action_label,config_index:c.value,onTriggerShareActionWithParameters:M},null,8,["parameters","parameters_dialog_caption","parameters_dialog_action_icon","parameters_dialog_action_label","config_index"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):(_(),L("div",na,[y(ht)]))]),_:1}))}});export{Ia as default};
