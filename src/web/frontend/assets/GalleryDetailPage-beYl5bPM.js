import{Q as Re}from"./QHeader-BiVg5O7a.js";import{Q as Ne}from"./QDrawer-mRA9dyWj.js";import{Q as we}from"./QPageSticky-B40umIox.js";import{x as ue,A,d as z,$ as $e,P as ye,n as E,Z as oe,p as y,q as w,a0 as W,E as O,C as J,G as V,Q as F,b as x,H as K,I as j,a1 as Ce,s as $,v as I,J as te,M as Z,f as g,a2 as ae,a3 as se,a4 as Be,a5 as be,L as qe,B as D,F as re,a6 as Ee,a7 as De,l as ie,o as ke,a8 as Pe,W as Le,c as Q,Y as Qe,a9 as Fe,aa as Oe,ab as ze,w as ne,X as Ue,ac as Ve,ad as He,h as Ge,i as We,j as Ye,R as Ke,ae as le,k as Xe,r as Je,e as Ze}from"./index-Di72g7My.js";import{Q as je}from"./QPage-BwEcznG9.js";import{Q as et,a as tt}from"./QLayout-BmMpe_6F.js";import{Q as ge}from"./QInput-DF28SrMB.js";import{Q as at}from"./QForm-DpvCMlDq.js";import{Q as me}from"./QBadge-DTbqUKsZ.js";import{b as rt}from"./media_is_type-DZvwXqkq.js";import{Q as Ie}from"./QLinearProgress-s6XV6NiU.js";import{_ as Se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as nt}from"./QImg-CV0rvFI2.js";import{u as ot,a as it,b as lt,c as st,T as ut}from"./use-panel-CYzHEb6h.js";import{u as ct,a as dt,b as ft}from"./use-fullscreen-jFwwNdqQ.js";import{_ as Me}from"./MediaItemPreviewViewer.vue_vue_type_script_setup_true_lang-Bfa6qKBU.js";import{I as ht}from"./ItemNotAvailableError-BuIeE7Tm.js";import"./QResizeObserver-iMUbsq2V.js";import"./format-CJebrXOQ.js";import"./use-id-Fao3qqgM.js";import"./private.use-form-CqMjFBFr.js";import"./selection-CMocyovK.js";const gt=ue({name:"QSpace",setup(){const r=A("div",{class:"q-space"});return()=>r}}),mt={class:"text-h6"},vt={class:"q-gutter-md"},_t={key:0},pt={key:1},wt=z({__name:"PageShareParameters",props:{config_index:{},parameters_dialog_caption:{},parameters_dialog_action_icon:{},parameters_dialog_action_label:{},parameters:{}},emits:["triggerShareActionWithParameters"],setup(r,{emit:d}){const s=$e({}),l=r,i=d;ye(()=>{l.parameters.forEach(n=>s[n.key]=n.default)});const f=()=>{i("triggerShareActionWithParameters",l.config_index,s)};return(n,t)=>(g(),E(oe,{style:{width:"400px"},class:""},{default:y(()=>[w(at,{autofocus:"",onSubmit:f,class:"q-gutter-md",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},{default:y(()=>[w(W,{class:"row items-center q-pb-none"},{default:y(()=>[O("div",mt,V(r.parameters_dialog_caption),1),w(gt),J(w(F,{icon:"sym_o_close",flat:""},null,512),[[ae]])]),_:1}),w(W,{class:"q-pa-md"},{default:y(()=>[O("div",vt,[(g(!0),x(K,null,j(l.parameters,e=>(g(),x("div",{key:e.key},[e.ui_type=="int"?(g(),x("div",_t,[(g(),E(ge,{filled:"",modelValue:s[e.key],"onUpdate:modelValue":a=>s[e.key]=a,label:e.label,key:e.key,name:e.key,rules:[a=>a!==null&&a!==""||"Please type a number",a=>e.valid_max&&parseInt(a)<=parseInt(e.valid_max)||`Please type a number lower than ${e.valid_max}`,a=>e.valid_min&&parseInt(a)>=parseInt(e.valid_min)||`Please type a number more than ${e.valid_min}`]},{before:y(()=>[w(F,{icon:"sym_o_remove",color:"primary",flat:"",onClick:a=>s[e.key]=String(parseInt(s[e.key])-1),disable:e.valid_min&&parseInt(s[e.key])<=parseInt(e.valid_min)},null,8,["onClick","disable"])]),after:y(()=>[w(F,{icon:"sym_o_add",color:"primary",flat:"",onClick:a=>s[e.key]=String(parseInt(s[e.key])+1),disable:e.valid_max&&parseInt(s[e.key])>=parseInt(e.valid_max)},null,8,["onClick","disable"])]),_:2},1032,["modelValue","onUpdate:modelValue","label","name","rules"]))])):(g(),x("div",pt,[(g(),E(ge,{filled:"",modelValue:s[e.key],"onUpdate:modelValue":a=>s[e.key]=a,label:e.label,key:e.key,name:e.key,class:"",rules:[a=>a&&a.length>0||"Please type something",a=>e.valid_max&&a.length<=parseInt(e.valid_max)||`Please type text longest ${e.valid_max} chars.`,a=>e.valid_min&&a.length>=parseInt(e.valid_min)||`Please type text shortest ${e.valid_min} chars.`]},null,8,["modelValue","onUpdate:modelValue","label","name","rules"]))]))]))),128))])]),_:1}),w(Ce,{align:"center"},{default:y(()=>[J((g(),E(F,{stack:"","no-caps":"",color:"primary",class:"q-ma-sm",type:"submit",size:"md",padding:"md lg"},{default:y(()=>[I(te.isEmpty)(r.parameters_dialog_action_icon)?$("",!0):(g(),E(Z,{key:0,name:`sym_o_${r.parameters_dialog_action_icon}`},null,8,["name"])),O("div",null,V(r.parameters_dialog_action_label),1)]),_:1})),[[ae]])]),_:1})]),_:1})]),_:1}))}});function yt(r){const d=Object.assign({noopener:!0},r),s=[];for(const l in d){const i=d[l];i===!0?s.push(l):(be(i)||typeof i=="string"&&i!=="")&&s.push(l+"="+i)}return s.join(",")}function ve(r,d,s){let l=window.open;if(se.is.cordova===!0){if(cordova?.InAppBrowser?.open!==void 0)l=cordova.InAppBrowser.open;else if(navigator?.app!==void 0)return navigator.app.loadUrl(r,{openExternal:!0})}const i=l(r,"_blank",yt(s));if(i)return se.is.desktop&&i.focus(),i;d?.()}const _e=(r,d,s)=>{if(se.is.ios===!0&&window.SafariViewController!==void 0){window.SafariViewController.isAvailable(l=>{l?window.SafariViewController.show({url:r},Be,d):ve(r,d,s)});return}return ve(r,d,s)},Ct=["src","alt","onClick"],bt=z({__name:"ShareTriggerButtons",props:{triggers:{},currentItemIsImage:{type:Boolean}},emits:["triggerAction"],setup(r,{emit:d}){const s=r;console.log("Triggers:",s.triggers);function l(n){return!s.currentItemIsImage&&n}const i=d;function f(n){console.log(`trigger share config_index ${n}`),i("triggerAction",n)}return(n,t)=>(g(!0),x(K,null,j(r.triggers,(e,a)=>(g(),x("div",{key:a},[e.show_button&&e.image_path!=null&&e.image_path!==""?(g(),x("img",{key:0,src:e.image_path,alt:e.title||"Share button",class:"action-button-image",onClick:o=>f(e.config_index),style:{cursor:"pointer","max-width":"150px","max-height":"150px"}},null,8,Ct)):e.show_button&&(e.image_path==null||e.image_path==="")&&!(I(te.isEmpty)(e.title)&&I(te.isEmpty)(e.icon))?(g(),E(F,{key:1,stack:"",rounded:"","no-caps":"",color:"primary",disabled:l(e.handles_images_only),class:qe(["q-mr-sm action-button action-button-share col-auto glass-effect",["share-button-"+a]]),onClick:o=>f(e.config_index)},{default:y(()=>[I(te.isEmpty)(e.icon)?$("",!0):(g(),E(Z,{key:0,name:`sym_o_${e.icon}`},null,8,["name"])),O("div",null,V(e.title),1)]),_:2},1032,["disabled","class","onClick"])):$("",!0)]))),128))}}),Et={class:"q-mb-lg action-buttons col"},kt={class:"q-pa-md row flex flex-center"},Pt=["src"],It=["src"],St=["src"],Mt={class:"q-mr-sm row flex flex-center"},At={class:"q-ml-sm"},Tt=z({__name:"PageToolbar",props:{item:{},image_number:{},images_total:{},showDownload:{type:Boolean},showDelete:{type:Boolean},showFilter:{type:Boolean},showShare:{type:Boolean},shareButtons:{},enableFilter:{type:Boolean},downloadImagePath:{},deleteImagePath:{},filterImagePath:{}},emits:["triggerShareAction","triggerToggleDisplayFilter","triggerDeleteMediaitem","closeEvent"],setup(r,{emit:d}){const s=D(!1),l=r,i=d;function f(e){i("triggerShareAction",e)}function n(){i("triggerToggleDisplayFilter")}function t(e){i("triggerDeleteMediaitem",e)}return(e,a)=>(g(),x(K,null,[r.item?(g(),E(we,{key:0,position:"bottom",id:"gallery-toolbar",class:"toolbar"},{default:y(()=>[O("div",Et,[O("div",kt,[r.showDelete&&r.deleteImagePath?(g(),x("img",{key:0,src:r.deleteImagePath,alt:"Delete",class:"action-button-image q-mr-sm",onClick:a[0]||(a[0]=o=>s.value=!0),style:{cursor:"pointer","max-width":"150px","max-height":"150px"}},null,8,Pt)):r.showDelete?(g(),E(F,{key:1,stack:"",rounded:"",class:"q-mr-sm action-button action-button-delete col-auto glass-effect",color:"primary","no-caps":"",icon:"sym_o_delete",label:e.$t("BTN_LABEL_GALLERY_DELETE"),onClick:a[1]||(a[1]=o=>s.value=!0)},null,8,["label"])):$("",!0),r.showFilter&&r.enableFilter&&r.filterImagePath?(g(),x("img",{key:2,src:r.filterImagePath,alt:"Filter",class:"action-button-image q-mr-sm",onClick:n,style:{cursor:"pointer","max-width":"150px","max-height":"150px"}},null,8,It)):r.showFilter&&r.enableFilter?(g(),E(F,{key:3,stack:"","no-caps":"",rounded:"",color:"primary",class:"q-mr-sm action-button action-button-filter col-auto glass-effect",icon:"sym_o_filter",label:e.$t("BTN_LABEL_GALLERY_FILTER"),onClick:n},null,8,["label"])):$("",!0),r.showDownload&&r.downloadImagePath?(g(),x("img",{key:4,src:r.downloadImagePath,alt:"Download",class:"action-button-image q-mr-sm",onClick:a[2]||(a[2]=o=>I(_e)(`/download/#?url=/media/full/${r.item.id}`)),style:{cursor:"pointer","max-width":"150px","max-height":"150px"}},null,8,St)):r.showDownload?(g(),E(F,{key:5,stack:"","no-caps":"",rounded:"",color:"primary",class:"q-mr-sm action-button action-button-download col-auto glass-effect",icon:"sym_o_download",label:e.$t("BTN_LABEL_GALLERY_DOWNLOAD"),onClick:a[3]||(a[3]=o=>I(_e)(`/download/#?url=/media/full/${r.item.id}`))},null,8,["label"])):$("",!0),r.showShare?(g(),E(bt,{key:6,triggers:r.shareButtons,"current-item-is-image":I(rt)(r.item.unprocessed),onTriggerAction:f},null,8,["triggers","current-item-is-image"])):$("",!0)]),O("div",Mt,[w(me,{color:"grey-8",class:"q-mr-xs"},{default:y(()=>[w(Z,{name:"sym_o_image",color:"white",class:"q-mr-xs"}),re(" "+V(r.item.id),1)]),_:1}),l.image_number&&l.images_total?(g(),E(me,{key:0,color:"grey-8",class:"q-mr-xs"},{default:y(()=>[w(Z,{name:"sym_o_tag",color:"white",class:"q-mr-xs"}),re(" "+V(e.$t("LABEL_ELEMENT_X_OF_Y",{no:l.image_number,total:l.images_total})),1)]),_:1})):$("",!0)])])]),_:1})):$("",!0),w(Ee,{modelValue:s.value,"onUpdate:modelValue":a[5]||(a[5]=o=>s.value=o)},{default:y(()=>[w(oe,{id:"gallery-confirm-delete-dialog",class:"q-pa-sm",style:{"min-width":"350px"}},{default:y(()=>[w(W,{class:"row items-center",style:{"flex-wrap":"nowrap"}},{default:y(()=>[w(De,{icon:"sym_o_delete",color:"primary","text-color":"white"}),O("span",At,V(e.$t("MSG_CONFIRM_DELETE_IMAGE")),1)]),_:1}),w(Ce,{align:"right"},{default:y(()=>[J(w(F,{flat:"",label:e.$t("BTN_LABEL_CANCEL")},null,8,["label"]),[[ae]]),J(w(F,{label:e.$t("BTN_LABEL_DELETE_IMAGE"),color:"primary",onClick:a[4]||(a[4]=o=>[t(r.item.id),e.$emit("closeEvent")])},null,8,["label"]),[[ae]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),xt=z({__name:"HeaderCountdownTimer",props:{duration:{}},emits:["triggerTimeout"],setup(r,{emit:d}){const s=r,l=D(0);let i;const f=d;function n(){clearInterval(i),l.value=0}function t(){l.value=s.duration,i=window.setInterval(()=>{l.value-=.1,l.value<=0&&(clearInterval(i),f("triggerTimeout"))},100)}return ie(()=>{t()}),ke(()=>{n()}),(e,a)=>l.value>=0?(g(),E(Ie,{key:0,id:"gallery-linear-progress-bar",class:"absolute",value:l.value/s.duration,"animation-speed":"200",color:"grey"},null,8,["value"])):$("",!0)}}),Rt={};function Nt(r,d){return g(),E(Ie,{class:"absolute",indeterminate:"","animation-speed":"2100",color:"primary"})}const $t=Se(Rt,[["render",Nt]]),Bt={key:0},qt={class:"text-center text-overline"},Dt={class:"absolute-bottom-right text-subtitle1 text-center",style:{padding:"4px","pointer-events":"none"}},Lt={key:1,class:"text-center"},Qt=z({__name:"DrawerFilter",props:{id:{},availableFilter:{}},emits:["triggerApplyFilter"],setup(r,{emit:d}){const s=r,l=d;function i(f){l("triggerApplyFilter",s.id,f)}return(f,n)=>r.availableFilter.length>0?(g(),x("div",Bt,[O("div",qt,V(f.$t("Choose your filter")),1),(g(!0),x(K,null,j(r.availableFilter,t=>(g(),E(oe,{key:t,bordered:"",class:"q-mb-sm no-shadow"},{default:y(()=>[w(W,{class:"q-pa-none"},{default:y(()=>[w(nt,{class:"rounded-borders",loading:"lazy",src:`/api/filter/${r.id}?filter=${t}`,onClick:e=>i(t)},{default:y(()=>[O("div",Dt,V(t),1)]),_:2},1032,["src","onClick"])]),_:2},1024)]),_:2},1024))),128))])):(g(),x("div",Lt,[w(Z,{name:"sym_o_mood_bad",size:"xl"}),n[0]||(n[0]=O("p",null,"No filter available.",-1))]))}});var U=function(){return U=Object.assign||function(d){for(var s,l=1,i=arguments.length;l<i;l++){s=arguments[l];for(var f in s)Object.prototype.hasOwnProperty.call(s,f)&&(d[f]=s[f])}return d},U.apply(this,arguments)};var Y;(function(r){var d=(function(){function n(t,e,a,o){if(this.version=t,this.errorCorrectionLevel=e,this.modules=[],this.isFunction=[],t<n.MIN_VERSION||t>n.MAX_VERSION)throw new RangeError("Version value out of range");if(o<-1||o>7)throw new RangeError("Mask value out of range");this.size=t*4+17;for(var u=[],c=0;c<this.size;c++)u.push(!1);for(var c=0;c<this.size;c++)this.modules.push(u.slice()),this.isFunction.push(u.slice());this.drawFunctionPatterns();var m=this.addEccAndInterleave(a);if(this.drawCodewords(m),o==-1)for(var b=1e9,c=0;c<8;c++){this.applyMask(c),this.drawFormatBits(c);var M=this.getPenaltyScore();M<b&&(o=c,b=M),this.applyMask(c)}i(0<=o&&o<=7),this.mask=o,this.applyMask(o),this.drawFormatBits(o),this.isFunction=[]}return n.encodeText=function(t,e){var a=r.QrSegment.makeSegments(t);return n.encodeSegments(a,e)},n.encodeBinary=function(t,e){var a=r.QrSegment.makeBytes(t);return n.encodeSegments([a],e)},n.encodeSegments=function(t,e,a,o,u,c){if(a===void 0&&(a=1),o===void 0&&(o=40),u===void 0&&(u=-1),c===void 0&&(c=!0),!(n.MIN_VERSION<=a&&a<=o&&o<=n.MAX_VERSION)||u<-1||u>7)throw new RangeError("Invalid value");var m,b;for(m=a;;m++){var M=n.getNumDataCodewords(m,e)*8,p=f.getTotalBits(t,m);if(p<=M){b=p;break}if(m>=o)throw new RangeError("Data too long")}for(var P=0,R=[n.Ecc.MEDIUM,n.Ecc.QUARTILE,n.Ecc.HIGH];P<R.length;P++){var k=R[P];c&&b<=n.getNumDataCodewords(m,k)*8&&(e=k)}for(var C=[],S=0,B=t;S<B.length;S++){var N=B[S];s(N.mode.modeBits,4,C),s(N.numChars,N.mode.numCharCountBits(m),C);for(var L=0,q=N.getData();L<q.length;L++){var T=q[L];C.push(T)}}i(C.length==b);var h=n.getNumDataCodewords(m,e)*8;i(C.length<=h),s(0,Math.min(4,h-C.length),C),s(0,(8-C.length%8)%8,C),i(C.length%8==0);for(var _=236;C.length<h;_^=253)s(_,8,C);for(var v=[];v.length*8<C.length;)v.push(0);return C.forEach(function(G,H){return v[H>>>3]|=G<<7-(H&7)}),new n(m,e,v,u)},n.prototype.getModule=function(t,e){return 0<=t&&t<this.size&&0<=e&&e<this.size&&this.modules[e][t]},n.prototype.getModules=function(){return this.modules},n.prototype.drawFunctionPatterns=function(){for(var t=0;t<this.size;t++)this.setFunctionModule(6,t,t%2==0),this.setFunctionModule(t,6,t%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);for(var e=this.getAlignmentPatternPositions(),a=e.length,t=0;t<a;t++)for(var o=0;o<a;o++)t==0&&o==0||t==0&&o==a-1||t==a-1&&o==0||this.drawAlignmentPattern(e[t],e[o]);this.drawFormatBits(0),this.drawVersion()},n.prototype.drawFormatBits=function(t){for(var e=this.errorCorrectionLevel.formatBits<<3|t,a=e,o=0;o<10;o++)a=a<<1^(a>>>9)*1335;var u=(e<<10|a)^21522;i(u>>>15==0);for(var o=0;o<=5;o++)this.setFunctionModule(8,o,l(u,o));this.setFunctionModule(8,7,l(u,6)),this.setFunctionModule(8,8,l(u,7)),this.setFunctionModule(7,8,l(u,8));for(var o=9;o<15;o++)this.setFunctionModule(14-o,8,l(u,o));for(var o=0;o<8;o++)this.setFunctionModule(this.size-1-o,8,l(u,o));for(var o=8;o<15;o++)this.setFunctionModule(8,this.size-15+o,l(u,o));this.setFunctionModule(8,this.size-8,!0)},n.prototype.drawVersion=function(){if(!(this.version<7)){for(var t=this.version,e=0;e<12;e++)t=t<<1^(t>>>11)*7973;var a=this.version<<12|t;i(a>>>18==0);for(var e=0;e<18;e++){var o=l(a,e),u=this.size-11+e%3,c=Math.floor(e/3);this.setFunctionModule(u,c,o),this.setFunctionModule(c,u,o)}}},n.prototype.drawFinderPattern=function(t,e){for(var a=-4;a<=4;a++)for(var o=-4;o<=4;o++){var u=Math.max(Math.abs(o),Math.abs(a)),c=t+o,m=e+a;0<=c&&c<this.size&&0<=m&&m<this.size&&this.setFunctionModule(c,m,u!=2&&u!=4)}},n.prototype.drawAlignmentPattern=function(t,e){for(var a=-2;a<=2;a++)for(var o=-2;o<=2;o++)this.setFunctionModule(t+o,e+a,Math.max(Math.abs(o),Math.abs(a))!=1)},n.prototype.setFunctionModule=function(t,e,a){this.modules[e][t]=a,this.isFunction[e][t]=!0},n.prototype.addEccAndInterleave=function(t){var e=this.version,a=this.errorCorrectionLevel;if(t.length!=n.getNumDataCodewords(e,a))throw new RangeError("Invalid argument");for(var o=n.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][e],u=n.ECC_CODEWORDS_PER_BLOCK[a.ordinal][e],c=Math.floor(n.getNumRawDataModules(e)/8),m=o-c%o,b=Math.floor(c/o),M=[],p=n.reedSolomonComputeDivisor(u),P=0,R=0;P<o;P++){var k=t.slice(R,R+b-u+(P<m?0:1));R+=k.length;var C=n.reedSolomonComputeRemainder(k,p);P<m&&k.push(0),M.push(k.concat(C))}for(var S=[],B=function(N){M.forEach(function(L,q){(N!=b-u||q>=m)&&S.push(L[N])})},P=0;P<M[0].length;P++)B(P);return i(S.length==c),S},n.prototype.drawCodewords=function(t){if(t.length!=Math.floor(n.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");for(var e=0,a=this.size-1;a>=1;a-=2){a==6&&(a=5);for(var o=0;o<this.size;o++)for(var u=0;u<2;u++){var c=a-u,m=(a+1&2)==0,b=m?this.size-1-o:o;!this.isFunction[b][c]&&e<t.length*8&&(this.modules[b][c]=l(t[e>>>3],7-(e&7)),e++)}}i(e==t.length*8)},n.prototype.applyMask=function(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(var e=0;e<this.size;e++)for(var a=0;a<this.size;a++){var o=void 0;switch(t){case 0:o=(a+e)%2==0;break;case 1:o=e%2==0;break;case 2:o=a%3==0;break;case 3:o=(a+e)%3==0;break;case 4:o=(Math.floor(a/3)+Math.floor(e/2))%2==0;break;case 5:o=a*e%2+a*e%3==0;break;case 6:o=(a*e%2+a*e%3)%2==0;break;case 7:o=((a+e)%2+a*e%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[e][a]&&o&&(this.modules[e][a]=!this.modules[e][a])}},n.prototype.getPenaltyScore=function(){for(var t=0,e=0;e<this.size;e++){for(var a=!1,o=0,u=[0,0,0,0,0,0,0],c=0;c<this.size;c++)this.modules[e][c]==a?(o++,o==5?t+=n.PENALTY_N1:o>5&&t++):(this.finderPenaltyAddHistory(o,u),a||(t+=this.finderPenaltyCountPatterns(u)*n.PENALTY_N3),a=this.modules[e][c],o=1);t+=this.finderPenaltyTerminateAndCount(a,o,u)*n.PENALTY_N3}for(var c=0;c<this.size;c++){for(var a=!1,m=0,u=[0,0,0,0,0,0,0],e=0;e<this.size;e++)this.modules[e][c]==a?(m++,m==5?t+=n.PENALTY_N1:m>5&&t++):(this.finderPenaltyAddHistory(m,u),a||(t+=this.finderPenaltyCountPatterns(u)*n.PENALTY_N3),a=this.modules[e][c],m=1);t+=this.finderPenaltyTerminateAndCount(a,m,u)*n.PENALTY_N3}for(var e=0;e<this.size-1;e++)for(var c=0;c<this.size-1;c++){var b=this.modules[e][c];b==this.modules[e][c+1]&&b==this.modules[e+1][c]&&b==this.modules[e+1][c+1]&&(t+=n.PENALTY_N2)}for(var M=0,p=0,P=this.modules;p<P.length;p++){var R=P[p];M=R.reduce(function(S,B){return S+(B?1:0)},M)}var k=this.size*this.size,C=Math.ceil(Math.abs(M*20-k*10)/k)-1;return i(0<=C&&C<=9),t+=C*n.PENALTY_N4,i(0<=t&&t<=2568888),t},n.prototype.getAlignmentPatternPositions=function(){if(this.version==1)return[];for(var t=Math.floor(this.version/7)+2,e=Math.floor((this.version*8+t*3+5)/(t*4-4))*2,a=[6],o=this.size-7;a.length<t;o-=e)a.splice(1,0,o);return a},n.getNumRawDataModules=function(t){if(t<n.MIN_VERSION||t>n.MAX_VERSION)throw new RangeError("Version number out of range");var e=(16*t+128)*t+64;if(t>=2){var a=Math.floor(t/7)+2;e-=(25*a-10)*a-55,t>=7&&(e-=36)}return i(208<=e&&e<=29648),e},n.getNumDataCodewords=function(t,e){return Math.floor(n.getNumRawDataModules(t)/8)-n.ECC_CODEWORDS_PER_BLOCK[e.ordinal][t]*n.NUM_ERROR_CORRECTION_BLOCKS[e.ordinal][t]},n.reedSolomonComputeDivisor=function(t){if(t<1||t>255)throw new RangeError("Degree out of range");for(var e=[],a=0;a<t-1;a++)e.push(0);e.push(1);for(var o=1,a=0;a<t;a++){for(var u=0;u<e.length;u++)e[u]=n.reedSolomonMultiply(e[u],o),u+1<e.length&&(e[u]^=e[u+1]);o=n.reedSolomonMultiply(o,2)}return e},n.reedSolomonComputeRemainder=function(t,e){for(var a=e.map(function(b){return 0}),o=function(b){var M=b^a.shift();a.push(0),e.forEach(function(p,P){return a[P]^=n.reedSolomonMultiply(p,M)})},u=0,c=t;u<c.length;u++){var m=c[u];o(m)}return a},n.reedSolomonMultiply=function(t,e){if(t>>>8||e>>>8)throw new RangeError("Byte out of range");for(var a=0,o=7;o>=0;o--)a=a<<1^(a>>>7)*285,a^=(e>>>o&1)*t;return i(a>>>8==0),a},n.prototype.finderPenaltyCountPatterns=function(t){var e=t[1];i(e<=this.size*3);var a=e>0&&t[2]==e&&t[3]==e*3&&t[4]==e&&t[5]==e;return(a&&t[0]>=e*4&&t[6]>=e?1:0)+(a&&t[6]>=e*4&&t[0]>=e?1:0)},n.prototype.finderPenaltyTerminateAndCount=function(t,e,a){return t&&(this.finderPenaltyAddHistory(e,a),e=0),e+=this.size,this.finderPenaltyAddHistory(e,a),this.finderPenaltyCountPatterns(a)},n.prototype.finderPenaltyAddHistory=function(t,e){e[0]==0&&(t+=this.size),e.pop(),e.unshift(t)},n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],n})();r.QrCode=d;function s(n,t,e){if(t<0||t>31||n>>>t)throw new RangeError("Value out of range");for(var a=t-1;a>=0;a--)e.push(n>>>a&1)}function l(n,t){return(n>>>t&1)!=0}function i(n){if(!n)throw new Error("Assertion error")}var f=(function(){function n(t,e,a){if(this.mode=t,this.numChars=e,this.bitData=a,e<0)throw new RangeError("Invalid argument");this.bitData=a.slice()}return n.makeBytes=function(t){for(var e=[],a=0,o=t;a<o.length;a++){var u=o[a];s(u,8,e)}return new n(n.Mode.BYTE,t.length,e)},n.makeNumeric=function(t){if(!n.isNumeric(t))throw new RangeError("String contains non-numeric characters");for(var e=[],a=0;a<t.length;){var o=Math.min(t.length-a,3);s(parseInt(t.substring(a,a+o),10),o*3+1,e),a+=o}return new n(n.Mode.NUMERIC,t.length,e)},n.makeAlphanumeric=function(t){if(!n.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");var e=[],a;for(a=0;a+2<=t.length;a+=2){var o=n.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a))*45;o+=n.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a+1)),s(o,11,e)}return a<t.length&&s(n.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a)),6,e),new n(n.Mode.ALPHANUMERIC,t.length,e)},n.makeSegments=function(t){return t==""?[]:n.isNumeric(t)?[n.makeNumeric(t)]:n.isAlphanumeric(t)?[n.makeAlphanumeric(t)]:[n.makeBytes(n.toUtf8ByteArray(t))]},n.makeEci=function(t){var e=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)s(t,8,e);else if(t<16384)s(2,2,e),s(t,14,e);else if(t<1e6)s(6,3,e),s(t,21,e);else throw new RangeError("ECI assignment value out of range");return new n(n.Mode.ECI,0,e)},n.isNumeric=function(t){return n.NUMERIC_REGEX.test(t)},n.isAlphanumeric=function(t){return n.ALPHANUMERIC_REGEX.test(t)},n.prototype.getData=function(){return this.bitData.slice()},n.getTotalBits=function(t,e){for(var a=0,o=0,u=t;o<u.length;o++){var c=u[o],m=c.mode.numCharCountBits(e);if(c.numChars>=1<<m)return 1/0;a+=4+m+c.bitData.length}return a},n.toUtf8ByteArray=function(t){t=encodeURI(t);for(var e=[],a=0;a<t.length;a++)t.charAt(a)!="%"?e.push(t.charCodeAt(a)):(e.push(parseInt(t.substring(a+1,a+3),16)),a+=2);return e},n.NUMERIC_REGEX=/^[0-9]*$/,n.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,n.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",n})();r.QrSegment=f})(Y||(Y={}));(function(r){(function(d){var s=(function(){function l(i,f){this.ordinal=i,this.formatBits=f}return l.LOW=new l(0,1),l.MEDIUM=new l(1,0),l.QUARTILE=new l(2,3),l.HIGH=new l(3,2),l})();d.Ecc=s})(r.QrCode||(r.QrCode={}))})(Y||(Y={}));(function(r){(function(d){var s=(function(){function l(i,f){this.modeBits=i,this.numBitsCharCount=f}return l.prototype.numCharCountBits=function(i){return this.numBitsCharCount[Math.floor((i+7)/17)]},l.NUMERIC=new l(1,[10,12,14]),l.ALPHANUMERIC=new l(2,[9,11,13]),l.BYTE=new l(4,[8,16,16]),l.KANJI=new l(8,[8,10,12]),l.ECI=new l(7,[0,0,0]),l})();d.Mode=s})(r.QrSegment||(r.QrSegment={}))})(Y||(Y={}));var X=Y,ce="L",de={L:X.QrCode.Ecc.LOW,M:X.QrCode.Ecc.MEDIUM,Q:X.QrCode.Ecc.QUARTILE,H:X.QrCode.Ecc.HIGH},Ft=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})();function fe(r){return r in de}function Ae(r,d){d===void 0&&(d=0);var s=[];return r.forEach(function(l,i){var f=null;l.forEach(function(n,t){if(!n&&f!==null){s.push("M".concat(f+d," ").concat(i+d,"h").concat(t-f,"v1H").concat(f+d,"z")),f=null;return}if(t===l.length-1){if(!n)return;f===null?s.push("M".concat(t+d,",").concat(i+d," h1v1H").concat(t+d,"z")):s.push("M".concat(f+d,",").concat(i+d," h").concat(t+1-f,"v1H").concat(f+d,"z"));return}n&&f===null&&(f=t)})}),s.join("")}function Te(r,d,s,l){var i=l.width,f=l.height,n=l.x,t=l.y,e=r.length+s*2,a=Math.floor(d*.1),o=e/d,u=(i||a)*o,c=(f||a)*o,m=n==null?r.length/2-u/2:n*o,b=t==null?r.length/2-c/2:t*o,M=null;if(l.excavate){var p=Math.floor(m),P=Math.floor(b),R=Math.ceil(u+m-p),k=Math.ceil(c+b-P);M={x:p,y:P,w:R,h:k}}return{x:m,y:b,h:c,w:u,excavation:M}}function xe(r,d){return r.slice().map(function(s,l){return l<d.y||l>=d.y+d.h?s:s.map(function(i,f){return f<d.x||f>=d.x+d.w?i:!1})})}var he={value:{type:String,required:!0,default:""},size:{type:Number,default:100},level:{type:String,default:ce,validator:function(r){return fe(r)}},background:{type:String,default:"#fff"},foreground:{type:String,default:"#000"},margin:{type:Number,required:!1,default:0},imageSettings:{type:Object,required:!1,default:function(){return{}}},gradient:{type:Boolean,required:!1,default:!1},gradientType:{type:String,required:!1,default:"linear",validator:function(r){return["linear","radial"].indexOf(r)>-1}},gradientStartColor:{type:String,required:!1,default:"#000"},gradientEndColor:{type:String,required:!1,default:"#fff"}},Ot=U(U({},he),{renderAs:{type:String,required:!1,default:"canvas",validator:function(r){return["canvas","svg"].indexOf(r)>-1}}}),zt=z({name:"QRCodeSvg",props:he,setup:function(r){var d=D(0),s=D(""),l,i=function(){var n=r.value,t=r.level,e=r.margin,a=e>>>0,o=fe(t)?t:ce,u=X.QrCode.encodeText(n,de[o]).getModules();if(d.value=u.length+a*2,r.imageSettings.src){var c=Te(u,r.size,a,r.imageSettings);l={x:c.x+a,y:c.y+a,width:c.w,height:c.h},c.excavation&&(u=xe(u,c.excavation))}s.value=Ae(u,a)},f=function(){if(!r.gradient)return null;var n=r.gradientType==="linear"?{x1:"0%",y1:"0%",x2:"100%",y2:"100%"}:{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"};return A(r.gradientType==="linear"?"linearGradient":"radialGradient",U({id:"qr-gradient"},n),[A("stop",{offset:"0%",style:{stopColor:r.gradientStartColor}}),A("stop",{offset:"100%",style:{stopColor:r.gradientEndColor}})])};return i(),Pe(i),function(){return A("svg",{width:r.size,height:r.size,"shape-rendering":"crispEdges",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(d.value," ").concat(d.value)},[A("defs",{},[f()]),A("rect",{width:"100%",height:"100%",fill:r.background}),A("path",{fill:r.gradient?"url(#qr-gradient)":r.foreground,d:s.value}),r.imageSettings.src&&A("image",U({href:r.imageSettings.src},l))])}}}),Ut=z({name:"QRCodeCanvas",props:he,setup:function(r,d){var s=D(null),l=D(null),i=function(){var n=r.value,t=r.level,e=r.size,a=r.margin,o=r.background,u=r.foreground,c=r.gradient,m=r.gradientType,b=r.gradientStartColor,M=r.gradientEndColor,p=a>>>0,P=fe(t)?t:ce,R=s.value;if(R){var k=R.getContext("2d");if(k){var C=X.QrCode.encodeText(n,de[P]).getModules(),S=C.length+p*2,B=l.value,N={x:0,y:0,width:0,height:0},L=r.imageSettings.src&&B!=null&&B.naturalWidth!==0&&B.naturalHeight!==0;if(L){var q=Te(C,r.size,p,r.imageSettings);N={x:q.x+p,y:q.y+p,width:q.w,height:q.h},q.excavation&&(C=xe(C,q.excavation))}var T=window.devicePixelRatio||1,h=e/S*T;if(R.height=R.width=e*T,k.scale(h,h),k.fillStyle=o,k.fillRect(0,0,S,S),c){var _=void 0;m==="linear"?_=k.createLinearGradient(0,0,S,S):_=k.createRadialGradient(S/2,S/2,0,S/2,S/2,S/2),_.addColorStop(0,b),_.addColorStop(1,M),k.fillStyle=_}else k.fillStyle=u;Ft?k.fill(new Path2D(Ae(C,p))):C.forEach(function(v,G){v.forEach(function(H,ee){H&&k.fillRect(ee+p,G+p,1,1)})}),L&&k.drawImage(B,N.x,N.y,N.width,N.height)}}};ie(i),Pe(i);var f=d.attrs.style;return function(){return A(K,[A("canvas",U(U({},d.attrs),{ref:s,style:U(U({},f),{width:"".concat(r.size,"px"),height:"".concat(r.size,"px")})})),r.imageSettings.src&&A("img",{ref:l,src:r.imageSettings.src,style:{display:"none"},onLoad:i})])}}}),pe=z({name:"Qrcode",render:function(){var r=this.$props,d=r.renderAs,s=r.value,l=r.size,i=r.margin,f=r.level,n=r.background,t=r.foreground,e=r.imageSettings,a=r.gradient,o=r.gradientType,u=r.gradientStartColor,c=r.gradientEndColor;return A(d==="svg"?zt:Ut,{value:s,size:l,margin:i,level:f,background:n,foreground:t,imageSettings:e,gradient:a,gradientType:o,gradientStartColor:u,gradientEndColor:c})},props:Ot});const Vt={key:0},Ht=["href"],Gt={key:1},Wt=z({__name:"PageQrCode",props:{urls:{},textAbove:{},textBelow:{},linkQrCodes:{type:Boolean,default:()=>!1}},setup(r){const d=r;return(s,l)=>r.urls?.length>0?(g(),E(Le,{key:0,appear:"","enter-active-class":"animated fadeIn"},{default:y(()=>[w(oe,{class:"pb-card-qrcode no-shadow",style:{width:"200px"}},{default:y(()=>[r.textAbove?(g(),E(W,{key:0,class:"pb-qrcode-text-above q-pa-sm"},{default:y(()=>[re(V(r.textAbove),1)]),_:1})):$("",!0),(g(!0),x(K,null,j(d.urls,(i,f)=>(g(),E(W,{class:"pb-qrcode-code q-pa-none q-px-sm",key:f},{default:y(()=>[r.linkQrCodes?(g(),x("div",Vt,[O("a",{href:i,target:"_blank"},[w(pe,{value:i,margin:2,size:200,level:"L","render-as":"svg",style:{width:"100%"}},null,8,["value"])],8,Ht)])):(g(),x("div",Gt,[w(pe,{value:i,margin:2,size:200,level:"L","render-as":"svg",style:{width:"100%"}},null,8,["value"])]))]),_:2},1024))),128)),r.textBelow?(g(),E(W,{key:1,class:"pb-qrcode-text-below q-pa-sm"},{default:y(()=>[re(V(r.textBelow),1)]),_:1})):$("",!0)]),_:1})]),_:1})):$("",!0)}}),Yt=Se(Wt,[["__scopeId","data-v-a43cb4f0"]]),Kt=ue({name:"QCarouselSlide",props:{...ot,imgSrc:String},setup(r,{slots:d}){const s=Q(()=>r.imgSrc?{backgroundImage:`url("${r.imgSrc}")`}:{});return()=>A("div",{class:"q-carousel__slide",style:s.value},Qe(d.default))}}),Xt=["top","right","bottom","left"],Jt=["regular","flat","outline","push","unelevated"],Zt=ue({name:"QCarousel",props:{...Fe,...lt,...dt,transitionPrev:{type:String,default:"fade"},transitionNext:{type:String,default:"fade"},height:String,padding:Boolean,controlColor:String,controlTextColor:String,controlType:{type:String,validator:r=>Jt.includes(r),default:"flat"},autoplay:[Number,Boolean],arrows:Boolean,prevIcon:String,nextIcon:String,navigation:Boolean,navigationPosition:{type:String,validator:r=>Xt.includes(r)},navigationIcon:String,navigationActiveIcon:String,thumbnails:Boolean},emits:[...ct,...it],setup(r,{slots:d}){const{proxy:{$q:s}}=Oe(),l=ze(r,s);let i=null,f;const{updatePanelsList:n,getPanelContent:t,panelDirectives:e,goToPanel:a,previousPanel:o,nextPanel:u,getEnabledPanels:c,panelIndex:m}=st(),{inFullscreen:b}=ft(),M=Q(()=>b.value!==!0&&r.height!==void 0?{height:r.height}:{}),p=Q(()=>r.vertical===!0?"vertical":"horizontal"),P=Q(()=>r.navigationPosition||(r.vertical===!0?"right":"bottom")),R=Q(()=>`q-carousel q-panel-parent q-carousel--with${r.padding===!0?"":"out"}-padding`+(b.value===!0?" fullscreen":"")+(l.value===!0?" q-carousel--dark q-dark":"")+(r.arrows===!0?` q-carousel--arrows-${p.value}`:"")+(r.navigation===!0?` q-carousel--navigation-${P.value}`:"")),k=Q(()=>{const T=[r.prevIcon||s.iconSet.carousel[r.vertical===!0?"up":"left"],r.nextIcon||s.iconSet.carousel[r.vertical===!0?"down":"right"]];return r.vertical===!1&&s.lang.rtl===!0?T.reverse():T}),C=Q(()=>r.navigationIcon||s.iconSet.carousel.navigationIcon),S=Q(()=>r.navigationActiveIcon||C.value),B=Q(()=>({color:r.controlColor,textColor:r.controlTextColor,round:!0,[r.controlType]:!0,dense:!0}));ne(()=>r.modelValue,()=>{r.autoplay&&N()}),ne(()=>r.autoplay,T=>{T?N():i!==null&&(clearTimeout(i),i=null)});function N(){const T=be(r.autoplay)===!0?Math.abs(r.autoplay):5e3;i!==null&&clearTimeout(i),i=setTimeout(()=>{i=null,T>=0?u():o()},T)}ie(()=>{r.autoplay&&N()}),ke(()=>{i!==null&&clearTimeout(i)});function L(T,h){return A("div",{class:`q-carousel__control q-carousel__navigation no-wrap absolute flex q-carousel__navigation--${T} q-carousel__navigation--${P.value}`+(r.controlColor!==void 0?` text-${r.controlColor}`:"")},[A("div",{class:"q-carousel__navigation-inner flex flex-center no-wrap"},c().map(h))])}function q(){const T=[];if(r.navigation===!0){const h=d["navigation-icon"]!==void 0?d["navigation-icon"]:v=>A(F,{key:"nav"+v.name,class:`q-carousel__navigation-icon q-carousel__navigation-icon--${v.active===!0?"":"in"}active`,...v.btnProps,onClick:v.onClick}),_=f-1;T.push(L("buttons",(v,G)=>{const H=v.props.name,ee=m.value===G;return h({index:G,maxIndex:_,name:H,active:ee,btnProps:{icon:ee===!0?S.value:C.value,size:"sm",...B.value},onClick:()=>{a(H)}})}))}else if(r.thumbnails===!0){const h=r.controlColor!==void 0?` text-${r.controlColor}`:"";T.push(L("thumbnails",_=>{const v=_.props;return A("img",{key:"tmb#"+v.name,class:`q-carousel__thumbnail q-carousel__thumbnail--${v.name===r.modelValue?"":"in"}active`+h,src:v.imgSrc||v["img-src"],onClick:()=>{a(v.name)}})}))}return r.arrows===!0&&m.value>=0&&((r.infinite===!0||m.value>0)&&T.push(A("div",{key:"prev",class:`q-carousel__control q-carousel__arrow q-carousel__prev-arrow q-carousel__prev-arrow--${p.value} absolute flex flex-center`},[A(F,{icon:k.value[0],...B.value,onClick:o})])),(r.infinite===!0||m.value<f-1)&&T.push(A("div",{key:"next",class:`q-carousel__control q-carousel__arrow q-carousel__next-arrow q-carousel__next-arrow--${p.value} absolute flex flex-center`},[A(F,{icon:k.value[1],...B.value,onClick:u})]))),Ve(d.control,T)}return()=>(f=n(d),A("div",{class:R.value,style:M.value},[Ue("div",{class:"q-carousel__slides-container"},t(),"sl-cont",r.swipeable,()=>e.value)].concat(q())))}}),jt=z({__name:"PageCarouselView",props:{slicedImages:{},mediaitemId:{}},emits:["triggerChangedItem"],setup(r,{emit:d}){const s=r,l=He(s.mediaitemId);ne(()=>s.mediaitemId,t=>{l.value=t});const i=d;function f(){console.log("TODO: add method to close dialog programmatically")}function n(t){i("triggerChangedItem",t)}return(t,e)=>J((g(),E(Zt,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value=a),class:"",style:{width:"100%",height:"100%"},"control-type":"flat","control-color":"primary",swipeable:"",animated:"",draggable:"false",arrows:!0,infinite:!0,"transition-prev":"slide-right","transition-next":"slide-left",onTransition:n},{default:y(()=>[(g(!0),x(K,null,j(s.slicedImages,a=>(g(),E(Kt,{key:a.id,name:a.id,class:"column no-wrap flex-center full-height q-pa-sm"},{default:y(()=>[w(Me,{item:a},null,8,["item"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])),[[ut,f,void 0,{mouse:!0,down:!0}]])}}),ea={key:0,class:"fixed-full"},ta={key:1},ka=z({__name:"GalleryDetailPage",props:{startTimer:{type:Boolean},itemPresenterMode:{type:Boolean}},setup(r){const d=Ze(),s=Ye(),l=Xe(),i=Ge(),f=We(),n=D(""),t=D(!1),e=D(!1),a=D(!1),o=D(!1),u=D(0),c=D([]),m=D([]),b=r;ye(()=>{n.value=s.params.id,B()}),ne(s,h=>{n.value=h.params.id}),ie(()=>{e.value=b.startTimer});const M=h=>{n.value=h},p=Q(()=>C(n.value));Ke(n,async()=>{try{const h=await le(`/api/share/download/${n.value}`);if(!h.ok)throw`Error: ${h.status} ${h.statusText}`;m.value=await h.json(),console.log(m.value)}catch(h){console.warn(h)}},{debounce:600});const P=Q(()=>f.collection.findIndex(h=>h.id==n.value)+1),R=Q(()=>i.configuration.uisettings.gallery_show_filter&&S(p.value.media_type)),k=Q(()=>{const h=[];return i.configuration.share.actions.forEach((v,G)=>{const H={config_index:G,handles_images_only:v.handles_images_only,show_button:v.trigger.ui_trigger.show_button,title:v.trigger.ui_trigger.title,icon:v.trigger.ui_trigger.icon,image_path:v.trigger.ui_trigger.image_path};h.push(H)}),h}),C=h=>f.collection.find(_=>_.id==h),S=h=>["image"].includes(h),B=async()=>{try{const h=await le("/api/filter/");c.value=await h.json(),console.log(c.value)}catch(h){console.warn(h)}},N=(h,_)=>{a.value=!0,fetch(`/api/filter/${h}?filter=${_}`,{method:"PATCH"}).then(v=>{if(!v.ok)throw new Error("Server returned "+v.status);a.value=!1}).catch(v=>{console.error(v),a.value=!1})},L=h=>{n.value=void 0,f.deleteItem(h),l.back()},q=h=>{console.log("doShareAction",n.value,h),i.configuration.share.actions[h].processing.ask_user_for_parameter_input?(u.value=h,o.value=!0):Je(`/api/share/actions/${n.value}/${h}`,"POST")},T=async(h,_)=>{console.warn(n.value,h,_),console.log(JSON.stringify(_));try{const v=await le(`/api/share/actions/${n.value}/${h}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)});if(console.log(v),!v.ok)throw`Error: ${v.status} ${v.statusText}`}catch(v){console.error(v),d.notify({message:v,caption:"Request Error!",color:"negative"})}};return(h,_)=>(g(),E(et,{view:"hhh Lpr ffr",onClick:_[5]||(_[5]=v=>e.value=!1)},{default:y(()=>[p.value?(g(),x("div",ea,[w(Re,{class:"bg-primary text-white"},{default:y(()=>[e.value?(g(),E(xt,{key:0,duration:I(i).configuration.uisettings.AUTOCLOSE_NEW_ITEM_ARRIVED,onTriggerTimeout:_[0]||(_[0]=v=>h.$router.push({path:"/"}))},null,8,["duration"])):$("",!0),a.value?(g(),E($t,{key:1})):$("",!0)]),_:1}),R.value?(g(),E(Ne,{key:0,id:"gallery-drawer-filters",modelValue:t.value,"onUpdate:modelValue":_[1]||(_[1]=v=>t.value=v),class:"q-pa-sm",side:"right",overlay:"",elevated:""},{default:y(()=>[t.value?(g(),E(Qt,{key:0,id:p.value.id,"available-filter":c.value,onTriggerApplyFilter:N},null,8,["id","available-filter"])):$("",!0)]),_:1},8,["modelValue"])):$("",!0),w(tt,{class:"q-pa-none galleryimagedetail full-height"},{default:y(()=>[w(je,{class:"full-height"},{default:y(()=>[r.itemPresenterMode?(g(),E(Me,{key:0,item:p.value,style:{"user-select":"none"}},null,8,["item"])):(g(),E(jt,{key:1,"mediaitem-id":p.value.id,"sliced-images":I(f).collection,onTriggerChangedItem:M,onClick:_[2]||(_[2]=v=>t.value=!1)},null,8,["mediaitem-id","sliced-images"])),I(i).configuration.uisettings.gallery_show_qrcode?(g(),E(we,{key:2,position:"top-right",class:"q-ma-lg"},{default:y(()=>[w(Yt,{urls:m.value,"text-above":I(i).configuration.uisettings.qrcode_text_above,"text-below":I(i).configuration.uisettings.qrcode_text_below,linkQrCodes:I(i).configuration.uisettings.qrcode_link_codes},null,8,["urls","text-above","text-below","linkQrCodes"])]),_:1})):$("",!0),w(Tt,{item:p.value,"show-filter":I(i).configuration.uisettings.gallery_show_filter,"enable-filter":S(p.value.media_type),"show-share":I(i).configuration.uisettings.gallery_show_shareprint&&I(i).configuration.share.sharing_enabled,"share-buttons":k.value,"show-delete":b.itemPresenterMode||I(i).configuration.uisettings.gallery_show_delete,"show-download":I(i).configuration.uisettings.gallery_show_download,"filter-image-path":I(i).configuration.uisettings.gallery_filter_image_path,"download-image-path":I(i).configuration.uisettings.gallery_download_image_path,"delete-image-path":I(i).configuration.uisettings.gallery_delete_image_path,image_number:P.value,images_total:I(f).collection_number_of_items,onTriggerToggleDisplayFilter:_[3]||(_[3]=v=>t.value=!t.value),onTriggerDeleteMediaitem:L,onTriggerShareAction:q},null,8,["item","show-filter","enable-filter","show-share","share-buttons","show-delete","show-download","filter-image-path","download-image-path","delete-image-path","image_number","images_total"]),w(Ee,{modelValue:o.value,"onUpdate:modelValue":_[4]||(_[4]=v=>o.value=v)},{default:y(()=>[w(wt,{parameters:I(i).configuration.share.actions[u.value].processing.parameters,parameters_dialog_caption:I(i).configuration.share.actions[u.value].processing.parameters_dialog_caption,parameters_dialog_action_icon:I(i).configuration.share.actions[u.value].processing.parameters_dialog_action_icon,parameters_dialog_action_label:I(i).configuration.share.actions[u.value].processing.parameters_dialog_action_label,config_index:u.value,onTriggerShareActionWithParameters:T},null,8,["parameters","parameters_dialog_caption","parameters_dialog_action_icon","parameters_dialog_action_label","config_index"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):(g(),x("div",ta,[w(ht)]))]),_:1}))}});export{ka as default};
