import{Q as xt}from"./QHeader-B-ZeN3Gm.js";import{u as zt,a as Ot,b as Ht,c as Kt,T as Jt,Q as Yt}from"./use-panel-C-zVKO1S.js";import{Q as St}from"./QPageSticky-DRm82G8v.js";import{x as xe,A as x,d as G,$ as jt,P as At,n as R,Z as fe,p as q,q as k,a0 as W,E as Q,C as re,G as O,Q as U,b as V,H as ae,I as ge,a1 as Tt,s as D,v as L,J as ue,M as oe,f as T,a2 as ce,a3 as Qe,a4 as Gt,a5 as Pt,L as Wt,B as J,F as de,a6 as kt,a7 as Xt,l as ze,o as qt,a8 as Zt,a9 as en,aa as tn,w as ie,ab as nn,ac as Rt,c as F,Y as rn,ad as on,ae as an,af as sn,X as ln,ag as un,h as cn,i as dn,j as fn,ah as Ye,k as gn,r as hn,e as mn}from"./index-iTDA5xth.js";import{Q as pn}from"./QPage-CjVr3GpS.js";import{Q as yn,a as _n}from"./QLayout-Cz-MKMAS.js";import{Q as je}from"./QInput-CEDwPgN2.js";import{Q as wn}from"./QForm-Bi1ZboxH.js";import{Q as Ge}from"./QBadge-Ba1f5g1T.js";import{Q as Nt}from"./QLinearProgress-CbIMKp0x.js";import{_ as Mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as vn}from"./QImg-Bm56G4F6.js";import{u as Cn,a as bn,b as En}from"./use-fullscreen-P-FENTpQ.js";import{_ as Bn}from"./MediaItemPreviewViewer.vue_vue_type_script_setup_true_lang-DL2D-M_z.js";import{I as In}from"./ItemNotAvailableError-CsxgPaQ7.js";import"./selection-BZ1NN8gY.js";import"./format-CJebrXOQ.js";import"./use-id-f67RVCgy.js";const Sn=xe({name:"QSpace",setup(){const n=x("div",{class:"q-space"});return()=>n}}),An={class:"text-h6"},Tn={class:"q-gutter-md"},Pn={key:0},kn={key:1},qn=G({__name:"PageShareParameters",props:{config_index:{},parameters_dialog_caption:{},parameters_dialog_action_icon:{},parameters_dialog_action_label:{},parameters:{}},emits:["triggerShareActionWithParameters"],setup(n,{emit:a}){const i=jt({}),t=n,e=a;At(()=>{t.parameters.forEach(s=>i[s.key]=s.default)});const r=()=>{e("triggerShareActionWithParameters",t.config_index,i)};return(s,l)=>(T(),R(fe,{style:{width:"400px"},class:""},{default:q(()=>[k(wn,{autofocus:"",onSubmit:r,class:"q-gutter-md",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},{default:q(()=>[k(W,{class:"row items-center q-pb-none"},{default:q(()=>[Q("div",An,O(s.parameters_dialog_caption),1),k(Sn),re(k(U,{icon:"sym_o_close",flat:""},null,512),[[ce]])]),_:1}),k(W,{class:"q-pa-md"},{default:q(()=>[Q("div",Tn,[(T(!0),V(ae,null,ge(t.parameters,o=>(T(),V("div",{key:o.key},[o.ui_type=="int"?(T(),V("div",Pn,[(T(),R(je,{filled:"",modelValue:i[o.key],"onUpdate:modelValue":u=>i[o.key]=u,label:o.label,key:o.key,name:o.key,rules:[u=>u!==null&&u!==""||"Please type a number",u=>o.valid_max&&parseInt(u)<=parseInt(o.valid_max)||`Please type a number lower than ${o.valid_max}`,u=>o.valid_min&&parseInt(u)>=parseInt(o.valid_min)||`Please type a number more than ${o.valid_min}`]},{before:q(()=>[k(U,{icon:"sym_o_remove",color:"primary",flat:"",onClick:u=>i[o.key]=String(parseInt(i[o.key])-1),disable:o.valid_min&&parseInt(i[o.key])<=parseInt(o.valid_min)},null,8,["onClick","disable"])]),after:q(()=>[k(U,{icon:"sym_o_add",color:"primary",flat:"",onClick:u=>i[o.key]=String(parseInt(i[o.key])+1),disable:o.valid_max&&parseInt(i[o.key])>=parseInt(o.valid_max)},null,8,["onClick","disable"])]),_:2},1032,["modelValue","onUpdate:modelValue","label","name","rules"]))])):(T(),V("div",kn,[(T(),R(je,{filled:"",modelValue:i[o.key],"onUpdate:modelValue":u=>i[o.key]=u,label:o.label,key:o.key,name:o.key,class:"",rules:[u=>u&&u.length>0||"Please type something",u=>o.valid_max&&u.length<=parseInt(o.valid_max)||`Please type text longest ${o.valid_max} chars.`,u=>o.valid_min&&u.length>=parseInt(o.valid_min)||`Please type text shortest ${o.valid_min} chars.`]},null,8,["modelValue","onUpdate:modelValue","label","name","rules"]))]))]))),128))])]),_:1}),k(Tt,{align:"center"},{default:q(()=>[re((T(),R(U,{stack:"","no-caps":"",color:"primary",class:"q-ma-sm",type:"submit",size:"md",padding:"md lg"},{default:q(()=>[L(ue.isEmpty)(s.parameters_dialog_action_icon)?D("",!0):(T(),R(oe,{key:0,name:`sym_o_${s.parameters_dialog_action_icon}`},null,8,["name"])),Q("div",null,O(s.parameters_dialog_action_label),1)]),_:1})),[[ce]])]),_:1})]),_:1})]),_:1}))}});function Rn(n){const a=Object.assign({noopener:!0},n),i=[];for(const t in a){const e=a[t];e===!0?i.push(t):(Pt(e)||typeof e=="string"&&e!=="")&&i.push(t+"="+e)}return i.join(",")}function We(n,a,i){let t=window.open;if(Qe.is.cordova===!0){if(cordova?.InAppBrowser?.open!==void 0)t=cordova.InAppBrowser.open;else if(navigator?.app!==void 0)return navigator.app.loadUrl(n,{openExternal:!0})}const e=t(n,"_blank",Rn(i));if(e)return Qe.is.desktop&&e.focus(),e;a?.()}const Nn=(n,a,i)=>{if(Qe.is.ios===!0&&window.SafariViewController!==void 0){window.SafariViewController.isAvailable(t=>{t?window.SafariViewController.show({url:n},Gt,a):We(n,a,i)});return}return We(n,a,i)},Mn=G({__name:"ShareTriggerButtons",props:{triggers:{},currentItemIsImage:{type:Boolean}},emits:["triggerAction"],setup(n,{emit:a}){const i=n;function t(s){return!i.currentItemIsImage&&s}const e=a;function r(s){console.log(`trigger share config_index ${s}`),e("triggerAction",s)}return(s,l)=>(T(!0),V(ae,null,ge(s.triggers,(o,u)=>(T(),V("div",{key:u},[o.show_button&&!(L(ue.isEmpty)(o.title)&&L(ue.isEmpty)(o.icon))?(T(),R(U,{key:0,stack:"",rounded:"","no-caps":"",color:"primary",disabled:t(o.handles_images_only),class:Wt(["q-mr-sm action-button action-button-share col-auto glass-effect",["share-button-"+u]]),onClick:g=>r(o.config_index)},{default:q(()=>[L(ue.isEmpty)(o.icon)?D("",!0):(T(),R(oe,{key:0,name:`sym_o_${o.icon}`},null,8,["name"])),Q("div",null,O(o.title),1)]),_:2},1032,["disabled","class","onClick"])):D("",!0)]))),128))}}),Ln={class:"q-mb-lg action-buttons col"},Dn={class:"q-pa-md row flex flex-center"},Fn={class:"q-mr-sm row flex flex-center"},$n={class:"q-ml-sm"},Un=G({__name:"PageToolbar",props:{item:{},image_number:{},images_total:{},showDownload:{type:Boolean},showDelete:{type:Boolean},showFilter:{type:Boolean},showShare:{type:Boolean},shareButtons:{},enableFilter:{type:Boolean}},emits:["triggerShareAction","triggerToggleDisplayFilter","triggerDeleteMediaitem","closeEvent"],setup(n,{emit:a}){const i=J(!1),t=n,e=a;function r(o){e("triggerShareAction",o)}function s(){e("triggerToggleDisplayFilter")}function l(o){e("triggerDeleteMediaitem",o)}return(o,u)=>(T(),V(ae,null,[o.item?(T(),R(St,{key:0,position:"bottom",id:"gallery-toolbar",class:"toolbar"},{default:q(()=>[Q("div",Ln,[Q("div",Dn,[o.showDelete?(T(),R(U,{key:0,stack:"",rounded:"",class:"q-mr-sm action-button action-button-delete col-auto glass-effect",color:"primary","no-caps":"",icon:"sym_o_delete",label:o.$t("BTN_LABEL_GALLERY_DELETE"),onClick:u[0]||(u[0]=g=>i.value=!0)},null,8,["label"])):D("",!0),o.showFilter&&o.enableFilter?(T(),R(U,{key:1,stack:"","no-caps":"",rounded:"",color:"primary",class:"q-mr-sm action-button action-button-filter col-auto glass-effect",icon:"sym_o_filter",label:o.$t("BTN_LABEL_GALLERY_FILTER"),onClick:s},null,8,["label"])):D("",!0),o.showDownload?(T(),R(U,{key:2,stack:"","no-caps":"",rounded:"",color:"primary",class:"q-mr-sm action-button action-button-download col-auto glass-effect",icon:"sym_o_download",label:o.$t("BTN_LABEL_GALLERY_DOWNLOAD"),onClick:u[1]||(u[1]=g=>L(Nn)(`/media/full/${o.item.id}`))},null,8,["label"])):D("",!0),o.showShare?(T(),R(Mn,{key:3,triggers:o.shareButtons,"current-item-is-image":["image","collage","collageimage","animationimage"].includes(o.item.media_type),onTriggerAction:r},null,8,["triggers","current-item-is-image"])):D("",!0)]),Q("div",Fn,[k(Ge,{color:"grey-8",class:"q-mr-xs"},{default:q(()=>[k(oe,{name:"sym_o_image",color:"white",class:"q-mr-xs"}),de(" "+O(o.item.id),1)]),_:1}),t.image_number&&t.images_total?(T(),R(Ge,{key:0,color:"grey-8",class:"q-mr-xs"},{default:q(()=>[k(oe,{name:"sym_o_tag",color:"white",class:"q-mr-xs"}),de(" "+O(o.$t("LABEL_ELEMENT_X_OF_Y",{no:t.image_number,total:t.images_total})),1)]),_:1})):D("",!0)])])]),_:1})):D("",!0),k(kt,{modelValue:i.value,"onUpdate:modelValue":u[3]||(u[3]=g=>i.value=g)},{default:q(()=>[k(fe,{id:"gallery-confirm-delete-dialog",class:"q-pa-sm",style:{"min-width":"350px"}},{default:q(()=>[k(W,{class:"row items-center",style:{"flex-wrap":"nowrap"}},{default:q(()=>[k(Xt,{icon:"sym_o_delete",color:"primary","text-color":"white"}),Q("span",$n,O(o.$t("MSG_CONFIRM_DELETE_IMAGE")),1)]),_:1}),k(Tt,{align:"right"},{default:q(()=>[re(k(U,{flat:"",label:o.$t("BTN_LABEL_CANCEL")},null,8,["label"]),[[ce]]),re(k(U,{label:o.$t("BTN_LABEL_DELETE_IMAGE"),color:"primary",onClick:u[2]||(u[2]=g=>[l(o.item.id),o.$emit("closeEvent")])},null,8,["label"]),[[ce]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Vn=G({__name:"HeaderCountdownTimer",props:{duration:{}},emits:["triggerTimeout"],setup(n,{emit:a}){const i=n,t=J(0);let e;const r=a;function s(){clearInterval(e),t.value=0}function l(){t.value=i.duration,e=window.setInterval(()=>{t.value-=.1,t.value<=0&&(clearInterval(e),r("triggerTimeout"))},100)}return ze(()=>{l()}),qt(()=>{s()}),(o,u)=>t.value>=0?(T(),R(Nt,{key:0,id:"gallery-linear-progress-bar",class:"absolute",value:t.value/i.duration,"animation-speed":"200",color:"grey"},null,8,["value"])):D("",!0)}}),Qn={};function xn(n,a){return T(),R(Nt,{class:"absolute",indeterminate:"","animation-speed":"2100",color:"primary"})}const zn=Mt(Qn,[["render",xn]]),On={key:0},Hn={class:"text-center text-overline"},Kn={class:"absolute-bottom-right text-subtitle1 text-center",style:{padding:"4px","pointer-events":"none"}},Jn={key:1,class:"text-center"},Yn=G({__name:"DrawerFilter",props:{id:{},availableFilter:{}},emits:["triggerApplyFilter"],setup(n,{emit:a}){const i=n,t=a;function e(r){t("triggerApplyFilter",i.id,r)}return(r,s)=>r.availableFilter.length>0?(T(),V("div",On,[Q("div",Hn,O(r.$t("Choose your filter")),1),(T(!0),V(ae,null,ge(r.availableFilter,l=>(T(),R(fe,{key:l,bordered:"",class:"q-mb-sm no-shadow"},{default:q(()=>[k(W,{class:"q-pa-none"},{default:q(()=>[k(vn,{class:"rounded-borders",loading:"lazy",src:`/api/filter/${r.id}?filter=${l}`,onClick:o=>e(l)},{default:q(()=>[Q("div",Kn,O(l),1)]),_:2},1032,["src","onClick"])]),_:2},1024)]),_:2},1024))),128))])):(T(),V("div",Jn,[k(oe,{name:"sym_o_mood_bad",size:"xl"}),s[0]||(s[0]=Q("p",null,"No filter available.",-1))]))}});var te={},_e,Xe;function jn(){return Xe||(Xe=1,_e=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),_e}var we={},j={},Ze;function X(){if(Ze)return j;Ze=1;let n;const a=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return j.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17},j.getSymbolTotalCodewords=function(t){return a[t]},j.getBCHDigit=function(i){let t=0;for(;i!==0;)t++,i>>>=1;return t},j.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');n=t},j.isKanjiModeEnabled=function(){return typeof n<"u"},j.toSJIS=function(t){return n(t)},j}var ve={},et;function Oe(){return et||(et=1,function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function a(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+i)}}n.isValid=function(t){return t&&typeof t.bit<"u"&&t.bit>=0&&t.bit<4},n.from=function(t,e){if(n.isValid(t))return t;try{return a(t)}catch{return e}}}(ve)),ve}var Ce,tt;function Gn(){if(tt)return Ce;tt=1;function n(){this.buffer=[],this.length=0}return n.prototype={get:function(a){const i=Math.floor(a/8);return(this.buffer[i]>>>7-a%8&1)===1},put:function(a,i){for(let t=0;t<i;t++)this.putBit((a>>>i-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(a){const i=Math.floor(this.length/8);this.buffer.length<=i&&this.buffer.push(0),a&&(this.buffer[i]|=128>>>this.length%8),this.length++}},Ce=n,Ce}var be,nt;function Wn(){if(nt)return be;nt=1;function n(a){if(!a||a<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=a,this.data=new Uint8Array(a*a),this.reservedBit=new Uint8Array(a*a)}return n.prototype.set=function(a,i,t,e){const r=a*this.size+i;this.data[r]=t,e&&(this.reservedBit[r]=!0)},n.prototype.get=function(a,i){return this.data[a*this.size+i]},n.prototype.xor=function(a,i,t){this.data[a*this.size+i]^=t},n.prototype.isReserved=function(a,i){return this.reservedBit[a*this.size+i]},be=n,be}var Ee={},rt;function Xn(){return rt||(rt=1,function(n){const a=X().getSymbolSize;n.getRowColCoords=function(t){if(t===1)return[];const e=Math.floor(t/7)+2,r=a(t),s=r===145?26:Math.ceil((r-13)/(2*e-2))*2,l=[r-7];for(let o=1;o<e-1;o++)l[o]=l[o-1]-s;return l.push(6),l.reverse()},n.getPositions=function(t){const e=[],r=n.getRowColCoords(t),s=r.length;for(let l=0;l<s;l++)for(let o=0;o<s;o++)l===0&&o===0||l===0&&o===s-1||l===s-1&&o===0||e.push([r[l],r[o]]);return e}}(Ee)),Ee}var Be={},ot;function Zn(){if(ot)return Be;ot=1;const n=X().getSymbolSize,a=7;return Be.getPositions=function(t){const e=n(t);return[[0,0],[e-a,0],[0,e-a]]},Be}var Ie={},it;function er(){return it||(it=1,function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const a={N1:3,N2:3,N3:40,N4:10};n.isValid=function(e){return e!=null&&e!==""&&!isNaN(e)&&e>=0&&e<=7},n.from=function(e){return n.isValid(e)?parseInt(e,10):void 0},n.getPenaltyN1=function(e){const r=e.size;let s=0,l=0,o=0,u=null,g=null;for(let w=0;w<r;w++){l=o=0,u=g=null;for(let _=0;_<r;_++){let h=e.get(w,_);h===u?l++:(l>=5&&(s+=a.N1+(l-5)),u=h,l=1),h=e.get(_,w),h===g?o++:(o>=5&&(s+=a.N1+(o-5)),g=h,o=1)}l>=5&&(s+=a.N1+(l-5)),o>=5&&(s+=a.N1+(o-5))}return s},n.getPenaltyN2=function(e){const r=e.size;let s=0;for(let l=0;l<r-1;l++)for(let o=0;o<r-1;o++){const u=e.get(l,o)+e.get(l,o+1)+e.get(l+1,o)+e.get(l+1,o+1);(u===4||u===0)&&s++}return s*a.N2},n.getPenaltyN3=function(e){const r=e.size;let s=0,l=0,o=0;for(let u=0;u<r;u++){l=o=0;for(let g=0;g<r;g++)l=l<<1&2047|e.get(u,g),g>=10&&(l===1488||l===93)&&s++,o=o<<1&2047|e.get(g,u),g>=10&&(o===1488||o===93)&&s++}return s*a.N3},n.getPenaltyN4=function(e){let r=0;const s=e.data.length;for(let o=0;o<s;o++)r+=e.data[o];return Math.abs(Math.ceil(r*100/s/5)-10)*a.N4};function i(t,e,r){switch(t){case n.Patterns.PATTERN000:return(e+r)%2===0;case n.Patterns.PATTERN001:return e%2===0;case n.Patterns.PATTERN010:return r%3===0;case n.Patterns.PATTERN011:return(e+r)%3===0;case n.Patterns.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2===0;case n.Patterns.PATTERN101:return e*r%2+e*r%3===0;case n.Patterns.PATTERN110:return(e*r%2+e*r%3)%2===0;case n.Patterns.PATTERN111:return(e*r%3+(e+r)%2)%2===0;default:throw new Error("bad maskPattern:"+t)}}n.applyMask=function(e,r){const s=r.size;for(let l=0;l<s;l++)for(let o=0;o<s;o++)r.isReserved(o,l)||r.xor(o,l,i(e,o,l))},n.getBestMask=function(e,r){const s=Object.keys(n.Patterns).length;let l=0,o=1/0;for(let u=0;u<s;u++){r(u),n.applyMask(u,e);const g=n.getPenaltyN1(e)+n.getPenaltyN2(e)+n.getPenaltyN3(e)+n.getPenaltyN4(e);n.applyMask(u,e),g<o&&(o=g,l=u)}return l}}(Ie)),Ie}var le={},at;function Lt(){if(at)return le;at=1;const n=Oe(),a=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],i=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return le.getBlocksCount=function(e,r){switch(r){case n.L:return a[(e-1)*4+0];case n.M:return a[(e-1)*4+1];case n.Q:return a[(e-1)*4+2];case n.H:return a[(e-1)*4+3];default:return}},le.getTotalCodewordsCount=function(e,r){switch(r){case n.L:return i[(e-1)*4+0];case n.M:return i[(e-1)*4+1];case n.Q:return i[(e-1)*4+2];case n.H:return i[(e-1)*4+3];default:return}},le}var Se={},ne={},st;function tr(){if(st)return ne;st=1;const n=new Uint8Array(512),a=new Uint8Array(256);return function(){let t=1;for(let e=0;e<255;e++)n[e]=t,a[t]=e,t<<=1,t&256&&(t^=285);for(let e=255;e<512;e++)n[e]=n[e-255]}(),ne.log=function(t){if(t<1)throw new Error("log("+t+")");return a[t]},ne.exp=function(t){return n[t]},ne.mul=function(t,e){return t===0||e===0?0:n[a[t]+a[e]]},ne}var lt;function nr(){return lt||(lt=1,function(n){const a=tr();n.mul=function(t,e){const r=new Uint8Array(t.length+e.length-1);for(let s=0;s<t.length;s++)for(let l=0;l<e.length;l++)r[s+l]^=a.mul(t[s],e[l]);return r},n.mod=function(t,e){let r=new Uint8Array(t);for(;r.length-e.length>=0;){const s=r[0];for(let o=0;o<e.length;o++)r[o]^=a.mul(e[o],s);let l=0;for(;l<r.length&&r[l]===0;)l++;r=r.slice(l)}return r},n.generateECPolynomial=function(t){let e=new Uint8Array([1]);for(let r=0;r<t;r++)e=n.mul(e,new Uint8Array([1,a.exp(r)]));return e}}(Se)),Se}var Ae,ut;function rr(){if(ut)return Ae;ut=1;const n=nr();function a(i){this.genPoly=void 0,this.degree=i,this.degree&&this.initialize(this.degree)}return a.prototype.initialize=function(t){this.degree=t,this.genPoly=n.generateECPolynomial(this.degree)},a.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(t.length+this.degree);e.set(t);const r=n.mod(e,this.genPoly),s=this.degree-r.length;if(s>0){const l=new Uint8Array(this.degree);return l.set(r,s),l}return r},Ae=a,Ae}var Te={},Pe={},ke={},ct;function Dt(){return ct||(ct=1,ke.isValid=function(a){return!isNaN(a)&&a>=1&&a<=40}),ke}var z={},dt;function Ft(){if(dt)return z;dt=1;const n="[0-9]+",a="[A-Z $%*+\\-./:]+";let i="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";i=i.replace(/u/g,"\\u");const t="(?:(?![A-Z0-9 $%*+\\-./:]|"+i+`)(?:.|[\r
]))+`;z.KANJI=new RegExp(i,"g"),z.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),z.BYTE=new RegExp(t,"g"),z.NUMERIC=new RegExp(n,"g"),z.ALPHANUMERIC=new RegExp(a,"g");const e=new RegExp("^"+i+"$"),r=new RegExp("^"+n+"$"),s=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return z.testKanji=function(o){return e.test(o)},z.testNumeric=function(o){return r.test(o)},z.testAlphanumeric=function(o){return s.test(o)},z}var ft;function Z(){return ft||(ft=1,function(n){const a=Dt(),i=Ft();n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(r,s){if(!r.ccBits)throw new Error("Invalid mode: "+r);if(!a.isValid(s))throw new Error("Invalid version: "+s);return s>=1&&s<10?r.ccBits[0]:s<27?r.ccBits[1]:r.ccBits[2]},n.getBestModeForData=function(r){return i.testNumeric(r)?n.NUMERIC:i.testAlphanumeric(r)?n.ALPHANUMERIC:i.testKanji(r)?n.KANJI:n.BYTE},n.toString=function(r){if(r&&r.id)return r.id;throw new Error("Invalid mode")},n.isValid=function(r){return r&&r.bit&&r.ccBits};function t(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+e)}}n.from=function(r,s){if(n.isValid(r))return r;try{return t(r)}catch{return s}}}(Pe)),Pe}var gt;function or(){return gt||(gt=1,function(n){const a=X(),i=Lt(),t=Oe(),e=Z(),r=Dt(),s=7973,l=a.getBCHDigit(s);function o(_,h,A){for(let E=1;E<=40;E++)if(h<=n.getCapacity(E,A,_))return E}function u(_,h){return e.getCharCountIndicator(_,h)+4}function g(_,h){let A=0;return _.forEach(function(E){const N=u(E.mode,h);A+=N+E.getBitsLength()}),A}function w(_,h){for(let A=1;A<=40;A++)if(g(_,A)<=n.getCapacity(A,h,e.MIXED))return A}n.from=function(h,A){return r.isValid(h)?parseInt(h,10):A},n.getCapacity=function(h,A,E){if(!r.isValid(h))throw new Error("Invalid QR Code version");typeof E>"u"&&(E=e.BYTE);const N=a.getSymbolTotalCodewords(h),B=i.getTotalCodewordsCount(h,A),P=(N-B)*8;if(E===e.MIXED)return P;const I=P-u(E,h);switch(E){case e.NUMERIC:return Math.floor(I/10*3);case e.ALPHANUMERIC:return Math.floor(I/11*2);case e.KANJI:return Math.floor(I/13);case e.BYTE:default:return Math.floor(I/8)}},n.getBestVersionForData=function(h,A){let E;const N=t.from(A,t.M);if(Array.isArray(h)){if(h.length>1)return w(h,N);if(h.length===0)return 1;E=h[0]}else E=h;return o(E.mode,E.getLength(),N)},n.getEncodedBits=function(h){if(!r.isValid(h)||h<7)throw new Error("Invalid QR Code version");let A=h<<12;for(;a.getBCHDigit(A)-l>=0;)A^=s<<a.getBCHDigit(A)-l;return h<<12|A}}(Te)),Te}var qe={},ht;function ir(){if(ht)return qe;ht=1;const n=X(),a=1335,i=21522,t=n.getBCHDigit(a);return qe.getEncodedBits=function(r,s){const l=r.bit<<3|s;let o=l<<10;for(;n.getBCHDigit(o)-t>=0;)o^=a<<n.getBCHDigit(o)-t;return(l<<10|o)^i},qe}var Re={},Ne,mt;function ar(){if(mt)return Ne;mt=1;const n=Z();function a(i){this.mode=n.NUMERIC,this.data=i.toString()}return a.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(t){let e,r,s;for(e=0;e+3<=this.data.length;e+=3)r=this.data.substr(e,3),s=parseInt(r,10),t.put(s,10);const l=this.data.length-e;l>0&&(r=this.data.substr(e),s=parseInt(r,10),t.put(s,l*3+1))},Ne=a,Ne}var Me,pt;function sr(){if(pt)return Me;pt=1;const n=Z(),a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function i(t){this.mode=n.ALPHANUMERIC,this.data=t}return i.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(e){let r;for(r=0;r+2<=this.data.length;r+=2){let s=a.indexOf(this.data[r])*45;s+=a.indexOf(this.data[r+1]),e.put(s,11)}this.data.length%2&&e.put(a.indexOf(this.data[r]),6)},Me=i,Me}var Le,yt;function lr(){if(yt)return Le;yt=1;const n=Z();function a(i){this.mode=n.BYTE,typeof i=="string"?this.data=new TextEncoder().encode(i):this.data=new Uint8Array(i)}return a.getBitsLength=function(t){return t*8},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(i){for(let t=0,e=this.data.length;t<e;t++)i.put(this.data[t],8)},Le=a,Le}var De,_t;function ur(){if(_t)return De;_t=1;const n=Z(),a=X();function i(t){this.mode=n.KANJI,this.data=t}return i.getBitsLength=function(e){return e*13},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let r=a.toSJIS(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),t.put(r,13)}},De=i,De}var Fe={exports:{}},wt;function cr(){return wt||(wt=1,function(n){var a={single_source_shortest_paths:function(i,t,e){var r={},s={};s[t]=0;var l=a.PriorityQueue.make();l.push(t,0);for(var o,u,g,w,_,h,A,E,N;!l.empty();){o=l.pop(),u=o.value,w=o.cost,_=i[u]||{};for(g in _)_.hasOwnProperty(g)&&(h=_[g],A=w+h,E=s[g],N=typeof s[g]>"u",(N||E>A)&&(s[g]=A,l.push(g,A),r[g]=u))}if(typeof e<"u"&&typeof s[e]>"u"){var B=["Could not find a path from ",t," to ",e,"."].join("");throw new Error(B)}return r},extract_shortest_path_from_predecessor_list:function(i,t){for(var e=[],r=t;r;)e.push(r),i[r],r=i[r];return e.reverse(),e},find_path:function(i,t,e){var r=a.single_source_shortest_paths(i,t,e);return a.extract_shortest_path_from_predecessor_list(r,e)},PriorityQueue:{make:function(i){var t=a.PriorityQueue,e={},r;i=i||{};for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e.queue=[],e.sorter=i.sorter||t.default_sorter,e},default_sorter:function(i,t){return i.cost-t.cost},push:function(i,t){var e={value:i,cost:t};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=a}(Fe)),Fe.exports}var vt;function dr(){return vt||(vt=1,function(n){const a=Z(),i=ar(),t=sr(),e=lr(),r=ur(),s=Ft(),l=X(),o=cr();function u(B){return unescape(encodeURIComponent(B)).length}function g(B,P,I){const b=[];let M;for(;(M=B.exec(I))!==null;)b.push({data:M[0],index:M.index,mode:P,length:M[0].length});return b}function w(B){const P=g(s.NUMERIC,a.NUMERIC,B),I=g(s.ALPHANUMERIC,a.ALPHANUMERIC,B);let b,M;return l.isKanjiModeEnabled()?(b=g(s.BYTE,a.BYTE,B),M=g(s.KANJI,a.KANJI,B)):(b=g(s.BYTE_KANJI,a.BYTE,B),M=[]),P.concat(I,b,M).sort(function(v,C){return v.index-C.index}).map(function(v){return{data:v.data,mode:v.mode,length:v.length}})}function _(B,P){switch(P){case a.NUMERIC:return i.getBitsLength(B);case a.ALPHANUMERIC:return t.getBitsLength(B);case a.KANJI:return r.getBitsLength(B);case a.BYTE:return e.getBitsLength(B)}}function h(B){return B.reduce(function(P,I){const b=P.length-1>=0?P[P.length-1]:null;return b&&b.mode===I.mode?(P[P.length-1].data+=I.data,P):(P.push(I),P)},[])}function A(B){const P=[];for(let I=0;I<B.length;I++){const b=B[I];switch(b.mode){case a.NUMERIC:P.push([b,{data:b.data,mode:a.ALPHANUMERIC,length:b.length},{data:b.data,mode:a.BYTE,length:b.length}]);break;case a.ALPHANUMERIC:P.push([b,{data:b.data,mode:a.BYTE,length:b.length}]);break;case a.KANJI:P.push([b,{data:b.data,mode:a.BYTE,length:u(b.data)}]);break;case a.BYTE:P.push([{data:b.data,mode:a.BYTE,length:u(b.data)}])}}return P}function E(B,P){const I={},b={start:{}};let M=["start"];for(let p=0;p<B.length;p++){const v=B[p],C=[];for(let y=0;y<v.length;y++){const m=v[y],d=""+p+y;C.push(d),I[d]={node:m,lastCount:0},b[d]={};for(let f=0;f<M.length;f++){const c=M[f];I[c]&&I[c].node.mode===m.mode?(b[c][d]=_(I[c].lastCount+m.length,m.mode)-_(I[c].lastCount,m.mode),I[c].lastCount+=m.length):(I[c]&&(I[c].lastCount=m.length),b[c][d]=_(m.length,m.mode)+4+a.getCharCountIndicator(m.mode,P))}}M=C}for(let p=0;p<M.length;p++)b[M[p]].end=0;return{map:b,table:I}}function N(B,P){let I;const b=a.getBestModeForData(B);if(I=a.from(P,b),I!==a.BYTE&&I.bit<b.bit)throw new Error('"'+B+'" cannot be encoded with mode '+a.toString(I)+`.
 Suggested mode is: `+a.toString(b));switch(I===a.KANJI&&!l.isKanjiModeEnabled()&&(I=a.BYTE),I){case a.NUMERIC:return new i(B);case a.ALPHANUMERIC:return new t(B);case a.KANJI:return new r(B);case a.BYTE:return new e(B)}}n.fromArray=function(P){return P.reduce(function(I,b){return typeof b=="string"?I.push(N(b,null)):b.data&&I.push(N(b.data,b.mode)),I},[])},n.fromString=function(P,I){const b=w(P,l.isKanjiModeEnabled()),M=A(b),p=E(M,I),v=o.find_path(p.map,"start","end"),C=[];for(let y=1;y<v.length-1;y++)C.push(p.table[v[y]].node);return n.fromArray(h(C))},n.rawSplit=function(P){return n.fromArray(w(P,l.isKanjiModeEnabled()))}}(Re)),Re}var Ct;function fr(){if(Ct)return we;Ct=1;const n=X(),a=Oe(),i=Gn(),t=Wn(),e=Xn(),r=Zn(),s=er(),l=Lt(),o=rr(),u=or(),g=ir(),w=Z(),_=dr();function h(p,v){const C=p.size,y=r.getPositions(v);for(let m=0;m<y.length;m++){const d=y[m][0],f=y[m][1];for(let c=-1;c<=7;c++)if(!(d+c<=-1||C<=d+c))for(let S=-1;S<=7;S++)f+S<=-1||C<=f+S||(c>=0&&c<=6&&(S===0||S===6)||S>=0&&S<=6&&(c===0||c===6)||c>=2&&c<=4&&S>=2&&S<=4?p.set(d+c,f+S,!0,!0):p.set(d+c,f+S,!1,!0))}}function A(p){const v=p.size;for(let C=8;C<v-8;C++){const y=C%2===0;p.set(C,6,y,!0),p.set(6,C,y,!0)}}function E(p,v){const C=e.getPositions(v);for(let y=0;y<C.length;y++){const m=C[y][0],d=C[y][1];for(let f=-2;f<=2;f++)for(let c=-2;c<=2;c++)f===-2||f===2||c===-2||c===2||f===0&&c===0?p.set(m+f,d+c,!0,!0):p.set(m+f,d+c,!1,!0)}}function N(p,v){const C=p.size,y=u.getEncodedBits(v);let m,d,f;for(let c=0;c<18;c++)m=Math.floor(c/3),d=c%3+C-8-3,f=(y>>c&1)===1,p.set(m,d,f,!0),p.set(d,m,f,!0)}function B(p,v,C){const y=p.size,m=g.getEncodedBits(v,C);let d,f;for(d=0;d<15;d++)f=(m>>d&1)===1,d<6?p.set(d,8,f,!0):d<8?p.set(d+1,8,f,!0):p.set(y-15+d,8,f,!0),d<8?p.set(8,y-d-1,f,!0):d<9?p.set(8,15-d-1+1,f,!0):p.set(8,15-d-1,f,!0);p.set(y-8,8,1,!0)}function P(p,v){const C=p.size;let y=-1,m=C-1,d=7,f=0;for(let c=C-1;c>0;c-=2)for(c===6&&c--;;){for(let S=0;S<2;S++)if(!p.isReserved(m,c-S)){let $=!1;f<v.length&&($=(v[f]>>>d&1)===1),p.set(m,c-S,$),d--,d===-1&&(f++,d=7)}if(m+=y,m<0||C<=m){m-=y,y=-y;break}}}function I(p,v,C){const y=new i;C.forEach(function(S){y.put(S.mode.bit,4),y.put(S.getLength(),w.getCharCountIndicator(S.mode,p)),S.write(y)});const m=n.getSymbolTotalCodewords(p),d=l.getTotalCodewordsCount(p,v),f=(m-d)*8;for(y.getLengthInBits()+4<=f&&y.put(0,4);y.getLengthInBits()%8!==0;)y.putBit(0);const c=(f-y.getLengthInBits())/8;for(let S=0;S<c;S++)y.put(S%2?17:236,8);return b(y,p,v)}function b(p,v,C){const y=n.getSymbolTotalCodewords(v),m=l.getTotalCodewordsCount(v,C),d=y-m,f=l.getBlocksCount(v,C),c=y%f,S=f-c,$=Math.floor(y/f),Y=Math.floor(d/f),Ut=Y+1,He=$-Y,Vt=new o(He);let he=0;const se=new Array(f),Ke=new Array(f);let me=0;const Qt=new Uint8Array(p.buffer);for(let ee=0;ee<f;ee++){const ye=ee<S?Y:Ut;se[ee]=Qt.slice(he,he+ye),Ke[ee]=Vt.encode(se[ee]),he+=ye,me=Math.max(me,ye)}const pe=new Uint8Array(y);let Je=0,H,K;for(H=0;H<me;H++)for(K=0;K<f;K++)H<se[K].length&&(pe[Je++]=se[K][H]);for(H=0;H<He;H++)for(K=0;K<f;K++)pe[Je++]=Ke[K][H];return pe}function M(p,v,C,y){let m;if(Array.isArray(p))m=_.fromArray(p);else if(typeof p=="string"){let $=v;if(!$){const Y=_.rawSplit(p);$=u.getBestVersionForData(Y,C)}m=_.fromString(p,$||40)}else throw new Error("Invalid data");const d=u.getBestVersionForData(m,C);if(!d)throw new Error("The amount of data is too big to be stored in a QR Code");if(!v)v=d;else if(v<d)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+d+`.
`);const f=I(v,C,m),c=n.getSymbolSize(v),S=new t(c);return h(S,v),A(S),E(S,v),B(S,C,0),v>=7&&N(S,v),P(S,f),isNaN(y)&&(y=s.getBestMask(S,B.bind(null,S,C))),s.applyMask(y,S),B(S,C,y),{modules:S,version:v,errorCorrectionLevel:C,maskPattern:y,segments:m}}return we.create=function(v,C){if(typeof v>"u"||v==="")throw new Error("No input text");let y=a.M,m,d;return typeof C<"u"&&(y=a.from(C.errorCorrectionLevel,a.M),m=u.from(C.version),d=s.from(C.maskPattern),C.toSJISFunc&&n.setToSJISFunction(C.toSJISFunc)),M(v,m,y,d)},we}var $e={},Ue={},bt;function $t(){return bt||(bt=1,function(n){function a(i){if(typeof i=="number"&&(i=i.toString()),typeof i!="string")throw new Error("Color should be defined as hex string");let t=i.slice().replace("#","").split("");if(t.length<3||t.length===5||t.length>8)throw new Error("Invalid hex color: "+i);(t.length===3||t.length===4)&&(t=Array.prototype.concat.apply([],t.map(function(r){return[r,r]}))),t.length===6&&t.push("F","F");const e=parseInt(t.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:e&255,hex:"#"+t.slice(0,6).join("")}}n.getOptions=function(t){t||(t={}),t.color||(t.color={});const e=typeof t.margin>"u"||t.margin===null||t.margin<0?4:t.margin,r=t.width&&t.width>=21?t.width:void 0,s=t.scale||4;return{width:r,scale:r?4:s,margin:e,color:{dark:a(t.color.dark||"#000000ff"),light:a(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},n.getScale=function(t,e){return e.width&&e.width>=t+e.margin*2?e.width/(t+e.margin*2):e.scale},n.getImageWidth=function(t,e){const r=n.getScale(t,e);return Math.floor((t+e.margin*2)*r)},n.qrToImageData=function(t,e,r){const s=e.modules.size,l=e.modules.data,o=n.getScale(s,r),u=Math.floor((s+r.margin*2)*o),g=r.margin*o,w=[r.color.light,r.color.dark];for(let _=0;_<u;_++)for(let h=0;h<u;h++){let A=(_*u+h)*4,E=r.color.light;if(_>=g&&h>=g&&_<u-g&&h<u-g){const N=Math.floor((_-g)/o),B=Math.floor((h-g)/o);E=w[l[N*s+B]?1:0]}t[A++]=E.r,t[A++]=E.g,t[A++]=E.b,t[A]=E.a}}}(Ue)),Ue}var Et;function gr(){return Et||(Et=1,function(n){const a=$t();function i(e,r,s){e.clearRect(0,0,r.width,r.height),r.style||(r.style={}),r.height=s,r.width=s,r.style.height=s+"px",r.style.width=s+"px"}function t(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(r,s,l){let o=l,u=s;typeof o>"u"&&(!s||!s.getContext)&&(o=s,s=void 0),s||(u=t()),o=a.getOptions(o);const g=a.getImageWidth(r.modules.size,o),w=u.getContext("2d"),_=w.createImageData(g,g);return a.qrToImageData(_.data,r,o),i(w,u,g),w.putImageData(_,0,0),u},n.renderToDataURL=function(r,s,l){let o=l;typeof o>"u"&&(!s||!s.getContext)&&(o=s,s=void 0),o||(o={});const u=n.render(r,s,o),g=o.type||"image/png",w=o.rendererOpts||{};return u.toDataURL(g,w.quality)}}($e)),$e}var Ve={},Bt;function hr(){if(Bt)return Ve;Bt=1;const n=$t();function a(e,r){const s=e.a/255,l=r+'="'+e.hex+'"';return s<1?l+" "+r+'-opacity="'+s.toFixed(2).slice(1)+'"':l}function i(e,r,s){let l=e+r;return typeof s<"u"&&(l+=" "+s),l}function t(e,r,s){let l="",o=0,u=!1,g=0;for(let w=0;w<e.length;w++){const _=Math.floor(w%r),h=Math.floor(w/r);!_&&!u&&(u=!0),e[w]?(g++,w>0&&_>0&&e[w-1]||(l+=u?i("M",_+s,.5+h+s):i("m",o,0),o=0,u=!1),_+1<r&&e[w+1]||(l+=i("h",g),g=0)):o++}return l}return Ve.render=function(r,s,l){const o=n.getOptions(s),u=r.modules.size,g=r.modules.data,w=u+o.margin*2,_=o.color.light.a?"<path "+a(o.color.light,"fill")+' d="M0 0h'+w+"v"+w+'H0z"/>':"",h="<path "+a(o.color.dark,"stroke")+' d="'+t(g,u,o.margin)+'"/>',A='viewBox="0 0 '+w+" "+w+'"',N='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+A+' shape-rendering="crispEdges">'+_+h+`</svg>
`;return typeof l=="function"&&l(null,N),N},Ve}var It;function mr(){if(It)return te;It=1;const n=jn(),a=fr(),i=gr(),t=hr();function e(r,s,l,o,u){const g=[].slice.call(arguments,1),w=g.length,_=typeof g[w-1]=="function";if(!_&&!n())throw new Error("Callback required as last argument");if(_){if(w<2)throw new Error("Too few arguments provided");w===2?(u=l,l=s,s=o=void 0):w===3&&(s.getContext&&typeof u>"u"?(u=o,o=void 0):(u=o,o=l,l=s,s=void 0))}else{if(w<1)throw new Error("Too few arguments provided");return w===1?(l=s,s=o=void 0):w===2&&!s.getContext&&(o=l,l=s,s=void 0),new Promise(function(h,A){try{const E=a.create(l,o);h(r(E,s,o))}catch(E){A(E)}})}try{const h=a.create(l,o);u(null,r(h,s,o))}catch(h){u(h)}}return te.create=a.create,te.toCanvas=e.bind(null,i.render),te.toDataURL=e.bind(null,i.renderToDataURL),te.toString=e.bind(null,function(r,s,l){return t.render(r,l)}),te}var pr=mr();const yr=Zt(pr);function _r(n,a){const i=en(n),t=tn("");return ie(i,async e=>{i.value&&nn&&(t.value=await yr.toDataURL(e,a))},{immediate:!0}),t}const wr=["src"],vr=G({__name:"PageQrCode",props:{url:{},textAbove:{},textBelow:{}},setup(n){const i=Rt(n,"url"),t=_r(i,{errorCorrectionLevel:"L",margin:1,width:200});return(e,r)=>(T(),R(fe,{class:"pb-card-qrcode no-shadow",style:{width:"200px"}},{default:q(()=>[e.textAbove?(T(),R(W,{key:0,class:"pb-qrcode-text-above q-pa-sm"},{default:q(()=>[de(O(e.textAbove),1)]),_:1})):D("",!0),k(W,{class:"pb-qrcode-code q-pa-none q-px-sm"},{default:q(()=>[Q("img",{src:L(t),style:{width:"100%"}},null,8,wr)]),_:1}),e.textBelow?(T(),R(W,{key:1,class:"pb-qrcode-text-below q-pa-sm"},{default:q(()=>[de(O(e.textBelow),1)]),_:1})):D("",!0)]),_:1}))}}),Cr=Mt(vr,[["__scopeId","data-v-202295d8"]]),br=xe({name:"QCarouselSlide",props:{...zt,imgSrc:String},setup(n,{slots:a}){const i=F(()=>n.imgSrc?{backgroundImage:`url("${n.imgSrc}")`}:{});return()=>x("div",{class:"q-carousel__slide",style:i.value},rn(a.default))}}),Er=["top","right","bottom","left"],Br=["regular","flat","outline","push","unelevated"],Ir=xe({name:"QCarousel",props:{...on,...Ht,...bn,transitionPrev:{type:String,default:"fade"},transitionNext:{type:String,default:"fade"},height:String,padding:Boolean,controlColor:String,controlTextColor:String,controlType:{type:String,validator:n=>Br.includes(n),default:"flat"},autoplay:[Number,Boolean],arrows:Boolean,prevIcon:String,nextIcon:String,navigation:Boolean,navigationPosition:{type:String,validator:n=>Er.includes(n)},navigationIcon:String,navigationActiveIcon:String,thumbnails:Boolean},emits:[...Cn,...Ot],setup(n,{slots:a}){const{proxy:{$q:i}}=an(),t=sn(n,i);let e=null,r;const{updatePanelsList:s,getPanelContent:l,panelDirectives:o,goToPanel:u,previousPanel:g,nextPanel:w,getEnabledPanels:_,panelIndex:h}=Kt(),{inFullscreen:A}=En(),E=F(()=>A.value!==!0&&n.height!==void 0?{height:n.height}:{}),N=F(()=>n.vertical===!0?"vertical":"horizontal"),B=F(()=>n.navigationPosition||(n.vertical===!0?"right":"bottom")),P=F(()=>`q-carousel q-panel-parent q-carousel--with${n.padding===!0?"":"out"}-padding`+(A.value===!0?" fullscreen":"")+(t.value===!0?" q-carousel--dark q-dark":"")+(n.arrows===!0?` q-carousel--arrows-${N.value}`:"")+(n.navigation===!0?` q-carousel--navigation-${B.value}`:"")),I=F(()=>{const m=[n.prevIcon||i.iconSet.carousel[n.vertical===!0?"up":"left"],n.nextIcon||i.iconSet.carousel[n.vertical===!0?"down":"right"]];return n.vertical===!1&&i.lang.rtl===!0?m.reverse():m}),b=F(()=>n.navigationIcon||i.iconSet.carousel.navigationIcon),M=F(()=>n.navigationActiveIcon||b.value),p=F(()=>({color:n.controlColor,textColor:n.controlTextColor,round:!0,[n.controlType]:!0,dense:!0}));ie(()=>n.modelValue,()=>{n.autoplay&&v()}),ie(()=>n.autoplay,m=>{m?v():e!==null&&(clearTimeout(e),e=null)});function v(){const m=Pt(n.autoplay)===!0?Math.abs(n.autoplay):5e3;e!==null&&clearTimeout(e),e=setTimeout(()=>{e=null,m>=0?w():g()},m)}ze(()=>{n.autoplay&&v()}),qt(()=>{e!==null&&clearTimeout(e)});function C(m,d){return x("div",{class:`q-carousel__control q-carousel__navigation no-wrap absolute flex q-carousel__navigation--${m} q-carousel__navigation--${B.value}`+(n.controlColor!==void 0?` text-${n.controlColor}`:"")},[x("div",{class:"q-carousel__navigation-inner flex flex-center no-wrap"},_().map(d))])}function y(){const m=[];if(n.navigation===!0){const d=a["navigation-icon"]!==void 0?a["navigation-icon"]:c=>x(U,{key:"nav"+c.name,class:`q-carousel__navigation-icon q-carousel__navigation-icon--${c.active===!0?"":"in"}active`,...c.btnProps,onClick:c.onClick}),f=r-1;m.push(C("buttons",(c,S)=>{const $=c.props.name,Y=h.value===S;return d({index:S,maxIndex:f,name:$,active:Y,btnProps:{icon:Y===!0?M.value:b.value,size:"sm",...p.value},onClick:()=>{u($)}})}))}else if(n.thumbnails===!0){const d=n.controlColor!==void 0?` text-${n.controlColor}`:"";m.push(C("thumbnails",f=>{const c=f.props;return x("img",{key:"tmb#"+c.name,class:`q-carousel__thumbnail q-carousel__thumbnail--${c.name===n.modelValue?"":"in"}active`+d,src:c.imgSrc||c["img-src"],onClick:()=>{u(c.name)}})}))}return n.arrows===!0&&h.value>=0&&((n.infinite===!0||h.value>0)&&m.push(x("div",{key:"prev",class:`q-carousel__control q-carousel__arrow q-carousel__prev-arrow q-carousel__prev-arrow--${N.value} absolute flex flex-center`},[x(U,{icon:I.value[0],...p.value,onClick:g})])),(n.infinite===!0||h.value<r-1)&&m.push(x("div",{key:"next",class:`q-carousel__control q-carousel__arrow q-carousel__next-arrow q-carousel__next-arrow--${N.value} absolute flex flex-center`},[x(U,{icon:I.value[1],...p.value,onClick:w})]))),un(a.control,m)}return()=>(r=s(a),x("div",{class:P.value,style:E.value},[ln("div",{class:"q-carousel__slides-container"},l(),"sl-cont",n.swipeable,()=>o.value)].concat(y())))}}),Sr=G({__name:"PageCarouselView",props:{slicedImages:{},mediaitemId:{}},emits:["triggerChangedItem"],setup(n,{emit:a}){const i=n,t=Rt(i.mediaitemId);ie(()=>i.mediaitemId,l=>{t.value=l});const e=a;function r(){console.log("TODO: add method to close dialog programmatically")}function s(l){e("triggerChangedItem",l)}return(l,o)=>re((T(),R(Ir,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=u=>t.value=u),class:"",style:{width:"100%",height:"100%"},"control-type":"flat","control-color":"primary",swipeable:"",animated:"",draggable:"false",arrows:!0,infinite:!0,"transition-prev":"slide-right","transition-next":"slide-left",onTransition:s},{default:q(()=>[(T(!0),V(ae,null,ge(i.slicedImages,u=>(T(),R(br,{key:u.id,name:u.id,class:"column no-wrap flex-center full-height q-pa-sm"},{default:q(()=>[k(Bn,{item:u},null,8,["item"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])),[[Jt,r,void 0,{mouse:!0,down:!0}]])}}),Ar={key:0,class:"fixed-full"},Tr={key:1},Jr=G({__name:"GalleryDetailPage",props:{startTimer:{type:Boolean},forceShowDeleteButton:{type:Boolean}},setup(n){const a=mn(),i=fn(),t=gn(),e=cn(),r=dn(),s=J(""),l=J(!1),o=J(!1),u=J(!1),g=J(!1),w=J(0),_=J([]),h=n;At(()=>{s.value=i.params.id,p()}),ie(i,d=>{s.value=d.params.id}),ze(()=>{o.value=h.startTimer});const A=d=>{s.value=d},E=F(()=>b(s.value)),N=F(()=>{if(e.configuration.qrshare.enabled)return`${e.configuration.qrshare.shareservice_url}?action=download&id=${s.value}`;{const d=e.configuration.qrshare.share_custom_qr_url,f=c=>c.split(/[\\/]/).pop();return d.replace("{filename}",f(E.value.processed)).replace("{identifier}",s.value)}}),B=F(()=>r.collection.findIndex(d=>d.id==s.value)+1),P=F(()=>e.configuration.uisettings.gallery_show_filter&&M(E.value.media_type)),I=F(()=>{const d=[];return e.configuration.share.actions.forEach((c,S)=>{const $={config_index:S,handles_images_only:c.handles_images_only,show_button:c.trigger.ui_trigger.show_button,title:c.trigger.ui_trigger.title,icon:c.trigger.ui_trigger.icon};d.push($)}),d}),b=d=>r.collection.find(f=>f.id==d),M=d=>["image","collageimage","animationimage"].includes(d),p=async()=>{try{const d=await Ye("/api/filter/");_.value=await d.json(),console.log(_.value)}catch(d){console.warn(d)}},v=(d,f)=>{u.value=!0,fetch(`/api/filter/${d}?filter=${f}`,{method:"PATCH"}).then(c=>{if(!c.ok)throw new Error("Server returned "+c.status);u.value=!1}).catch(c=>{console.error(c),u.value=!1})},C=d=>{s.value=void 0,r.deleteItem(d),t.back()},y=d=>{console.log("doShareAction",s.value,d),e.configuration.share.actions[d].processing.ask_user_for_parameter_input?(w.value=d,g.value=!0):hn(`/api/share/actions/${s.value}/${d}`,"POST")},m=async(d,f)=>{console.warn(s.value,d,f),console.log(JSON.stringify(f));try{const c=await Ye(`/api/share/actions/${s.value}/${d}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});if(console.log(c),!c.ok)throw`Error: ${c.status} ${c.statusText}`}catch(c){console.error(c),a.notify({message:c,caption:"Request Error!",color:"negative"})}};return(d,f)=>(T(),R(yn,{view:"hhh Lpr ffr",onClick:f[5]||(f[5]=c=>o.value=!1)},{default:q(()=>[E.value?(T(),V("div",Ar,[k(xt,{class:"bg-primary text-white"},{default:q(()=>[o.value?(T(),R(Vn,{key:0,duration:L(e).configuration.uisettings.AUTOCLOSE_NEW_ITEM_ARRIVED,onTriggerTimeout:f[0]||(f[0]=c=>d.$router.push({path:"/"}))},null,8,["duration"])):D("",!0),u.value?(T(),R(zn,{key:1})):D("",!0)]),_:1}),P.value?(T(),R(Yt,{key:0,id:"gallery-drawer-filters",modelValue:l.value,"onUpdate:modelValue":f[1]||(f[1]=c=>l.value=c),class:"q-pa-sm",side:"right",overlay:"",elevated:""},{default:q(()=>[l.value?(T(),R(Yn,{key:0,id:E.value.id,"available-filter":_.value,onTriggerApplyFilter:v},null,8,["id","available-filter"])):D("",!0)]),_:1},8,["modelValue"])):D("",!0),k(_n,{class:"q-pa-none galleryimagedetail full-height"},{default:q(()=>[k(pn,{class:"full-height"},{default:q(()=>[k(Sr,{"mediaitem-id":E.value.id,"sliced-images":L(r).collection,onTriggerChangedItem:A,onClick:f[2]||(f[2]=c=>l.value=!1)},null,8,["mediaitem-id","sliced-images"]),L(e).configuration.uisettings.gallery_show_qrcode?(T(),R(St,{key:0,position:"top-right",class:"q-ma-lg"},{default:q(()=>[k(Cr,{url:N.value,"text-above":L(e).configuration.uisettings.qrcode_text_above,"text-below":L(e).configuration.uisettings.qrcode_text_below},null,8,["url","text-above","text-below"])]),_:1})):D("",!0),k(Un,{item:E.value,"show-filter":L(e).configuration.uisettings.gallery_show_filter,"enable-filter":M(E.value.media_type),"show-share":L(e).configuration.uisettings.gallery_show_shareprint&&L(e).configuration.share.sharing_enabled,"share-buttons":I.value,"show-delete":h.forceShowDeleteButton||L(e).configuration.uisettings.gallery_show_delete,"show-download":L(e).configuration.uisettings.gallery_show_download,image_number:B.value,images_total:L(r).collection_number_of_items,onTriggerToggleDisplayFilter:f[3]||(f[3]=c=>l.value=!l.value),onTriggerDeleteMediaitem:C,onTriggerShareAction:y},null,8,["item","show-filter","enable-filter","show-share","share-buttons","show-delete","show-download","image_number","images_total"]),k(kt,{modelValue:g.value,"onUpdate:modelValue":f[4]||(f[4]=c=>g.value=c)},{default:q(()=>[k(qn,{parameters:L(e).configuration.share.actions[w.value].processing.parameters,parameters_dialog_caption:L(e).configuration.share.actions[w.value].processing.parameters_dialog_caption,parameters_dialog_action_icon:L(e).configuration.share.actions[w.value].processing.parameters_dialog_action_icon,parameters_dialog_action_label:L(e).configuration.share.actions[w.value].processing.parameters_dialog_action_label,config_index:w.value,onTriggerShareActionWithParameters:m},null,8,["parameters","parameters_dialog_caption","parameters_dialog_action_icon","parameters_dialog_action_label","config_index"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):(T(),V("div",Tr,[k(In)]))]),_:1}))}});export{Jr as default};
